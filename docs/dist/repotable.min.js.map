{"version":3,"sources":["docs/dist/repotable.js"],"names":["window","angular","module","console","log","constant","ID","IDS","TITLE","DATE","CUSTOMER","RESOURCE","STATUS","STATUSSM","FAMILY","NUMBER","HOURS","COSTS","PERCENT","INCREMENT","ICON","BUTTONS","DISABLED","LINK","BOOL","DOUBLE","WEEKS","directive","$parse","$timeout","Utils","Style","ElementRect","Droppables","require","link","scope","element","attributes","model","onStart","e","condition","down","getTouch","addDragListeners","onMove","move","diff","difference","dragging","power","addClass","style","transform","x","y","set","target","elementRect","nativeElement","offset","rects","getIntersections","length","native","onEnd","removeClass","fromIndex","droppableIndex","fromModel","ngModel","event","forEach","rect","index","data","droppable","from","to","$emit","removeDragListeners","on","off","addListeners","removeListeners","selector","draggableItem","undefined","draggableIf","querySelector","$on","onGetData","droppableIf","droppableItem","add","remove","$document","restrict","isActive","toggler","value","activate","addOutListeners","deactivate","removeOutListeners","onClick","setTimeout","onClickOut","getClosestElement","getClosest","Error","filter","$filter","toTitleCase","str","replace","txt","charAt","toUpperCase","substr","toLowerCase","indexOf","split","join","splitted","firstName","shift","lastName","legacyFilter","cost","currency","ratio","formatting","precision","unit","hours","Math","floor","minutes","label","format","timezone","placeholder","parseTime","parseHour","val","filterWatcher","_groupBy","collection","getter","key","dict","item","push","property","isObject","isUndefined","isMemoized","arguments","memoize","this","provider","isNull","isScope","obj","$evalAsync","$watch","$get","$window","$rootScope","getHashKey","fName","args","replacerFactory","cache","document","JSON","stringify","removeCache","id","targetScope","$id","$$listeners","$$cache","cleanStateless","$$timeout","$$phase","addListener","hashKey","$$isMemoized","filterName","$$memoize","result","factory","State","isReady","idle","prototype","isBusy","isError","isErroring","isSuccess","isSuccessing","button","errors","enabled","busy","success","bind","error","ready","errorMessage","submitClass","successing","errorring","submitMessage","idleMessage","busyMessage","successMessage","Animate","callback","useTimeout","isPlaying","ticks","play","loop","time","_this","requestAnimationFrame","pause","clearTimeout","cancelAnimationFrame","playpause","cycle","k","a","b","c","d","ff","gg","hh","ii","add32","cmn","q","s","t","md51","i","n","state","md5blk","substring","tail","charCodeAt","md5blks","rhex","j","hex_chr","hex","Md5","encode","string","lsw","msw","$compile","$controller","Vector","previous","type","touch","originalEvent","touches","changedTouches","pageX","pageY","getRelativeTouch","point","getBoundingClientRect","left","top","el","matchesFn","parent","some","fn","body","parentElement","throttle","func","wait","options","context","timeout","later","leading","getNow","apply","now","remaining","trailing","where","array","query","found","has","compileController","html","contents","controller","$scope","$new","extend","controllerAs","children","reverseSortOn","prepend","expression","formatted","reducer","o","reducerSetter","slice","reducerAdder","lastTime","vendors","currTime","Date","getTime","timeToCall","max","Array","reduce","Object","defineProperty","TypeError","len","ua","navigator","userAgent","safari","msie","chrome","mobile","toMd5","getElementsByTagName","make","size","sqrt","normalize","l","incidence","angle","atan2","distance","cross","abs","towards","friction","copy","toString","width","height","center","fromNative","offsetWidth","offsetHeight","vector","intersect","props","scale","hoverScale","currentScale","prefix","webkit","div","createElement","every","prop","prefixed","styles","cssText","transformOrigin","round","colTypes","Column","typeTotal","totalTypes","SUM","isFunction","name","raw","source","getters","fields","field","setters","assign","reset","MIN","MAX","AVG","getKey","getValue","getRaw","getSource","values","keys","search","total","hasKey","initValue","addTotal","row","min","addCount","v","addValue","getValueTotal","filtered","compare","current","col","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","getValueFormatted","isNumber","getFormatted","dynamic","static","getTotal","getFormat","getLink","getHeaderClass","cc","columnClass","getColumnClass","getCellClass","color","getItemClass","baseClass","getTextClass","getTotalClass","searchToggle","active","splice","toggle","makeStatic","post","textClass","pop","types","Columns","columns","list","show","table","getCount","getFirstCol","first","groupBy","getChartKey","getGroupKey","getSortKey","sort","expand","radios","aggregate","count","radio","getGroups","getAggregates","getPercentages","getDynamics","getCompares","getCounters","groups","items","headerClass","always","va","vb","String","activeInRange","range","flag","unique","iterate","addTotals","comparing","toggleColumns","searchDisabled","fromDatas","datas","parseCols","parse","isArray","TEXT","cols","isDate","hasSearch","Table","defaults","map","colGroups","valGroups","excludes","includes","setDatas","compares","update","rows","compared","after","resetFilters","exclude","include","toggleCol","doFilter","doFilterMultiple","doFilterColumns","doOrder","getRowClass","onOpen","mode","service","natives","callbacks","intersections"],"mappings":"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","file":"repotable.min.js","sourcesContent":["\r\n(function(window, angular) {'use strict';\r\n\n/* global angular */\r\n\r\nvar module = angular.module('repotable', ['ng', 'ngSanitize', 'ngMessages']);\r\n\n/* global angular, module */\r\n\r\nwindow.console ? null : window.console = { log: function () { } };\r\n\r\n/*\r\nwindow.domain = '//' + location.hostname + (location.port ? ':' + location.port : ''); // location.protocol + \r\nmodule.constant('domain', domain);\r\n*/\r\n\r\nmodule.constant('colTypes', {\r\n    ID: 1,\r\n    IDS: 2,\r\n    TITLE: 3,\r\n    DATE: 4,\r\n    CUSTOMER: 5,\r\n    RESOURCE: 6,\r\n    STATUS: 7,\r\n    STATUSSM: 8,\r\n    FAMILY: 9,\r\n    NUMBER: 10,\r\n    HOURS: 11,\r\n    COSTS: 12,\r\n    PERCENT: 13,\r\n    INCREMENT: 14,\r\n    ICON: 15,\r\n    BUTTONS: 16,\r\n    DISABLED: 17,\r\n    LINK: 18,\r\n    BOOL: 19,\r\n    DOUBLE: 20,\r\n    WEEKS: 21,\r\n});\r\n\n/* global angular, module */\r\n\n/* global angular, module */\r\n\r\nmodule.directive('draggableItem', ['$parse', '$timeout', 'Utils', 'Style', 'ElementRect', 'Droppables', function ($parse, $timeout, Utils, Style, ElementRect, Droppables) {\r\n\r\n    return {\r\n        require: 'ngModel',\r\n        link: function (scope, element, attributes, model) {\r\n            var nativeElement = element[0];\r\n            var selector = attributes.draggableItem || '.item';\r\n            var condition = attributes.draggableIf !== undefined ? $parse(attributes.draggableIf) : function () { return true; };\r\n            var target = nativeElement.querySelector(selector);\r\n            var style = new Style();\r\n            var elementRect = new ElementRect();\r\n            var down, move, diff, dragging, rects;\r\n            function onStart(e) {\r\n                if (condition(scope)) {\r\n                    down = Utils.getTouch(e);\r\n                    addDragListeners();\r\n                }\r\n                return false;\r\n            }\r\n            function onMove(e) {\r\n                move = Utils.getTouch(e);\r\n                diff = down.difference(move);\r\n                if (!dragging && diff.power() > 25) {\r\n                    dragging = true;\r\n                    element.addClass('dragging');\r\n                }\r\n                if (dragging) {\r\n                    style.transform = 'translateX(' + diff.x + 'px) translateY(' + diff.y + 'px)';\r\n                    style.set(target);\r\n                    elementRect.set(nativeElement).offset(diff);\r\n                    rects = Droppables.getIntersections(elementRect);\r\n                    if (rects.length) {\r\n                        angular.element(rects[0].native).addClass('dropping');\r\n                    }\r\n                }\r\n                // console.log(diff);\r\n                return false;\r\n            }\r\n            function onEnd(e) {\r\n                if (dragging) {\r\n                    dragging = false;\r\n                    element.removeClass('dragging');\r\n                    style.transform = 'none';\r\n                    style.set(target);\r\n                    var fromIndex = $parse(attributes.droppableIndex)(scope);\r\n                    var fromModel = $parse(attributes.ngModel)(scope);\r\n                    if (rects.length) {\r\n                        var event = null;\r\n                        angular.forEach(rects, function (rect, index) {\r\n                            angular.element(rect.native).removeClass('dropping over');\r\n                            if (rect.data.droppable(scope) && !event) {\r\n                                event = {\r\n                                    from: {\r\n                                        index: fromIndex,\r\n                                        model: fromModel,\r\n                                        target: target,\r\n                                    },\r\n                                    to: {\r\n                                        index: rect.data.index,\r\n                                        model: rect.data.model,\r\n                                        target: rect.native\r\n                                    },\r\n                                };\r\n                                $timeout(function () {\r\n                                    scope.$emit('onDropItem', event);\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        var event = {\r\n                            from: {\r\n                                index: fromIndex,\r\n                                model: fromModel,\r\n                                target: target,\r\n                            },\r\n                            to: null,\r\n                        };\r\n                        $timeout(function () {\r\n                            scope.$emit('onDropOut', event);\r\n                        });\r\n                    }\r\n                }\r\n                removeDragListeners();\r\n                return false;\r\n            }\r\n            function addDragListeners() {\r\n                angular.element(window).on('touchmove mousemove', onMove);\r\n                angular.element(window).on('touchend mouseup', onEnd);\r\n            };\r\n            function removeDragListeners() {\r\n                angular.element(window).off('touchmove mousemove', onMove);\r\n                angular.element(window).off('touchend mouseup', onEnd);\r\n            };\r\n            function addListeners() {\r\n                element.on('touchstart mousedown', onStart);\r\n            };\r\n            function removeListeners() {\r\n                element.off('touchstart mousedown', onStart);\r\n            };\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n            });\r\n            addListeners();\r\n        }\r\n    };\r\n}]);\r\n\r\nmodule.directive('droppableItem', ['$parse', 'Utils', 'Style', 'Droppables', function ($parse, Utils, Style, Droppables) {\r\n    var droppables = {};\r\n    return {\r\n        require: 'ngModel',\r\n        link: function (scope, element, attributes, model) {\r\n            var nativeElement = element[0];\r\n            var selector = attributes.droppableItem || '.item';\r\n            function onGetData() {\r\n                var index = $parse(attributes.droppableIndex)(scope);\r\n                var model = $parse(attributes.ngModel)(scope);\r\n                var droppable = attributes.droppableIf !== undefined ? $parse(attributes.droppableIf) : function () { return true };\r\n                return {\r\n                    index: index,\r\n                    model: model,\r\n                    droppable: droppable,\r\n                };\r\n            }\r\n            Droppables.add(nativeElement, onGetData);\r\n            scope.$on('$destroy', function () {\r\n                Droppables.remove(nativeElement);\r\n            });\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.directive('toggler', ['$document', '$parse', '$timeout', 'Utils', function ($document, $parse, $timeout, Utils) {\r\n    return {\r\n        restrict: 'A',\r\n        link: function (scope, element, attributes, model) {\r\n            if (attributes.value === undefined) {\r\n                throw new Error('[toggler] attribute value required');\r\n            }\r\n            if (attributes.target === undefined) {\r\n                throw new Error('[toggler] attribute target required');\r\n            }\r\n            function isActive() {\r\n                return $parse(attributes.toggler + '==' + attributes.value)(scope);\r\n            }\r\n            function activate() {\r\n                addOutListeners();\r\n                $timeout(function () {\r\n                    $parse(attributes.toggler + '=' + attributes.value)(scope);\r\n                });\r\n            }\r\n            function deactivate() {\r\n                removeOutListeners();\r\n                $timeout(function () {\r\n                    $parse(attributes.toggler + '=null')(scope);\r\n                });\r\n            }\r\n            function onClick(e) {\r\n                setTimeout(function () {\r\n                    if (isActive()) {\r\n                        deactivate();\r\n                    } else {\r\n                        activate();\r\n                    }\r\n                }, 100);\r\n            }\r\n            function onClickOut(e) {\r\n                if (isActive()\r\n                    && Utils.getClosestElement(e.target, element[0]) === null\r\n                    && Utils.getClosest(e.target, attributes.target) === null) {\r\n                    deactivate();\r\n                }\r\n            }\r\n            function addOutListeners() {\r\n                angular.element($document).on('click', onClickOut);\r\n            };\r\n            function removeOutListeners() {\r\n                angular.element($document).off('click', onClickOut);\r\n            };\r\n            function addListeners() {\r\n                element.on('click', onClick);\r\n            };\r\n            function removeListeners() {\r\n                element.off('click', onClick);\r\n            };\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n                removeOutListeners();\r\n            });\r\n            addListeners();\r\n        }\r\n    };\r\n}]);\r\n\n/* global angular, module */\r\n\r\nmodule.filter('shortName', ['$filter', function ($filter) {\r\n    function toTitleCase(str) {\r\n        return str.replace(/\\w\\S*/g, function (txt) { return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase(); });\r\n    }\r\n    return function (value) {\r\n        if (!value) {\r\n            return '';\r\n        }\r\n        if (value.indexOf(' .') === value.length - 2) {\r\n            value = value.split(' .').join('');\r\n        }\r\n        /*\r\n        var splitted;\r\n        if (value.indexOf('.') !== -1) {\r\n            splitted = value.split('.');\r\n        } else {\r\n            splitted = value.split(' ');\r\n        }\r\n        */\r\n        var splitted = value.split(' ');\r\n        var firstName = splitted.shift();\r\n        if (splitted.length) {\r\n            var lastName = splitted.join(' ');\r\n            return firstName.substr(0, 1).toUpperCase() + '.' + toTitleCase(lastName);\r\n        } else {\r\n            return firstName;\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customCurrency', ['$filter', function ($filter) {\r\n    var legacyFilter = $filter('currency');\r\n    return function (cost, currency) {\r\n        return legacyFilter(cost * currency.ratio, currency.formatting);\r\n    }\r\n}]);\r\n\r\nmodule.filter('customNumber', ['$filter', function ($filter) {\r\n    var filter = $filter('number');\r\n    return function (value, precision, unit) {\r\n        unit = unit || '';\r\n        return (value ? filter(value, precision) + unit : '-');\r\n    }\r\n}]);\r\n\r\nmodule.filter('customHours', [function () {\r\n    return function (value) {\r\n        if (value) {\r\n            var hours = Math.floor(value);\r\n            var minutes = Math.floor((value - hours) * 60);\r\n            var label = hours ? hours + ' H' : '';\r\n            label += minutes ? ' ' + minutes + ' m' : '';\r\n            return label;\r\n        } else {\r\n            return '-';\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customDate', ['$filter', function ($filter) {\r\n    var filter = $filter('date');\r\n    return function (value, format, timezone) {\r\n        return value ? filter(value, format, timezone) : '-';\r\n    }\r\n}]);\r\n\r\nmodule.filter('customTime', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        if (value) {\r\n            return Utils.parseTime(value);\r\n        } else {\r\n            return (placeholder ? placeholder : '-');\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customDigital', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        if (value) {\r\n            return Utils.parseHour(value);\r\n        } else {\r\n            return (placeholder ? placeholder : '-');\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customString', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        return value ? value : (placeholder ? placeholder : '-');\r\n    }\r\n}]);\r\n\r\nmodule.filter('customEnum', function () {\r\n    return function (val) {\r\n        val = val + 1;\r\n        return val < 10 ? '0' + val : val;\r\n    };\r\n});\r\n\r\nmodule.filter('groupBy', ['$parse', 'filterWatcher', function ($parse, filterWatcher) {\r\n    function _groupBy(collection, getter) {\r\n        var dict = {};\r\n        var key;\r\n        angular.forEach(collection, function (item) {\r\n            key = getter(item);\r\n            if (!dict[key]) {\r\n                dict[key] = [];\r\n            }\r\n            dict[key].push(item);\r\n        });\r\n        return dict;\r\n    }\r\n    return function (collection, property) {\r\n        if (!angular.isObject(collection) || angular.isUndefined(property)) {\r\n            return collection;\r\n        }\r\n        return filterWatcher.isMemoized('groupBy', arguments) || filterWatcher.memoize('groupBy', arguments, this, _groupBy(collection, $parse(property)));        \r\n    }\r\n}]);\r\n\r\nmodule.provider('filterWatcher', function () {\r\n    function isNull(value) {\r\n        return value === null;\r\n    }\r\n    function isScope(obj) {\r\n        return obj && obj.$evalAsync && obj.$watch;\r\n    }\r\n    this.$get = ['$window', '$rootScope', function ($window, $rootScope) {\r\n        var $$cache = {};\r\n        var $$listeners = {};\r\n        var $$timeout = $window.setTimeout;\r\n        function getHashKey(fName, args) {\r\n            function replacerFactory() {\r\n                var cache = [];\r\n                return function (key, val) {\r\n                    if (angular.isObject(val) && !isNull(val)) {\r\n                        if (~cache.indexOf(val)) {\r\n                            return '[Circular]';\r\n                        }\r\n                        cache.push(val);\r\n                    }\r\n                    if ($window == val) return '$WINDOW';\r\n                    if ($window.document == val) return '$DOCUMENT';\r\n                    if (isScope(val)) return '$SCOPE';\r\n                    return val;\r\n                }\r\n            }\r\n            return [fName, JSON.stringify(args, replacerFactory())]\r\n              .join('#')\r\n              .replace(/\"/g, '');\r\n        }\r\n        function removeCache(event) {\r\n            var id = event.targetScope.$id;\r\n            angular.forEach($$listeners[id], function (key) {\r\n                delete $$cache[key];\r\n            });\r\n            delete $$listeners[id];\r\n        }\r\n        function cleanStateless() {\r\n            $$timeout(function () {\r\n                if (!$rootScope.$$phase) {\r\n                    $$cache = {};\r\n                }\r\n            }, 2000);\r\n        }\r\n        function addListener(scope, hashKey) {\r\n            var id = scope.$id;\r\n            if (angular.isUndefined($$listeners[id])) {\r\n                scope.$on('$destroy', removeCache);\r\n                $$listeners[id] = [];\r\n            }\r\n            return $$listeners[id].push(hashKey);\r\n        }\r\n        function $$isMemoized(filterName, args) {\r\n            var hashKey = getHashKey(filterName, args);\r\n            return $$cache[hashKey];\r\n        }\r\n        function $$memoize(filterName, args, scope, result) {\r\n            var hashKey = getHashKey(filterName, args);\r\n            //store result in `$$cache` container\r\n            $$cache[hashKey] = result;\r\n            // for angular versions that less than 1.3\r\n            // add to `$destroy` listener, a cleaner callback\r\n            if (isScope(scope)) {\r\n                addListener(scope, hashKey);\r\n            } else {\r\n                cleanStateless();\r\n            }\r\n            return result;\r\n        }\r\n        return {\r\n            isMemoized: $$isMemoized,\r\n            memoize: $$memoize\r\n        }\r\n    }];\r\n});\r\n\n/* global angular, module */\r\n\r\nmodule.factory('State', ['$timeout', function ($timeout) {\r\n    function State() {\r\n        this.isReady = false;\r\n        this.idle();\r\n    }\r\n    State.prototype = {\r\n        idle: function () {\r\n            this.isBusy = false;\r\n            this.isError = false;\r\n            this.isErroring = false;\r\n            this.isSuccess = false;\r\n            this.isSuccessing = false;\r\n            this.button = null;\r\n            this.errors = [];\r\n        },\r\n        enabled: function () {\r\n            return !this.isBusy && !this.isErroring && !this.isSuccessing;\r\n        },\r\n        busy: function () {\r\n            if (!this.isBusy) {\r\n                this.isBusy = true;\r\n                this.isError = false;\r\n                this.isErroring = false;\r\n                this.isSuccess = false;\r\n                this.isSuccessing = false;\r\n                this.errors = [];\r\n                // console.log('State.busy', this);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        },\r\n        success: function () {\r\n            this.isBusy = false;\r\n            this.isError = false;\r\n            this.isErroring = false;\r\n            this.isSuccess = true;\r\n            this.isSuccessing = true;\r\n            this.errors = [];\r\n            $timeout(function () {\r\n                this.isSuccessing = false;\r\n                this.button = null;\r\n            }.bind(this), 1000);\r\n        },\r\n        error: function (error) {\r\n            this.isBusy = false;\r\n            this.isError = true;\r\n            this.isErroring = true;\r\n            this.isSuccess = false;\r\n            this.isSuccessing = false;\r\n            this.errors.push(error);\r\n            $timeout(function () {\r\n                this.isErroring = false;\r\n                this.button = null;\r\n            }.bind(this), 1000);\r\n        },\r\n        ready: function () {\r\n            this.isReady = true;\r\n            this.success();\r\n        },\r\n        errorMessage: function () {\r\n            return this.isError ? this.errors[this.errors.length - 1] : null;\r\n        },\r\n        submitClass: function () {\r\n            return {\r\n                busy: this.isBusy,\r\n                ready: this.isReady,\r\n                successing: this.isSuccessing,\r\n                success: this.isSuccess,\r\n                errorring: this.isErroring,\r\n                error: this.isError,\r\n            };\r\n        },\r\n        submitMessage: function (idleMessage, busyMessage, successMessage, errorMessage) {\r\n            idleMessage = idleMessage || 'Submit';\r\n            if (this.isBusy) {\r\n                return busyMessage || idleMessage;\r\n            } else if (this.isSuccess) {\r\n                return successMessage || idleMessage;\r\n            } else if (this.isError) {\r\n                return errorMessage || idleMessage;\r\n            } else {\r\n                return idleMessage;\r\n            }\r\n        },\r\n    };\r\n    return State;\r\n}]);\r\n\r\nmodule.factory('Animate', [function () {\r\n    function Animate(callback, useTimeout) {\r\n        this.callback = callback;\r\n        this.isPlaying = false;\r\n        this.key = null;\r\n        this.ticks = 0;\r\n        this.useTimeout = useTimeout === true ? true : false;\r\n    }\r\n    Animate.prototype = {\r\n        play: function () {\r\n            var _this = this;\r\n            function loop(time) {\r\n                _this.ticks++;\r\n                _this.callback(time, _this.ticks);\r\n                if (this.useTimeout) {\r\n                    _this.key = window.setTimeout(loop, 1000 / 60);\r\n                } else {\r\n                    _this.key = window.requestAnimationFrame(loop);\r\n                }\r\n            }\r\n            if (!this.key) {\r\n                this.isPlaying = true;\r\n                loop();\r\n            }\r\n        },\r\n        pause: function () {\r\n            if (this.key) {\r\n                if (this.useTimeout) {\r\n                    window.clearTimeout(this.key);\r\n                } else {\r\n                    window.cancelAnimationFrame(this.key);\r\n                }\r\n                this.key = null;\r\n                this.isPlaying = false;\r\n            }\r\n        },\r\n        playpause: function () {\r\n            if (this.key) {\r\n                this.pause();\r\n            } else {\r\n                this.play();\r\n            }\r\n        }\r\n    }\r\n    return Animate;\r\n}]);\r\n\r\nmodule.factory('Md5', [function () {\r\n\r\n    var hex_chr = '0123456789abcdef'.split('');\r\n\r\n    function cycle(x, k) {\r\n        var a = x[0], b = x[1], c = x[2], d = x[3];\r\n\r\n        a = ff(a, b, c, d, k[0], 7, -680876936);\r\n        d = ff(d, a, b, c, k[1], 12, -389564586);\r\n        c = ff(c, d, a, b, k[2], 17, 606105819);\r\n        b = ff(b, c, d, a, k[3], 22, -1044525330);\r\n        a = ff(a, b, c, d, k[4], 7, -176418897);\r\n        d = ff(d, a, b, c, k[5], 12, 1200080426);\r\n        c = ff(c, d, a, b, k[6], 17, -1473231341);\r\n        b = ff(b, c, d, a, k[7], 22, -45705983);\r\n        a = ff(a, b, c, d, k[8], 7, 1770035416);\r\n        d = ff(d, a, b, c, k[9], 12, -1958414417);\r\n        c = ff(c, d, a, b, k[10], 17, -42063);\r\n        b = ff(b, c, d, a, k[11], 22, -1990404162);\r\n        a = ff(a, b, c, d, k[12], 7, 1804603682);\r\n        d = ff(d, a, b, c, k[13], 12, -40341101);\r\n        c = ff(c, d, a, b, k[14], 17, -1502002290);\r\n        b = ff(b, c, d, a, k[15], 22, 1236535329);\r\n\r\n        a = gg(a, b, c, d, k[1], 5, -165796510);\r\n        d = gg(d, a, b, c, k[6], 9, -1069501632);\r\n        c = gg(c, d, a, b, k[11], 14, 643717713);\r\n        b = gg(b, c, d, a, k[0], 20, -373897302);\r\n        a = gg(a, b, c, d, k[5], 5, -701558691);\r\n        d = gg(d, a, b, c, k[10], 9, 38016083);\r\n        c = gg(c, d, a, b, k[15], 14, -660478335);\r\n        b = gg(b, c, d, a, k[4], 20, -405537848);\r\n        a = gg(a, b, c, d, k[9], 5, 568446438);\r\n        d = gg(d, a, b, c, k[14], 9, -1019803690);\r\n        c = gg(c, d, a, b, k[3], 14, -187363961);\r\n        b = gg(b, c, d, a, k[8], 20, 1163531501);\r\n        a = gg(a, b, c, d, k[13], 5, -1444681467);\r\n        d = gg(d, a, b, c, k[2], 9, -51403784);\r\n        c = gg(c, d, a, b, k[7], 14, 1735328473);\r\n        b = gg(b, c, d, a, k[12], 20, -1926607734);\r\n\r\n        a = hh(a, b, c, d, k[5], 4, -378558);\r\n        d = hh(d, a, b, c, k[8], 11, -2022574463);\r\n        c = hh(c, d, a, b, k[11], 16, 1839030562);\r\n        b = hh(b, c, d, a, k[14], 23, -35309556);\r\n        a = hh(a, b, c, d, k[1], 4, -1530992060);\r\n        d = hh(d, a, b, c, k[4], 11, 1272893353);\r\n        c = hh(c, d, a, b, k[7], 16, -155497632);\r\n        b = hh(b, c, d, a, k[10], 23, -1094730640);\r\n        a = hh(a, b, c, d, k[13], 4, 681279174);\r\n        d = hh(d, a, b, c, k[0], 11, -358537222);\r\n        c = hh(c, d, a, b, k[3], 16, -722521979);\r\n        b = hh(b, c, d, a, k[6], 23, 76029189);\r\n        a = hh(a, b, c, d, k[9], 4, -640364487);\r\n        d = hh(d, a, b, c, k[12], 11, -421815835);\r\n        c = hh(c, d, a, b, k[15], 16, 530742520);\r\n        b = hh(b, c, d, a, k[2], 23, -995338651);\r\n\r\n        a = ii(a, b, c, d, k[0], 6, -198630844);\r\n        d = ii(d, a, b, c, k[7], 10, 1126891415);\r\n        c = ii(c, d, a, b, k[14], 15, -1416354905);\r\n        b = ii(b, c, d, a, k[5], 21, -57434055);\r\n        a = ii(a, b, c, d, k[12], 6, 1700485571);\r\n        d = ii(d, a, b, c, k[3], 10, -1894986606);\r\n        c = ii(c, d, a, b, k[10], 15, -1051523);\r\n        b = ii(b, c, d, a, k[1], 21, -2054922799);\r\n        a = ii(a, b, c, d, k[8], 6, 1873313359);\r\n        d = ii(d, a, b, c, k[15], 10, -30611744);\r\n        c = ii(c, d, a, b, k[6], 15, -1560198380);\r\n        b = ii(b, c, d, a, k[13], 21, 1309151649);\r\n        a = ii(a, b, c, d, k[4], 6, -145523070);\r\n        d = ii(d, a, b, c, k[11], 10, -1120210379);\r\n        c = ii(c, d, a, b, k[2], 15, 718787259);\r\n        b = ii(b, c, d, a, k[9], 21, -343485551);\r\n\r\n        x[0] = add32(a, x[0]);\r\n        x[1] = add32(b, x[1]);\r\n        x[2] = add32(c, x[2]);\r\n        x[3] = add32(d, x[3]);\r\n\r\n    }\r\n\r\n    function cmn(q, a, b, x, s, t) {\r\n        a = add32(add32(a, q), add32(x, t));\r\n        return add32((a << s) | (a >>> (32 - s)), b);\r\n    }\r\n\r\n    function ff(a, b, c, d, x, s, t) {\r\n        return cmn((b & c) | ((~b) & d), a, b, x, s, t);\r\n    }\r\n\r\n    function gg(a, b, c, d, x, s, t) {\r\n        return cmn((b & d) | (c & (~d)), a, b, x, s, t);\r\n    }\r\n\r\n    function hh(a, b, c, d, x, s, t) {\r\n        return cmn(b ^ c ^ d, a, b, x, s, t);\r\n    }\r\n\r\n    function ii(a, b, c, d, x, s, t) {\r\n        return cmn(c ^ (b | (~d)), a, b, x, s, t);\r\n    }\r\n\r\n    function md51(s) {\r\n        var txt = '';\r\n        var n = s.length,\r\n        state = [1732584193, -271733879, -1732584194, 271733878], i;\r\n        for (i = 64; i <= s.length; i += 64) {\r\n            cycle(state, md5blk(s.substring(i - 64, i)));\r\n        }\r\n        s = s.substring(i - 64);\r\n        var tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        for (i = 0; i < s.length; i++)\r\n            tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\r\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\r\n        if (i > 55) {\r\n            cycle(state, tail);\r\n            for (i = 0; i < 16; i++) tail[i] = 0;\r\n        }\r\n        tail[14] = n * 8;\r\n        cycle(state, tail);\r\n        return state;\r\n    }\r\n\r\n    /* there needs to be support for Unicode here,\r\n        * unless we pretend that we can redefine the MD-5\r\n        * algorithm for multi-byte characters (perhaps\r\n        * by adding every four 16-bit characters and\r\n        * shortening the sum to 32 bits). Otherwise\r\n        * I suggest performing MD-5 as if every character\r\n        * was two bytes--e.g., 0040 0025 = @%--but then\r\n        * how will an ordinary MD-5 sum be matched?\r\n        * There is no way to standardize text to something\r\n        * like UTF-8 before transformation; speed cost is\r\n        * utterly prohibitive. The JavaScript standard\r\n        * itself needs to look at this: it should start\r\n        * providing access to strings as preformed UTF-8\r\n        * 8-bit unsigned value arrays.\r\n        */\r\n    function md5blk(s) { /* I figured global was faster.   */\r\n        var md5blks = [], i; /* Andy King said do it this way. */\r\n        for (i = 0; i < 64; i += 4) {\r\n            md5blks[i >> 2] = s.charCodeAt(i)\r\n            + (s.charCodeAt(i + 1) << 8)\r\n            + (s.charCodeAt(i + 2) << 16)\r\n            + (s.charCodeAt(i + 3) << 24);\r\n        }\r\n        return md5blks;\r\n    }\r\n\r\n    function rhex(n) {\r\n        var s = '', j = 0;\r\n        for (; j < 4; j++)\r\n            s += hex_chr[(n >> (j * 8 + 4)) & 0x0F]\r\n            + hex_chr[(n >> (j * 8)) & 0x0F];\r\n        return s;\r\n    }\r\n\r\n    function hex(x) {\r\n        for (var i = 0; i < x.length; i++)\r\n            x[i] = rhex(x[i]);\r\n        return x.join('');\r\n    }\r\n\r\n    /* this function is much faster,\r\n    so if possible we use it. Some IEs\r\n    are the only ones I know of that\r\n    need the idiotic second function,\r\n    generated by an if clause.  */\r\n    function add32(a, b) {\r\n        return (a + b) & 0xFFFFFFFF;\r\n    }\r\n\r\n    function Md5() { }\r\n    Md5.encode = function (string) {\r\n        return hex(md51(string));\r\n    }\r\n    if (Md5.encode('hello') !== '5d41402abc4b2a76b9719d911017c592') {\r\n        add32 = function (x, y) {\r\n            var lsw = (x & 0xFFFF) + (y & 0xFFFF),\r\n            msw = (x >> 16) + (y >> 16) + (lsw >> 16);\r\n            return (msw << 16) | (lsw & 0xFFFF);\r\n        }\r\n    }\r\n    return Md5;\r\n}]);\r\n\r\nmodule.factory('Utils', ['$compile', '$controller', 'Vector', 'Md5', function ($compile, $controller, Vector, Md5) {\r\n    (function () {\r\n        // POLYFILL window.requestAnimationFrame\r\n        var lastTime = 0;\r\n        var vendors = ['ms', 'moz', 'webkit', 'o'];\r\n        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n            window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame']\r\n                                       || window[vendors[x] + 'CancelRequestAnimationFrame'];\r\n        }\r\n        if (!window.requestAnimationFrame) {\r\n            window.requestAnimationFrame = function (callback, element) {\r\n                var currTime = new Date().getTime();\r\n                var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n                var id = window.setTimeout(function () { callback(currTime + timeToCall); }, timeToCall);\r\n                lastTime = currTime + timeToCall;\r\n                return id;\r\n            };\r\n        }\r\n        if (!window.cancelAnimationFrame) {\r\n            window.cancelAnimationFrame = function (id) {\r\n                clearTimeout(id);\r\n            };\r\n        }\r\n    }());\r\n    (function () {\r\n        // POLYFILL Array.prototype.reduce\r\n        // Production steps of ECMA-262, Edition 5, 15.4.4.21\r\n        // Reference: http://es5.github.io/#x15.4.4.21\r\n        // https://tc39.github.io/ecma262/#sec-array.prototype.reduce\r\n        if (!Array.prototype.reduce) {\r\n            Object.defineProperty(Array.prototype, 'reduce', {\r\n                value: function (callback) {// , initialvalue\r\n                    if (this === null) {\r\n                        throw new TypeError('Array.prototype.reduce called on null or undefined');\r\n                    }\r\n                    if (typeof callback !== 'function') {\r\n                        throw new TypeError(callback + ' is not a function');\r\n                    }\r\n                    var o = Object(this);\r\n                    var len = o.length >>> 0;\r\n                    var k = 0;\r\n                    var value;\r\n                    if (arguments.length == 2) {\r\n                        value = arguments[1];\r\n                    } else {\r\n                        while (k < len && !(k in o)) {\r\n                            k++;\r\n                        }\r\n                        if (k >= len) {\r\n                            throw new TypeError('Reduce of empty array with no initial value');\r\n                        }\r\n                        value = o[k++];\r\n                    }\r\n                    while (k < len) {\r\n                        if (k in o) {\r\n                            value = callback(value, o[k], k, o);\r\n                        }\r\n                        k++;\r\n                    }\r\n                    return value;\r\n                }\r\n            });\r\n        }\r\n    }());\r\n    var _isTouch;\r\n    function isTouch() {\r\n        if (!_isTouch) {\r\n            _isTouch = {\r\n                value: ('ontouchstart' in window || 'onmsgesturechange' in window)\r\n            }\r\n        }\r\n        // console.log(_isTouch);\r\n        return _isTouch.value;\r\n    }\r\n    function getTouch(e, previous) {\r\n        var t = new Vector();\r\n        if (e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel') {\r\n            var touch = null;\r\n            var event = e.originalEvent ? e.originalEvent : e;\r\n            var touches = event.touches.length ? event.touches : event.changedTouches;\r\n            if (touches && touches.length) {\r\n                touch = touches[0];\r\n            }\r\n            if (touch) {\r\n                t.x = touch.pageX;\r\n                t.y = touch.pageY;\r\n            }\r\n        } else if (e.type == 'click' || e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover' || e.type == 'mouseout' || e.type == 'mouseenter' || e.type == 'mouseleave') {\r\n            t.x = e.pageX;\r\n            t.y = e.pageY;\r\n        }\r\n        if (previous) {\r\n            t.s = Vector.difference(previous, t);\r\n        }\r\n        t.type = e.type;\r\n        return t;\r\n    }\r\n    function getRelativeTouch(element, point) {\r\n        var rect = element[0].getBoundingClientRect();\r\n        var e = new Vector(rect.left, rect.top);\r\n        return Vector.difference(e, point);\r\n    }\r\n    function getClosest(el, selector) {\r\n        var matchesFn, parent;\r\n        ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\r\n            if (typeof document.body[fn] == 'function') {\r\n                matchesFn = fn;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        if (el[matchesFn](selector)) {\r\n            return el;\r\n        }\r\n        while (el !== null) {\r\n            parent = el.parentElement;\r\n            if (parent !== null && parent[matchesFn](selector)) {\r\n                return parent;\r\n            }\r\n            el = parent;\r\n        }\r\n        return null;\r\n    }\r\n    function getClosestElement(el, target) {\r\n        var matchesFn, parent;\r\n        if (el === target) {\r\n            return el;\r\n        }\r\n        while (el !== null) {\r\n            parent = el.parentElement;\r\n            if (parent !== null && parent === target) {\r\n                return parent;\r\n            }\r\n            el = parent;\r\n        }\r\n        return null;\r\n    }\r\n    var getNow = Date.now || function () {\r\n        return new Date().getTime();\r\n    };\r\n    function throttle(func, wait, options) {\r\n        // Returns a function, that, when invoked, will only be triggered at most once\r\n        // during a given window of time. Normally, the throttled function will run\r\n        // as much as it can, without ever going more than once per `wait` duration;\r\n        // but if you'd like to disable the execution on the leading edge, pass\r\n        // `{leading: false}`. To disable execution on the trailing edge, ditto.\r\n        var context, args, result;\r\n        var timeout = null;\r\n        var previous = 0;\r\n        if (!options) options = {};\r\n        var later = function () {\r\n            previous = options.leading === false ? 0 : getNow();\r\n            timeout = null;\r\n            result = func.apply(context, args);\r\n            if (!timeout) context = args = null;\r\n        };\r\n        return function () {\r\n            var now = getNow();\r\n            if (!previous && options.leading === false) previous = now;\r\n            var remaining = wait - (now - previous);\r\n            context = this;\r\n            args = arguments;\r\n            if (remaining <= 0 || remaining > wait) {\r\n                if (timeout) {\r\n                    clearTimeout(timeout);\r\n                    timeout = null;\r\n                }\r\n                previous = now;\r\n                result = func.apply(context, args);\r\n                if (!timeout) context = args = null;\r\n            } else if (!timeout && options.trailing !== false) {\r\n                timeout = setTimeout(later, remaining);\r\n            }\r\n            return result;\r\n        };\r\n    }\r\n    function where(array, query) {\r\n        var found = null;\r\n        if (array) {\r\n            angular.forEach(array, function (item) {\r\n                var has = true;\r\n                angular.forEach(query, function (value, key) {\r\n                    has = has && item[key] === value;\r\n                });\r\n                if (has) {\r\n                    found = item;\r\n                }\r\n            });\r\n        }\r\n        return found;\r\n    }\r\n    function compileController(scope, element, html, data) {\r\n        // console.log('Utils.compileController', element);\r\n        element.html(html);\r\n        var link = $compile(element.contents());\r\n        if (data.controller) {\r\n            var $scope = scope.$new();\r\n            angular.extend($scope, data);\r\n            var controller = $controller(data.controller, { $scope: $scope });\r\n            if (data.controllerAs) {\r\n                scope[data.controllerAs] = controller;\r\n            }\r\n            element.data('$ngControllerController', controller);\r\n            element.children().data('$ngControllerController', controller);\r\n            scope = $scope;\r\n        }\r\n        link(scope);\r\n    }\r\n    var ua = window.navigator.userAgent.toLowerCase();\r\n    var safari = ua.indexOf('safari') !== -1 && ua.indexOf('chrome') === -1;\r\n    var msie = ua.indexOf('trident') !== -1 || ua.indexOf('edge') !== -1 || ua.indexOf('msie') !== -1;\r\n    var chrome = !safari && !msie && ua.indexOf('chrome') !== -1;\r\n    var mobile = ua.indexOf('mobile') !== -1;\r\n    function Utils() {\r\n    }\r\n    function reverseSortOn(key) {\r\n        return function (a, b) {\r\n            if (a[key] < b[key]) {\r\n                return 1;\r\n            }\r\n            if (a[key] > b[key]) {\r\n                return -1;\r\n            }\r\n            // a must be equal to b\r\n            return 0;\r\n        }\r\n    }\r\n    function format(string, prepend, expression) {\r\n        string = string || '';\r\n        prepend = prepend || '';\r\n        var splitted = string.split(',');\r\n        if (splitted.length > 1) {\r\n            var formatted = splitted.shift();\r\n            angular.forEach(splitted, function (value, index) {\r\n                if (expression) {\r\n                    formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\r\n                } else {\r\n                    formatted = formatted.split('{' + index + '}').join(prepend + value);\r\n                }\r\n            });\r\n            if (expression) {\r\n                return '\\'' + formatted + '\\'';\r\n            } else {\r\n                return formatted;\r\n            }\r\n        } else {\r\n            return prepend + string;\r\n        }\r\n    }\r\n    function reducer(o, key) {\r\n        return o[key];\r\n    }\r\n    function reducerSetter(o, key, value) {\r\n        if (typeof key == 'string') {\r\n            return reducerSetter(o, key.split('.'), value);\r\n        } else if (key.length == 1 && value !== undefined) {\r\n            return o[key[0]] = value;\r\n        } else if (key.length == 0) {\r\n            return o;\r\n        } else {\r\n            return reducerSetter(o[key[0]], key.slice(1), value);\r\n        }\r\n    }\r\n    function reducerAdder(o, key, value) {\r\n        if (typeof key == 'string') {\r\n            return reducerAdder(o, key.split('.'), value);\r\n        } else if (key.length == 1 && value !== undefined) {\r\n            return (o[key[0]] += value);\r\n        } else if (key.length == 0) {\r\n            return o;\r\n        } else {\r\n            return reducerAdder(o[key[0]], key.slice(1), value);\r\n        }\r\n    }\r\n    Utils.reverseSortOn = reverseSortOn;\r\n    Utils.getTouch = getTouch;\r\n    Utils.getRelativeTouch = getRelativeTouch;\r\n    Utils.getClosest = getClosest;\r\n    Utils.getClosestElement = getClosestElement;\r\n    Utils.throttle = throttle;\r\n    Utils.where = where;\r\n    Utils.format = format;\r\n    Utils.compileController = compileController;\r\n    Utils.reducer = reducer;\r\n    Utils.reducerSetter = reducerSetter;\r\n    Utils.reducerAdder = reducerAdder;\r\n    Utils.toMd5 = function (string) {\r\n        return Md5.encode(string);\r\n    };\r\n    Utils.ua = {\r\n        safari: safari,\r\n        msie: msie,\r\n        chrome: chrome,\r\n        mobile: mobile,\r\n    };\r\n    angular.forEach(Utils.ua, function (value, key) {\r\n        if (value) {\r\n            angular.element(document.getElementsByTagName('body')).addClass(key);\r\n        }\r\n    });\r\n    return Utils;\r\n}]);\r\n\r\nmodule.factory('Vector', function () {\r\n    function Vector(x, y) {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n    }\r\n    Vector.make = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.size = function (a) {\r\n        return Math.sqrt(a.x * a.x + a.y * a.y);\r\n    };\r\n    Vector.normalize = function (a) {\r\n        var l = Vector.size(a);\r\n        a.x /= l;\r\n        a.y /= l;\r\n        return a;\r\n    };\r\n    Vector.incidence = function (a, b) {\r\n        var angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\r\n        // if (angle < 0) angle += 2 * Math.PI;\r\n        // angle = Math.min(angle, (Math.PI * 2 - angle));\r\n        return angle;\r\n    };\r\n    Vector.distance = function (a, b) {\r\n        return Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\r\n    };\r\n    Vector.cross = function (a, b) {\r\n        return (a.x * b.y) - (a.y * b.x);\r\n    };\r\n    Vector.difference = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.power = function (a, b) {\r\n        var x = Math.abs(b.x - a.x);\r\n        var y = Math.abs(b.y - a.y);\r\n        return (x + y) / 2;\r\n    };\r\n    Vector.prototype = {\r\n        size: function () {\r\n            return Vector.size(this);\r\n        },\r\n        normalize: function () {\r\n            return Vector.normalize(this);\r\n        },\r\n        incidence: function (b) {\r\n            return Vector.incidence(this, b);\r\n        },\r\n        cross: function (b) {\r\n            return Vector.cross(this, b);\r\n        },\r\n        distance: function (b) {\r\n            return Vector.distance(this, b);\r\n        },\r\n        difference: function (b) {\r\n            return Vector.difference(this, b);\r\n        },\r\n        power: function () {\r\n            return (Math.abs(this.x) + Math.abs(this.y)) / 2;\r\n        },\r\n        towards: function (b, friction) {\r\n            friction = friction || 0.125;\r\n            this.x += (b.x - this.x) * friction;\r\n            this.y += (b.y - this.y) * friction;\r\n            return this;\r\n        },\r\n        add: function (b) {\r\n            this.x += b.x;\r\n            this.y += b.y;\r\n            return this;\r\n        },\r\n        friction: function (b) {\r\n            this.x *= b;\r\n            this.y *= b;\r\n            return this;\r\n        },\r\n        copy: function (b) {\r\n            return new Vector(this.x, this.y);\r\n        },\r\n        toString: function () {\r\n            return '{' + this.x + ',' + this.y + '}';\r\n        },\r\n    };\r\n    return Vector;\r\n});\r\n\r\nmodule.factory('ElementRect', ['Vector', function (Vector) {\r\n    function ElementRect() {\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.center = new Vector();\r\n    }\r\n    ElementRect.fromNative = function (nativeElement) {\r\n        return new ElementRect().set(nativeElement);\r\n    }\r\n    ElementRect.prototype = {\r\n        set: function (nativeElement) {\r\n            var rect = nativeElement.getBoundingClientRect();\r\n            this.x = rect.left;\r\n            this.y = rect.top;\r\n            this.width = nativeElement.offsetWidth;\r\n            this.height = nativeElement.offsetHeight;\r\n            this.center.x = this.x + this.width / 2;\r\n            this.center.y = this.y + this.height / 2;\r\n            this.native = nativeElement;\r\n            return this;\r\n        },\r\n        offset: function (vector) {\r\n            this.x += vector.x;\r\n            this.y += vector.y;\r\n            this.center.x = this.x + this.width / 2;\r\n            this.center.y = this.y + this.height / 2;\r\n            return this;\r\n        },\r\n        intersect: function (element) {\r\n            // console.log('intersect.this', this, 'element', element);\r\n            return !(element.x > this.x + this.width ||\r\n                        element.x + element.width < this.x ||\r\n                        element.y > this.y + this.height ||\r\n                        element.y + element.height < this.y);\r\n        },\r\n        toString: function () {\r\n            return '{' + this.x + ',' + this.y + ',' + this.width + ',' + this.height + '}';\r\n        },\r\n    };\r\n    return ElementRect;\r\n}]);\r\n\r\nmodule.factory('Style', function () {\r\n    var prefix = function detectTransformProperty() {\r\n        var transform = 'transform',\r\n            webkit = 'webkitTransform';\r\n        var div = document.createElement(\"DIV\");\r\n        if (typeof div.style[transform] !== 'undefined') {\r\n            ['webkit', 'moz', 'o', 'ms'].every(function (prop) {\r\n                var prefixed = '-' + prop + '-transform';\r\n                if (typeof div.style[prefixed] !== 'undefined') {\r\n                    prefix = prefixed;\r\n                    return false;\r\n                }\r\n                return true;\r\n            });\r\n        } else if (typeof div.style[webkit] !== 'undefined') {\r\n            prefix = '-webkit-transform';\r\n        } else {\r\n            prefix = undefined;\r\n        }\r\n        return prefix;\r\n    }();\r\n    function Style() {\r\n        this.props = {\r\n            scale: 1,\r\n            hoverScale: 1,\r\n            currentScale: 1,\r\n        }\r\n    }\r\n    Style.prototype = {\r\n        set: function (element) {\r\n            var styles = [];\r\n            angular.forEach(this, function (value, key) {\r\n                if (key !== 'props')\r\n                    styles.push(key + ':' + value);\r\n            });\r\n            element.style.cssText = styles.join(';') + ';';\r\n        },\r\n        transform: function (transform) {\r\n            this[prefix] = transform;\r\n        },\r\n        transformOrigin: function (x, y) {\r\n            this[prefix + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\r\n            this[prefix + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\r\n        },\r\n    };\r\n    Style.prefix = prefix;\r\n    return Style;\r\n});\r\n\n/* global angular, module */\r\n\r\nmodule.factory('Column', ['$parse', '$filter', 'Utils', 'colTypes', function ($parse, $filter, Utils, colTypes) {\r\n    var totalTypes = {\r\n        SUM: 1,\r\n        MIN: 2,\r\n        MAX: 3,\r\n        AVG: 4,\r\n    }\r\n    function Column(data) {\r\n        this.typeTotal = this.typeTotal || totalTypes.SUM;\r\n        data ? angular.extend(this, data) : null;\r\n        // PREPARE GETTER SETTERS\r\n        if (angular.isFunction(this.value)) {\r\n            this.value = this.value.bind(this);\r\n        }\r\n        this.name = this.name || this.value;\r\n        this.raw = this.raw || this.value;\r\n        this.key = this.key || this.value;\r\n        this.source = this.source || this.value;\r\n        this.getters = {};\r\n        var fields = ['key', 'value', 'raw', 'source', 'post'];\r\n        angular.forEach(fields, function (field) {\r\n            if (this[field]) {\r\n                this.getters[field] = angular.isFunction(this[field]) ? this[field] : $parse(this[field]);\r\n            }\r\n        }, this);\r\n        this.setters = {};\r\n        angular.forEach(this.getters, function (getter, key) {\r\n            if (!angular.isFunction(this[key])) {\r\n                this.setters[key] = getter.assign;\r\n            }\r\n        }, this);\r\n        // PREPARE GETTER SETTERS\r\n        this.reset();\r\n    }\r\n    Column.prototype = {\r\n        getKey: function (item) {\r\n            return this.getters.key(item);\r\n        },\r\n        getValue: function (item) {\r\n            return this.getters.value(item);\r\n        },\r\n        getRaw: function (item) {\r\n            return this.getters.raw(item);\r\n        },\r\n        getSource: function (item) {\r\n            return this.getters.source(item);\r\n        },\r\n        reset: function () {\r\n            this.values = [];\r\n            this.keys = {};\r\n            this.search = [];\r\n            this.total = 0;\r\n        },\r\n        hasKey: function (item) {\r\n            var has = true;\r\n            var key = this.getKey(item);\r\n            if (key && this.keys[key] != true) {\r\n                this.keys[key] = true;\r\n                has = false;\r\n            }\r\n            return has;\r\n        },\r\n        initValue: function (item) {\r\n            this.setters.raw(item, (this.getters.value(item) || 0));\r\n            return this;\r\n        },\r\n        addTotal: function (item, row) {\r\n            var a = (this.getters.raw(item) || 0);\r\n            var b = (this.getters.value(row) || 0);\r\n            switch (this.typeTotal) {\r\n                case totalTypes.MIN:\r\n                    this.setters.raw(item, Math.min(a, b));\r\n                    break;\r\n                case totalTypes.MAX:\r\n                    this.setters.raw(item, Math.max(a, b));\r\n                    break;\r\n                case totalTypes.AVG:\r\n                    var n = 0;\r\n                    this.setters.raw(item, (b + (a * n)) / (n + 1)); // (newVal + (avg * n)) / (n+1)\r\n                    break;\r\n                default:\r\n                    this.setters.raw(item, a + b);\r\n            }\r\n            return this;\r\n        },\r\n        addCount: function (item, row) {\r\n            if (!this.hasKey(row) && this.setters.raw) {\r\n                var v = null;\r\n                if (item != row) {\r\n                    v = (this.getters.raw(item) || 0) + 1;\r\n                } else {\r\n                    v = 1;\r\n                }\r\n                this.setters.raw(item, v);\r\n            }\r\n            return this;\r\n        },\r\n        addValue: function (item) {\r\n            this.values = this.values || [];\r\n            var key = this.getKey(item);\r\n            var has = false;\r\n            angular.forEach(this.values, function (v) {\r\n                if (v.id == key) {\r\n                    has = true;\r\n                }\r\n            })\r\n            if (!has) {\r\n                var value = this.getRaw(item);\r\n                this.values.push({\r\n                    id: key,\r\n                    name: value || '-',\r\n                });\r\n            }\r\n        },\r\n        getValueTotal: function (filtered) {\r\n            var value = 0;\r\n            if (this.compare && this.type === colTypes.INCREMENT) {\r\n                var current = 0; // (col.getters.raw(item) || 0);\r\n                var previous = 0; // (this.getters.raw(item) || 0);                \r\n                angular.forEach(filtered, function (item) {\r\n                    current += (this.col.getters.raw(item) || 0);\r\n                    previous += (this.getters.raw(item) || 0);\r\n                }.bind(this));\r\n                if (previous) {\r\n                    value = (current - previous) / previous * 100;\r\n                }\r\n            } else {\r\n                switch (this.typeTotal) {\r\n                    case totalTypes.SUM:\r\n                        value = 0;\r\n                        break;\r\n                    case totalTypes.MIN:\r\n                        value = Number.POSITIVE_INFINITY;\r\n                        break;\r\n                    case totalTypes.MAX:\r\n                        value = Number.NEGATIVE_INFINITY;\r\n                        break;\r\n                    case totalTypes.AVG:\r\n                        break;\r\n                }\r\n                angular.forEach(filtered, function (item, i) {\r\n                    var a = value;\r\n                    var b = (this.getRaw(item) || 0);\r\n                    switch (this.typeTotal) {\r\n                        case totalTypes.SUM:\r\n                            value = a + b;\r\n                            break;\r\n                        case totalTypes.MIN:\r\n                            value = a < b ? a : b;\r\n                            break;\r\n                        case totalTypes.MAX:\r\n                            value = a > b ? a : b;\r\n                            break;\r\n                        case totalTypes.AVG:\r\n                            value = (b + (a * i)) / (i + 1);\r\n                            break;\r\n                    }\r\n                }.bind(this));\r\n                (value === Number.POSITIVE_INFINITY || value === Number.NEGATIVE_INFINITY) ? value = 0 : null;\r\n            }\r\n            this.total = value;\r\n            return value;\r\n        },\r\n        getValueFormatted: function (item) {\r\n            var value = this.getRaw(item);\r\n            switch (this.type) {\r\n                case colTypes.RESOURCE:\r\n                case colTypes.DISABLED:\r\n                    value = $filter('shortName')(value);\r\n                    break;\r\n                case colTypes.ID:\r\n                case colTypes.NUMBER:\r\n                    value = $filter('customNumber')(value, 0);\r\n                    break;\r\n                case colTypes.DOUBLE:\r\n                    value = $filter('customNumber')(value, 2);\r\n                    break;\r\n                case colTypes.WEEKS:\r\n                    value = $filter('customNumber')(value, 2, ' W');\r\n                    break;\r\n                case colTypes.DATE:\r\n                    value = $filter('date')(value, 'yyyy-MM-dd');\r\n                    break;\r\n                case colTypes.HOURS:\r\n                    value = $filter('customNumber')(value, 0, ' H');\r\n                    break;\r\n                case colTypes.COSTS:\r\n                    value = $filter('customNumber')(value, 0, ' €');\r\n                    break;\r\n                case colTypes.PERCENT:\r\n                    value = $filter('customNumber')(value, 2, ' %');\r\n                    break;\r\n                case colTypes.INCREMENT:\r\n                    value = angular.isNumber(value) ? (value > 0 ? '+' : '') + $filter('customNumber')(value, 2, ' %') : (value || '-');\r\n                    break;\r\n            }\r\n            return value;\r\n        },\r\n        getFormatted: function (item) {\r\n            if (this.dynamic) {\r\n                return this.getValueFormatted(item);\r\n            } else {\r\n                return item.static[this.id].value;\r\n            }\r\n        },\r\n        getTotal: function (filtered) {\r\n            var value = this.getValueTotal(filtered);\r\n            switch (this.type) {\r\n                case colTypes.NUMBER:\r\n                    value = $filter('customNumber')(value, 0);\r\n                    break;\r\n                case colTypes.DOUBLE:\r\n                    value = $filter('customNumber')(value, 2);\r\n                    break;\r\n                case colTypes.WEEKS:\r\n                    value = $filter('customNumber')(value, 2, ' W');\r\n                    break;\r\n                case colTypes.HOURS:\r\n                    value = $filter('customNumber')(value, 0, ' H');\r\n                    break;\r\n                case colTypes.COSTS:\r\n                    value = $filter('customNumber')(value, 0, ' €');\r\n                    break;\r\n                case colTypes.PERCENT:\r\n                    value = $filter('customNumber')(value, 2, ' %');\r\n                    break;\r\n                case colTypes.INCREMENT:\r\n                    value = angular.isNumber(value) ? (value > 0 ? '+' : '') + $filter('customNumber')(value, 2, ' %') : (value || '-');\r\n                    break;\r\n                case colTypes.DATE:\r\n                    value = $filter('date')(value, 'yyyy-MM-dd');\r\n                    break;\r\n            }\r\n            return value;\r\n        },\r\n        getFormat: function () {\r\n            var format = '';\r\n            switch (this.type) {\r\n                case colTypes.ID:\r\n                case colTypes.NUMBER:\r\n                    format = '#';\r\n                    break;\r\n                case colTypes.DOUBLE:\r\n                    format = '#';\r\n                    break;\r\n                case colTypes.DATE:\r\n                    format = 'yyyy-mm-dd';\r\n                    break;\r\n                case colTypes.WEEKS:\r\n                    format = '#,###0 [$W]';\r\n                    break;\r\n                case colTypes.HOURS:\r\n                    format = '#,###0 [$H]';\r\n                    break;\r\n                case colTypes.COSTS:\r\n                    format = '#,###.00 €';\r\n                    break;\r\n                case colTypes.PERCENT:\r\n                    format = '0.00%';\r\n                    break;\r\n                case colTypes.INCREMENT:\r\n                    format = '[Color 10]+0.00%;[Red]-0.00%;-';\r\n                    break;\r\n            }\r\n            return format;\r\n        },\r\n        getLink: function (item) {\r\n            return angular.isFunction(this.link) ? this.link(item) : null;\r\n        },\r\n        getHeaderClass: function () {\r\n            var cc = [];\r\n            angular.forEach(this, function (value, key) {\r\n                if (value === true) {\r\n                    cc.push(key);\r\n                }\r\n            });\r\n            switch (this.type) {\r\n                case colTypes.NUMBER:\r\n                case colTypes.DOUBLE:\r\n                case colTypes.WEEKS:\r\n                case colTypes.HOURS:\r\n                case colTypes.COSTS:\r\n                case colTypes.PERCENT:\r\n                case colTypes.INCREMENT:\r\n                    cc.push('text-xs-right');\r\n                    break;\r\n            }\r\n            var columnClass = this.getColumnClass();\r\n            if (columnClass != '') {\r\n                cc.push(columnClass);\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getCellClass: function (item) {\r\n            var cc = [];\r\n            angular.forEach(this, function (value, key) {\r\n                if (value === true) {\r\n                    cc.push(key);\r\n                }\r\n            });\r\n            switch (this.type) {\r\n                case colTypes.LINK:\r\n                    cc.push('text-underline');\r\n                    break;\r\n                case colTypes.NUMBER:\r\n                case colTypes.DOUBLE:\r\n                case colTypes.WEEKS:\r\n                case colTypes.HOURS:\r\n                case colTypes.COSTS:\r\n                    cc.push('text-xs-right');\r\n                    break;\r\n                case colTypes.PERCENT:\r\n                    cc.push('text-xs-right');\r\n                    break;\r\n                case colTypes.INCREMENT:\r\n                    cc.push('text-xs-right');\r\n                    break;\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getColumnClass: function () {\r\n            return this.color ? 'shade-light-blue-' + this.color : '';\r\n        },\r\n        getItemClass: function (item) {\r\n            var cc = [];\r\n            cc.push(item.static[this.id].baseClass);\r\n            var columnClass = this.getColumnClass();\r\n            if (columnClass != '') {\r\n                cc.push(columnClass);\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getTextClass: function (item) {\r\n            var cc = [];\r\n            switch (this.type) {\r\n                case colTypes.INCREMENT:\r\n                    var value = this.getRaw(item);\r\n                    if (angular.isNumber(value) && value < 0) {\r\n                        cc.push('text-danger');\r\n                    } else {\r\n                        cc.push('text-success');\r\n                    }\r\n                    break;\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getTotalClass: function (filtered) {\r\n            var cc = [];\r\n            switch (this.type) {\r\n                case colTypes.NUMBER:\r\n                case colTypes.DOUBLE:\r\n                case colTypes.WEEKS:\r\n                case colTypes.HOURS:\r\n                case colTypes.COSTS:\r\n                case colTypes.PERCENT:\r\n                case colTypes.INCREMENT:\r\n                    cc.push('text-xs-right');\r\n                    break;\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        searchToggle: function (item) {\r\n            var index = this.search.indexOf(item.id);\r\n            if (index === -1) {\r\n                item.active = true;\r\n                this.search.push(item.id);\r\n            } else {\r\n                item.active = false;\r\n                this.search.splice(index, 1);\r\n            }\r\n        },\r\n        isActive: function () {\r\n            if (angular.isFunction(this.active) && this.active) {\r\n                return this.active();\r\n            } else {\r\n                return this.active;\r\n            }\r\n        },\r\n        toggle: function () {\r\n            angular.isFunction(this.active) ? null : this.active = !this.active;\r\n        },\r\n        activate: function () {\r\n            angular.isFunction(this.active) ? null : this.active = true;\r\n        },\r\n        deactivate: function () {\r\n            angular.isFunction(this.active) ? null : this.active = false;\r\n        },\r\n        makeStatic: function (item) {\r\n            if (this.post) {\r\n                this.setters.raw(item, (this.getters.post(item) || 0));\r\n            }\r\n            var col = this;\r\n            item.static[col.id] = {\r\n                baseClass: col.getCellClass(item),\r\n                textClass: col.getTextClass(item),\r\n                value: col.getValueFormatted(item),\r\n                link: col.link ? col.link(item) : null,\r\n                pop: col.pop ? col.pop(item) : null,\r\n            };\r\n        },\r\n    };\r\n    Column.types = colTypes;\r\n    return Column;\r\n}]);\r\n\r\nmodule.factory('Columns', ['$parse', 'Utils', 'Column', 'colTypes', function ($parse, Utils, Column, colTypes) {\r\n    function Columns(columns) {\r\n        var list = [];\r\n        if (columns) {\r\n            angular.forEach(columns, function (col, index) {\r\n                col.id = index + 1;\r\n                list.push(new Column(col));\r\n            });\r\n        }\r\n        angular.extend(list, Columns.prototype);\r\n        return list;\r\n    }\r\n    Columns.prototype = {\r\n        show: {\r\n            table: true, // defaults\r\n        },\r\n        getCount: function () {\r\n            var i = 0;\r\n            angular.forEach(this, function (col) {\r\n                i += col.isActive() ? 1 : 0;\r\n            }.bind(this));\r\n            return i;\r\n        },\r\n        getFirstCol: function () {\r\n            var first = null;\r\n            angular.forEach(this, function (col) {\r\n                if (first === null && col.isActive() && col.groupBy && col.value !== 'month' && col.value !== 'monthShort') {\r\n                    first = col;\r\n                }\r\n            });\r\n            return first;\r\n        },\r\n        getChartKey: function (item, time) {\r\n            var keys = [];\r\n            angular.forEach(this, function (col) {\r\n                if (col.isActive() && col.groupBy && col.value !== 'month' && col.value !== 'monthShort' && keys.length === 0) {\r\n                    keys.push(col.getKey(item));\r\n                }\r\n            });\r\n            keys.push(time);\r\n            return keys.join('-');\r\n        },\r\n        getGroupKey: function (item) {\r\n            var keys = [];\r\n            angular.forEach(this, function (col) {\r\n                if (col.isActive() && col.groupBy) {\r\n                    keys.push(col.getKey(item));\r\n                }\r\n            });\r\n            return keys.join('-');\r\n        },\r\n        getSortKey: function (item) {\r\n            var values = [];\r\n            angular.forEach(this, function (col) {\r\n                if (col.isActive() && col.groupBy) {\r\n                    values.push(col.sort ? $parse(col.sort)(item) : col.getValueFormatted(item));\r\n                }\r\n            });\r\n            return values.join('');\r\n        },\r\n        expand: function (data) {\r\n            var options = {\r\n                dynamic: true,\r\n                compare: true,\r\n            }\r\n            data ? angular.extend(options, data) : null;\r\n            // add percentuals and compares\r\n            var array = [], cols = this;\r\n            array.radios = {};\r\n            angular.forEach(this, function (col, index) {\r\n                col.id = array.length + 1;\r\n                array.push(col);\r\n                if (col.aggregate) {\r\n                    if (options.dynamic) {\r\n                        array.push(new Column({\r\n                            id: array.length + 1,\r\n                            name: '%',\r\n                            value: function (item) {\r\n                                return col.getters.raw(item) / col.total * 100;\r\n                            },\r\n                            key: col.key,\r\n                            type: colTypes.PERCENT,\r\n                            dynamic: true,\r\n                            active: function () {\r\n                                return array.show.dynamic && col.active;\r\n                            },\r\n                            col: col,\r\n                        }));\r\n                    }\r\n                    if (options.compare) {\r\n                        array.push(new Column({\r\n                            id: array.length + 1,\r\n                            name: 'anno precedente',\r\n                            value: function (item) {\r\n                                return this.getters.raw(item);\r\n                            },\r\n                            raw: col.value + 'Last',\r\n                            source: col.value,\r\n                            key: col.key,\r\n                            type: col.type, // \r\n                            count: col.count,\r\n                            compare: true,\r\n                            dynamic: true,\r\n                            active: function () {\r\n                                return array.show.compare && col.active;\r\n                            },\r\n                            col: col,\r\n                        }));\r\n                        array.push(new Column({\r\n                            id: array.length + 1,\r\n                            name: '%',\r\n                            value: function (item) {\r\n                                var current = (col.getters.raw(item) || 0);\r\n                                var previous = (this.getters.raw(item) || 0);\r\n                                if (previous) {\r\n                                    return (current - previous) / previous * 100;\r\n                                } else {\r\n                                    return null; // '+∞ %';\r\n                                }\r\n                            },\r\n                            raw: col.value + 'Gain',\r\n                            source: col.value,\r\n                            key: col.key,\r\n                            type: colTypes.INCREMENT, // col.type, // \r\n                            count: col.count,\r\n                            compare: true,\r\n                            dynamic: true,\r\n                            active: function () {\r\n                                return array.show.compare && col.active;\r\n                            },\r\n                            col: col,\r\n                        }));\r\n                    }\r\n                }\r\n                if (col.radio && col.active) {\r\n                    array.radios[col.radio] = col.value;\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getGroups: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.groupBy) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getAggregates: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.aggregate && !col.count) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getPercentages: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.type === colTypes.PERCENT) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getDynamics: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.dynamic) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getCompares: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.compare) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getCounters: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.count) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        reset: function () {\r\n            this.groups = {};\r\n            angular.forEach(this, function (col) {\r\n                col.reset();\r\n            });\r\n            return this;\r\n        },\r\n        makeStatic: function (items) {\r\n            //console.log('Columns.makeStatic', 'items', items.length);\r\n            angular.forEach(this, function (col, index) {\r\n                col.values = [];\r\n                col.static = {\r\n                    active: col.isActive(),\r\n                    headerClass: col.getHeaderClass(),\r\n                };\r\n            });\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.static.active || col.dynamic || col.always) {\r\n                    angular.forEach(items, function (item) {\r\n                        col.makeStatic(item);\r\n                        col.groupBy ? col.addValue(item) : null;\r\n                    });\r\n                    if (col.groupBy) {\r\n                        col.values = col.values.sort(function (va, vb) {\r\n                            var a, b;\r\n                            a = va.name ? String(va.name).toLowerCase() : ''; // ignore upper and lowercase\r\n                            b = vb.name ? String(vb.name).toLowerCase() : ''; // ignore upper and lowercase\r\n                            if (a < b) {\r\n                                return -1;\r\n                            }\r\n                            if (a > b) {\r\n                                return 1;\r\n                            }\r\n                            return 0;\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        activeInRange: function (range) {\r\n            var flag = false;\r\n            var i = 0;\r\n            while (!flag && i < this.length) {\r\n                var col = this[i];\r\n                if (col.static.active) {\r\n                    flag = (range.indexOf(col.value) !== -1);\r\n                }\r\n                i++;\r\n            }\r\n            return flag;\r\n        },\r\n        unique: function (row, items) {\r\n            var key = this.getGroupKey(row);\r\n            var item = this.groups[key];\r\n            if (!item) {\r\n                item = this.groups[key] = row; // angular.copy(row);\r\n                item.static = [];\r\n                items.push(item);\r\n            }\r\n            return item;\r\n        },\r\n        iterate: function (row, items) {\r\n            row = angular.copy(row);\r\n            var item = this.unique(row, items);\r\n            this.addTotals(item, row);\r\n        },\r\n        compare: function (row, items) {\r\n            row = angular.copy(row);\r\n            angular.forEach(this, function (col) {\r\n                if (col.compare) {\r\n                    var value = col.getters.source(row);\r\n                    col.setters.raw(row, value);\r\n                }\r\n            });\r\n            angular.forEach(this, function (col) {\r\n                if (col.compare) {\r\n                    col.setters.source(row, 0);\r\n                }\r\n            });\r\n            var item = this.unique(row, items);\r\n            this.addTotals(item, row, true);\r\n        },\r\n        addTotals: function (item, row, comparing) {\r\n            angular.forEach(this, function (col) {\r\n                if ((col.isActive() || col.always) && (comparing ? col.compare : !col.compare)) {\r\n                    if (col.count) {\r\n                        col.addCount(item, row);\r\n                    } else if (comparing || col.aggregate) {\r\n                        if (!col.hasKey(row)) {\r\n                            if (item === row) {\r\n                                col.initValue(item);\r\n                            } else {\r\n                                col.addTotal(item, row);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            return this;\r\n        },\r\n        toggleColumns: function (c) {\r\n            if (c.radio) {\r\n                angular.forEach(this, function (col) {\r\n                    if (c.radio === col.radio && c !== col) {\r\n                        col.deactivate();\r\n                    }\r\n                });\r\n                c.activate();\r\n                this.radios[c.radio] = c.value;\r\n            } else {\r\n                c.toggle();\r\n            }\r\n        },\r\n        searchDisabled: function (item, col, filtered) {\r\n            var id = item.id, t = this;\r\n            var has = false, index = 0;\r\n            while (index < filtered.length) {\r\n                has = has || col.getKey(filtered[index]) === id;\r\n                if (has) {\r\n                    index = filtered.length;\r\n                } else {\r\n                    index++;\r\n                }\r\n            }\r\n            return !has;\r\n        },\r\n    };\r\n    Columns.fromDatas = function (datas) {\r\n        return Columns.parseCols(datas);\r\n    }\r\n    Columns.parseCols = function getColumns(datas) {\r\n        var cols = null;\r\n        if (datas && datas.length) {\r\n            cols = [];\r\n            function parse(item, prop) {\r\n                if (angular.isArray(item)) {\r\n                    angular.forEach(item, function (value, key) {\r\n                        parse(value, (prop || '') + '[' + key + ']');\r\n                    });\r\n                } else if (angular.isObject(item)) {\r\n                    angular.forEach(item, function (value, key) {\r\n                        parse(value, (prop ? prop + '.' : '') + key);\r\n                    });\r\n                } else {\r\n                    var col = {\r\n                        value: prop,\r\n                        type: colTypes.TEXT,\r\n                        active: cols.length < 3,\r\n                    };\r\n                    if (angular.isNumber(item)) {\r\n                        col.type = colTypes.NUMBER;\r\n                        col.aggregate = true;\r\n                        col.color = 1;\r\n                    } else if (angular.isDate(item)) {\r\n                        col.type = colTypes.DATE;\r\n                    } else {\r\n                        col.groupBy = true;\r\n                        col.hasSearch = true;\r\n                    }\r\n                    cols.push(col);\r\n                }\r\n            }\r\n            parse(datas[0]);\r\n        }\r\n        return cols;\r\n    };\r\n    Columns.types = colTypes;\r\n    return Columns;\r\n}]);\r\n\r\nmodule.factory('Table', ['$parse', 'Columns', 'colTypes', function ($parse, Columns, colTypes) {\r\n    function Table(cols) {\r\n        this.cols = new Columns(cols).expand({ dynamic: true, compare: false });\r\n        this.defaults = cols.map(function (col) {\r\n            return {\r\n                id: col.id,\r\n                active: col.active,\r\n            };\r\n        });\r\n        this.colGroups = [{\r\n            name: 'GroupBy',\r\n            cols: this.cols.getGroups()\r\n        }, ];\r\n        this.valGroups = [{\r\n            name: 'Aggregate',\r\n            cols: this.cols.getAggregates()\r\n        }, ];\r\n        this.excludes = [];\r\n        this.includes = [];\r\n    }\r\n    Table.prototype = {\r\n        setDatas: function (datas, compares) {\r\n            this.datas = datas;\r\n            this.compares = compares;\r\n            this.update();\r\n        },\r\n        update: function () {\r\n            this.rows = [];\r\n            this.groupBy(this.datas);\r\n        },\r\n        groupBy: function (datas) {\r\n            var rows = this.rows;\r\n            var cols = this.cols;\r\n            var excludes = this.excludes;\r\n            var includes = this.includes;\r\n            var compares = this.compares;\r\n            cols.reset();\r\n            var compared = null;\r\n            angular.forEach(datas, function (row) {\r\n                var has = true;\r\n                angular.forEach(excludes, function (item) {\r\n                    if (item.active) {\r\n                        has = has && item.filter(row);\r\n                    }\r\n                });\r\n                angular.forEach(includes, function (item) {\r\n                    if (item.active) {\r\n                        has = has && item.filter(row);\r\n                    }\r\n                });\r\n                if (has) {\r\n                    cols.iterate(row, rows);\r\n                }\r\n            });\r\n            if (compares) {\r\n                compared = [];\r\n                angular.forEach(compares, function (row) {\r\n                    var has = true;\r\n                    angular.forEach(excludes, function (item) {\r\n                        if (item.active) {\r\n                            has = has && item.filter(row);\r\n                        }\r\n                    });\r\n                    angular.forEach(includes, function (item) {\r\n                        if (item.active) {\r\n                            has = has && item.filter(row);\r\n                        }\r\n                    });\r\n                    if (has) {\r\n                        compared.push(row);\r\n                        cols.compare(row, rows);\r\n                    }\r\n                });\r\n            }\r\n            cols.makeStatic(rows);\r\n            if (this.after && angular.isFunction(this.after)) {\r\n                this.after(rows);\r\n            }\r\n        },\r\n        resetFilters: function () {\r\n            var table = this;\r\n            angular.forEach(table.cols, function (col, key) {\r\n                angular.forEach(table.defaults, function (item) {\r\n                    if (col.id === item.id) {\r\n                        angular.isFunction(col.active) ? null : col.active = item.active;\r\n                    }\r\n                });\r\n                col.search = null;\r\n            });\r\n            table.cols = table.cols.sort(function (a, b) {\r\n                return a.id - b.id;\r\n            });\r\n            // table.cols.radios.workloads = 'supplier.name'; //??? default radios ???\r\n            table.update();\r\n        },\r\n        exclude: function (item) {\r\n            item.active = !item.active;\r\n            this.update();\r\n        },\r\n        include: function (item) {\r\n            item.active = !item.active;\r\n            this.update();\r\n        },\r\n        toggleCol: function (col) {\r\n            this.cols.toggleColumns(col);\r\n            this.update();\r\n        },\r\n        doFilter: function (cols) {\r\n            // this.update(); // doing regroup\r\n            return function (item) {\r\n                var has = true;\r\n                angular.forEach(cols, function (col) {\r\n                    if (col.isActive() && col.search && col.search.id !== 0) {\r\n                        has = has && col.getKey(item) === col.search.id;\r\n                    }\r\n                }.bind(this));\r\n                return has;\r\n            };\r\n        },\r\n        doFilterMultiple: function (cols) {\r\n            // table.update(); // doing regroup\r\n            return function (item) {\r\n                var has = true;\r\n                angular.forEach(cols, function (col) {\r\n                    if (col.isActive() && col.search.length) {\r\n                        has = has && col.search.indexOf(col.getKey(item)) != -1;\r\n                    }\r\n                }.bind(this));\r\n                return has;\r\n            };\r\n        },\r\n        doFilterColumns: function (cols) {\r\n            return function (col) {\r\n                return col.isActive(); // col.dynamic ? (cols.show.dynamic && col.active()) : col.active;\r\n            };\r\n        },\r\n        doOrder: function (cols) {\r\n            return function (item) {\r\n                return cols.getSortKey(item);\r\n            };\r\n        },\r\n        getRowClass: function (item) {\r\n            return ''; // item.status ? 'status-' + Appearance.negotiationClass(item.status.id) : '';\r\n        },\r\n        onOpen: function (item) {\r\n            console.log('onOpen', item);\r\n        },\r\n        toggle: function (mode) {\r\n            var value = null;\r\n            if (this.cols) {\r\n                var show = this.cols.show;\r\n                show[mode] = !show[mode];\r\n                switch (mode) {\r\n                    case 'dynamic':\r\n                        show.compare = false;\r\n                        break;\r\n                    case 'compare':\r\n                        show.dynamic = false;\r\n                        break;\r\n                }\r\n                value = show[mode];\r\n            }\r\n            return value;\r\n        },\r\n        has: function (mode) {\r\n            return (this.cols ? this.cols.show[mode] : null);\r\n        },\r\n    };\r\n    Table.fromDatas = function (datas) {\r\n        if (!angular.isArray(datas) || !datas.length > 1) {\r\n            angular.forEach(datas, function (data) {\r\n                if (angular.isArray(data)) {\r\n                    datas = data;\r\n                }\r\n            });\r\n        }\r\n        if (!angular.isArray(datas)) {\r\n            datas = [datas];\r\n        }\r\n        var cols = Columns.fromDatas(datas);\r\n        return new Table(cols);\r\n    };\r\n    return Table;\r\n}]);\r\n\r\nmodule.service('Droppables', ['ElementRect', function (ElementRect) {\r\n    this.natives = [];\r\n    this.callbacks = [];\r\n    this.rects = [];\r\n    this.add = function (nativeElement, callback) {\r\n        this.natives.push(nativeElement);\r\n        this.callbacks.push(callback || function () { });\r\n        this.rects.push(ElementRect.fromNative(nativeElement));\r\n    };\r\n    this.remove = function (nativeElement) {\r\n        var index = this.natives.indexOf(nativeElement);\r\n        if (index !== -1) {\r\n            this.natives.splice(index, 1);\r\n            this.callbacks.splice(index, 1);\r\n            this.rects.splice(index, 1);\r\n        }\r\n    };\r\n    this.getIntersections = function (item) {\r\n        var intersections = [], element;\r\n        angular.forEach(this.rects, function (rect, index) {\r\n            rect.set(rect.native);\r\n            element = angular.element(rect.native);\r\n            element.removeClass('dropping');\r\n            if (rect.intersect(item)) {\r\n                rect.distance = rect.center.distance(item.center);\r\n                rect.data = this.callbacks[index]();\r\n                intersections.push(rect);\r\n                element.addClass('over');\r\n            } else {\r\n                element.removeClass('over');\r\n            }\r\n        }.bind(this));\r\n        intersections.sort(function (a, b) {\r\n            if (a.distance < b.distance) {\r\n                return -1;\r\n            }\r\n            if (a.distance > b.distance) {\r\n                return 1;\r\n            }\r\n            return 0;\r\n        });\r\n        return intersections;\r\n    };\r\n}]);\r\n\n\r\n})(window, window.angular);\r\n"]}