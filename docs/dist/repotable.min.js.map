{"version":3,"sources":["docs/dist/repotable.js"],"names":["window","angular","module","console","log","constant","ID","IDS","TITLE","DATE","CUSTOMER","RESOURCE","STATUS","STATUSSM","FAMILY","NUMBER","HOURS","COSTS","PERCENT","GAIN","ICON","BUTTONS","DISABLED","LINK","BOOL","DOUBLE","WEEKS","TEXT","SUM","MIN","MAX","AVG","directive","$parse","$timeout","Utils","Style","ElementRect","Droppables","require","link","scope","element","attributes","model","onStart","e","condition","down","getTouch","addDragListeners","onMove","move","diff","difference","dragging","power","addClass","style","transform","x","y","set","target","elementRect","nativeElement","offset","rects","getIntersections","length","native","onEnd","removeClass","fromIndex","droppableIndex","fromModel","ngModel","event","forEach","rect","index","data","droppable","from","to","$emit","removeDragListeners","on","off","addListeners","removeListeners","selector","draggableItem","undefined","draggableIf","querySelector","$on","onGetData","droppableIf","droppableItem","add","remove","$document","restrict","isActive","toggler","value","activate","addOutListeners","deactivate","removeOutListeners","onClick","setTimeout","onClickOut","getClosestElement","getClosest","Error","$rootScope","$window","Animate","draw","update","content","stickySelector","scrollPointY","scrollPointToY","elementY","stickyY","Math","min","offsetHeight","isSticked","stickedClass","contentStyle","getBoundingClientRect","top","elementPreviousY","scrollDirCount","scrollDir","animate","play","pause","ua","mobile","msie","stickyTableHeader","$watchCollection","cols","Array","prototype","slice","call","querySelectorAll","dummies","watchlist","concat","map","th","width","widths","col","minWidth","Table","replace","templateUrl","options","table","$watch","datas","fromDatas","name","swap","filter","$filter","toTitleCase","str","txt","charAt","toUpperCase","substr","toLowerCase","indexOf","split","join","splitted","firstName","shift","lastName","legacyFilter","cost","currency","ratio","formatting","precision","unit","hours","floor","minutes","label","format","timezone","placeholder","parseTime","parseHour","val","factory","State","this","isReady","idle","isBusy","isError","isErroring","isSuccess","isSuccessing","button","errors","enabled","busy","success","bind","error","push","ready","errorMessage","submitClass","successing","errorring","submitMessage","idleMessage","busyMessage","successMessage","callback","useTimeout","isPlaying","key","ticks","loop","time","requestAnimationFrame","clearTimeout","cancelAnimationFrame","playpause","cycle","k","a","b","c","d","ff","gg","hh","ii","add32","cmn","q","s","t","md51","i","n","state","md5blk","substring","tail","charCodeAt","md5blks","rhex","j","hex_chr","hex","Md5","encode","string","lsw","msw","$compile","$controller","Vector","previous","type","touch","originalEvent","touches","changedTouches","pageX","pageY","getRelativeTouch","point","left","el","matchesFn","parent","some","fn","document","body","parentElement","throttle","func","wait","context","args","result","timeout","later","leading","getNow","apply","now","remaining","arguments","trailing","where","array","query","found","item","has","compileController","html","contents","controller","$scope","$new","extend","controllerAs","children","reverseSortOn","prepend","expression","formatted","reducer","o","reducerSetter","reducerAdder","lastTime","vendors","currTime","Date","getTime","timeToCall","max","id","reduce","Object","defineProperty","TypeError","len","navigator","userAgent","safari","chrome","toMd5","getElementsByTagName","make","size","sqrt","normalize","l","incidence","angle","atan2","distance","cross","abs","towards","friction","copy","toString","height","center","fromNative","offsetWidth","vector","intersect","props","scale","hoverScale","currentScale","prefix","webkit","div","createElement","every","prop","prefixed","styles","cssText","transformOrigin","round","Filters","keys","flags","values","search","active","removeAll","reset","clear","filters","splice","toggle","sort","va","vb","String","cell","repoLocale","Order","asc","desc","order","fieldTypes","fieldTotalTypes","Field","typeTotal","isFunction","raw","source","getters","fields","field","setters","getter","assign","total","hasKey","initValue","aggregation","row","addCount","v","addValue","formatValue","getLink","isNumber","getTotal","filtered","getValueTotal","getFormat","getCellTotal","rows","previousCell","compare","current","$field","getValue","Number","POSITIVE_INFINITY","NEGATIVE_INFINITY","getHeaderClass","groupBy","getColumnClass","color","getCellClass","cc","getTextClass","getTotalClass","toStatic","post","cellClass","textClass","pop","dynamic","getName","getTotalValue","getTotalName","types","totalTypes","Fields","$id","expand","radios","aggregate","show","fieldPrevious","count","radio","groups","unique","items","getGroupKey","cells","iterate","comparing","mode","always","getCount","getFirstField","first","getGroups","getAggregates","getPercentages","getDynamics","getCompares","getCounters","activeInRange","range","flag","toggleFields","headerClass","columnClass","totalClass","colName","originaIndex","hasSearch","last","$last","parseDatas","parse","isArray","isObject","isDate","isString","defaults","groupables","aggregables","excludes","includes","setOptions","locale","MAX_FIELDS_ORDERED","setDatas","compares","columns","icon","toggleField","exclude","include","setOrderBy","sign","defaultsFiltered","ordersFiltered","filteredOrderBy","resetFilters","hasRow","matches","match","RegExp","exec","doFilterStatic","toggleOrder","f","fi","ti","after","toJson","json","description","filteredRows","report","no_results","service","natives","callbacks","intersections","app","err","run","$templateCache","put"],"mappings":"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","file":"repotable.min.js","sourcesContent":["\r\n(function(window, angular) {'use strict';\r\n\n/* global angular */\r\n\r\nvar module = angular.module('repotable', ['ng', 'ngSanitize', 'ngMessages']);\r\n\n/* global angular, module */\r\n\r\nwindow.console ? null : window.console = { log: function () { } };\r\n\r\n/*\r\nwindow.domain = '//' + location.hostname + (location.port ? ':' + location.port : ''); // location.protocol + \r\nmodule.constant('domain', domain);\r\n*/\r\n\r\nmodule.constant('colTypes', {\r\n    ID: 1,\r\n    IDS: 2,\r\n    TITLE: 3,\r\n    DATE: 4,\r\n    CUSTOMER: 5,\r\n    RESOURCE: 6,\r\n    STATUS: 7,\r\n    STATUSSM: 8,\r\n    FAMILY: 9,\r\n    NUMBER: 10,\r\n    HOURS: 11,\r\n    COSTS: 12,\r\n    PERCENT: 13,\r\n    GAIN: 14,\r\n    ICON: 15,\r\n    BUTTONS: 16,\r\n    DISABLED: 17,\r\n    LINK: 18,\r\n    BOOL: 19,\r\n    DOUBLE: 20,\r\n    WEEKS: 21,\r\n});\r\n\r\nmodule.constant('fieldTypes', {\r\n    TEXT: 1,\r\n    BOOL: 2,\r\n    NUMBER: 3,\r\n    DOUBLE: 4,\r\n    PERCENT: 5,\r\n    GAIN: 6,\r\n    COSTS: 7,\r\n    HOURS: 8,\r\n    WEEKS: 9,\r\n    DATE: 10,\r\n    STATUS: 11,    \r\n    RESOURCE: 12,\r\n    LINK: 13,\r\n});\r\n\r\nmodule.constant('fieldTotalTypes', {\r\n    SUM: 1,\r\n    MIN: 2,\r\n    MAX: 3,\r\n    AVG: 4,\r\n});\r\n\n/* global angular, module */\r\n\n/* global angular, module */\r\n\r\nmodule.directive('draggableItem', ['$parse', '$timeout', 'Utils', 'Style', 'ElementRect', 'Droppables', function ($parse, $timeout, Utils, Style, ElementRect, Droppables) {\r\n    return {\r\n        require: 'ngModel',\r\n        link: function (scope, element, attributes, model) {\r\n            var nativeElement = element[0];\r\n            var selector = attributes.draggableItem || '.item';\r\n            var condition = attributes.draggableIf !== undefined ? $parse(attributes.draggableIf) : function () { return true; };\r\n            var target = nativeElement.querySelector(selector);\r\n            var style = new Style();\r\n            var elementRect = new ElementRect();\r\n            var down, move, diff, dragging, rects;\r\n            function onStart(e) {\r\n                if (condition(scope)) {\r\n                    down = Utils.getTouch(e);\r\n                    addDragListeners();\r\n                }\r\n                return false;\r\n            }\r\n            function onMove(e) {\r\n                move = Utils.getTouch(e);\r\n                diff = down.difference(move);\r\n                if (!dragging && diff.power() > 25) {\r\n                    dragging = true;\r\n                    element.addClass('dragging');\r\n                }\r\n                if (dragging) {\r\n                    style.transform = 'translateX(' + diff.x + 'px) translateY(' + diff.y + 'px)';\r\n                    style.set(target);\r\n                    elementRect.set(nativeElement).offset(diff);\r\n                    rects = Droppables.getIntersections(elementRect);\r\n                    if (rects.length) {\r\n                        angular.element(rects[0].native).addClass('dropping');\r\n                    }\r\n                }\r\n                // console.log(diff);\r\n                return false;\r\n            }\r\n            function onEnd(e) {\r\n                if (dragging) {\r\n                    dragging = false;\r\n                    element.removeClass('dragging');\r\n                    style.transform = 'none';\r\n                    style.set(target);\r\n                    var fromIndex = $parse(attributes.droppableIndex)(scope);\r\n                    var fromModel = $parse(attributes.ngModel)(scope);\r\n                    if (rects.length) {\r\n                        var event = null;\r\n                        angular.forEach(rects, function (rect, index) {\r\n                            angular.element(rect.native).removeClass('dropping over');\r\n                            if (rect.data.droppable(scope) && !event) {\r\n                                event = {\r\n                                    from: {\r\n                                        index: fromIndex,\r\n                                        model: fromModel,\r\n                                        target: target,\r\n                                    },\r\n                                    to: {\r\n                                        index: rect.data.index,\r\n                                        model: rect.data.model,\r\n                                        target: rect.native\r\n                                    },\r\n                                };\r\n                                $timeout(function () {\r\n                                    scope.$emit('onDropItem', event);\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        var event = {\r\n                            from: {\r\n                                index: fromIndex,\r\n                                model: fromModel,\r\n                                target: target,\r\n                            },\r\n                            to: null,\r\n                        };\r\n                        $timeout(function () {\r\n                            scope.$emit('onDropOut', event);\r\n                        });\r\n                    }\r\n                }\r\n                removeDragListeners();\r\n                return false;\r\n            }\r\n            function addDragListeners() {\r\n                angular.element(window).on('touchmove mousemove', onMove);\r\n                angular.element(window).on('touchend mouseup', onEnd);\r\n            };\r\n            function removeDragListeners() {\r\n                angular.element(window).off('touchmove mousemove', onMove);\r\n                angular.element(window).off('touchend mouseup', onEnd);\r\n            };\r\n            function addListeners() {\r\n                element.on('touchstart mousedown', onStart);\r\n            };\r\n            function removeListeners() {\r\n                element.off('touchstart mousedown', onStart);\r\n            };\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n            });\r\n            addListeners();\r\n        }\r\n    };\r\n}]);\r\n\r\nmodule.directive('droppableItem', ['$parse', 'Utils', 'Style', 'Droppables', function ($parse, Utils, Style, Droppables) {\r\n    var droppables = {};\r\n    return {\r\n        require: 'ngModel',\r\n        link: function (scope, element, attributes, model) {\r\n            var nativeElement = element[0];\r\n            var selector = attributes.droppableItem || '.item';\r\n            function onGetData() {\r\n                var index = $parse(attributes.droppableIndex)(scope);\r\n                var model = $parse(attributes.ngModel)(scope);\r\n                var droppable = attributes.droppableIf !== undefined ? $parse(attributes.droppableIf) : function () { return true };\r\n                return {\r\n                    index: index,\r\n                    model: model,\r\n                    droppable: droppable,\r\n                };\r\n            }\r\n            Droppables.add(nativeElement, onGetData);\r\n            scope.$on('$destroy', function () {\r\n                Droppables.remove(nativeElement);\r\n            });\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.directive('toggler', ['$document', '$parse', '$timeout', 'Utils', function ($document, $parse, $timeout, Utils) {\r\n    return {\r\n        restrict: 'A',\r\n        link: function (scope, element, attributes, model) {\r\n            if (attributes.value === undefined) {\r\n                throw new Error('[toggler] attribute value required');\r\n            }\r\n            if (attributes.target === undefined) {\r\n                throw new Error('[toggler] attribute target required');\r\n            }\r\n            function isActive() {\r\n                return $parse(attributes.toggler + '==' + attributes.value)(scope);\r\n            }\r\n            function activate() {\r\n                addOutListeners();\r\n                $timeout(function () {\r\n                    $parse(attributes.toggler + '=' + attributes.value)(scope);\r\n                });\r\n            }\r\n            function deactivate() {\r\n                removeOutListeners();\r\n                $timeout(function () {\r\n                    $parse(attributes.toggler + '=null')(scope);\r\n                });\r\n            }\r\n            function onClick(e) {\r\n                setTimeout(function () {\r\n                    if (isActive()) {\r\n                        deactivate();\r\n                    } else {\r\n                        activate();\r\n                    }\r\n                }, 100);\r\n            }\r\n            function onClickOut(e) {\r\n                if (isActive()\r\n                    && Utils.getClosestElement(e.target, element[0]) === null\r\n                    && Utils.getClosest(e.target, attributes.target) === null) {\r\n                    deactivate();\r\n                }\r\n            }\r\n            function addOutListeners() {\r\n                angular.element($document).on('click', onClickOut);\r\n            };\r\n            function removeOutListeners() {\r\n                angular.element($document).off('click', onClickOut);\r\n            };\r\n            function addListeners() {\r\n                element.on('click', onClick);\r\n            };\r\n            function removeListeners() {\r\n                element.off('click', onClick);\r\n            };\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n                removeOutListeners();\r\n            });\r\n            addListeners();\r\n        }\r\n    };\r\n}]);\r\n\r\nmodule.directive('stickyTableHeader', ['$rootScope', '$window', '$timeout', 'Utils', 'Animate', 'Style', function ($rootScope, $window, $timeout, Utils, Animate, Style) {\r\n    return {\r\n        restrict: 'A',\r\n        link: function (scope, element, attributes, model) {\r\n            if (Utils.ua.mobile || Utils.ua.msie) {\r\n                element.addClass('sticky-disabled');\r\n                return;\r\n            }\r\n            var stickySelector = attributes.stickyTableHeader !== undefined ? attributes.stickyTableHeader : '.fixed';\r\n            var stickedClass = attributes.stickedClass !== undefined ? attributes.stickedClass : 'sticked';\r\n            // OPTIONS\r\n            var isSticked = false,\r\n                scrollDir = 0,\r\n                scrollDirCount = 0,\r\n                scrollPointY = 0,\r\n                scrollPointToY = 0,\r\n                stickyY = 0,\r\n                elementY = 0,\r\n                elementPreviousY = 0,\r\n                elementRect,\r\n                elementTop,\r\n                content,\r\n                contentStyle = new Style();\r\n            function draw() {\r\n                update();\r\n                content = content || angular.element(element[0].querySelector(stickySelector));\r\n                scrollPointY += (scrollPointToY - scrollPointY) / 4;\r\n                if (elementY < scrollPointY) {\r\n                    stickyY = Math.min(element[0].offsetHeight - 215, (elementY - scrollPointY) * -1);\r\n                    if (!isSticked) {\r\n                        isSticked = true;\r\n                        element.addClass(stickedClass);\r\n                    }\r\n                } else {\r\n                    stickyY = 0;\r\n                    if (isSticked) {\r\n                        isSticked = false;\r\n                        element.removeClass(stickedClass);\r\n                    }\r\n                }\r\n                contentStyle.transform('translate3d(0, ' + stickyY + 'px, 0)');\r\n                contentStyle.set(content[0]);\r\n                return;\r\n            }\r\n            var animate = new Animate(draw); // , Utils.ua.safari);            \r\n            function update() {\r\n                elementRect = element[0].getBoundingClientRect();\r\n                if (elementY === elementRect.top) {\r\n                    elementPreviousY = elementY;\r\n                    return;\r\n                }\r\n                elementY = elementRect.top;\r\n                if (elementY >= elementPreviousY) {\r\n                    scrollDirCount++;\r\n                } else {\r\n                    scrollDirCount--;\r\n                }\r\n                if (scrollDirCount > 3) {\r\n                    scrollDirCount = 0;\r\n                    // console.log('up')\r\n                    scrollDir = 1;\r\n                    scrollPointToY = 79;\r\n                } else if (scrollDirCount < -3) {\r\n                    scrollDirCount = 0;\r\n                    // console.log('down')                    \r\n                    scrollDir = 0;\r\n                    scrollPointToY = 0;\r\n                }\r\n                elementPreviousY = elementY;\r\n            }\r\n            function addListeners() {\r\n                animate.play();\r\n            }\r\n            function removeListeners() {\r\n                animate.pause();\r\n            }\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n            });\r\n            var native = element[0];\r\n            scope.$watchCollection(function () {\r\n                var cols = Array.prototype.slice.call(native.querySelectorAll('.real th'), 0);\r\n                var dummies = Array.prototype.slice.call(native.querySelectorAll('.dummy th'), 0);\r\n                if (cols.length === dummies.length) {\r\n                    var watchlist = cols.concat(dummies);\r\n                    return watchlist.map(function (th) {\r\n                        return th.getBoundingClientRect().width;\r\n                    });\r\n                } else {\r\n                    return [];\r\n                }\r\n            }, function (widths) {\r\n                var cols = native.querySelectorAll('.real th');\r\n                var dummies = native.querySelectorAll('.dummy th');\r\n                if (cols.length === dummies.length) {\r\n                    angular.forEach(dummies, function (col, index) {\r\n                        var width = col.getBoundingClientRect().width;\r\n                        cols[index].style.width = width + 'px';\r\n                        cols[index].style.minWidth = width + 'px';\r\n                    });\r\n                }\r\n            });\r\n            addListeners();\r\n        }\r\n    };\r\n}]);\r\n\r\nmodule.directive('repotable', ['Table', function(Table) {\r\n    return {\r\n        restrict: 'A',\r\n        replace: true,\r\n        templateUrl: 'repotable/partials/repotable',\r\n        scope: {\r\n            options: '=repotable',\r\n        },\r\n        link: function (scope, element, attributes, model) {\r\n            console.log('repotable'); \r\n            var table;\r\n            // table = scope.table = new Table(scope.options);\r\n            scope.$watch('options.items', function (datas) {\r\n                table = scope.table = Table.fromDatas(datas);\r\n                table.name = scope.options.name;\r\n            });\r\n            scope.$on('onDropItem', function (scope, event) {\r\n                table.swap(event.from.model, event.to.model);\r\n            });\r\n            scope.$on('onDropOut', function (scope, event) {\r\n                // console.log('NegotiationReportCtrl.onDropOut', event.model, event.from, event.to, event.target);\r\n            });            \r\n            /*\r\n            scope.stop = function ($event) {\r\n                $event.stopImmediatePropagation();\r\n                return true;\r\n            };\r\n            */\r\n        }\r\n    };\r\n}]);\n/* global angular, module */\r\n\r\nmodule.filter('shortName', ['$filter', function ($filter) {\r\n    function toTitleCase(str) {\r\n        return str.replace(/\\w\\S*/g, function (txt) { return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase(); });\r\n    }\r\n    return function (value) {\r\n        if (!value) {\r\n            return '';\r\n        }\r\n        if (value.indexOf(' .') === value.length - 2) {\r\n            value = value.split(' .').join('');\r\n        }\r\n        /*\r\n        var splitted;\r\n        if (value.indexOf('.') !== -1) {\r\n            splitted = value.split('.');\r\n        } else {\r\n            splitted = value.split(' ');\r\n        }\r\n        */\r\n        var splitted = value.split(' ');\r\n        var firstName = splitted.shift();\r\n        if (splitted.length) {\r\n            var lastName = splitted.join(' ');\r\n            return firstName.substr(0, 1).toUpperCase() + '.' + toTitleCase(lastName);\r\n        } else {\r\n            return firstName;\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customCurrency', ['$filter', function ($filter) {\r\n    var legacyFilter = $filter('currency');\r\n    return function (cost, currency) {\r\n        return legacyFilter(cost * currency.ratio, currency.formatting);\r\n    }\r\n}]);\r\n\r\nmodule.filter('customNumber', ['$filter', function ($filter) {\r\n    var filter = $filter('number');\r\n    return function (value, precision, unit) {\r\n        unit = unit || '';\r\n        return (value ? filter(value, precision) + unit : '-');\r\n    }\r\n}]);\r\n\r\nmodule.filter('customHours', [function () {\r\n    return function (value) {\r\n        if (value) {\r\n            var hours = Math.floor(value);\r\n            var minutes = Math.floor((value - hours) * 60);\r\n            var label = hours ? hours + ' H' : '';\r\n            label += minutes ? ' ' + minutes + ' m' : '';\r\n            return label;\r\n        } else {\r\n            return '-';\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customDate', ['$filter', function ($filter) {\r\n    var filter = $filter('date');\r\n    return function (value, format, timezone) {\r\n        return value ? filter(value, format, timezone) : '-';\r\n    }\r\n}]);\r\n\r\nmodule.filter('customTime', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        if (value) {\r\n            return Utils.parseTime(value);\r\n        } else {\r\n            return (placeholder ? placeholder : '-');\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customDigital', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        if (value) {\r\n            return Utils.parseHour(value);\r\n        } else {\r\n            return (placeholder ? placeholder : '-');\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customString', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        return value ? value : (placeholder ? placeholder : '-');\r\n    }\r\n}]);\r\n\r\nmodule.filter('customEnum', function () {\r\n    return function (val) {\r\n        val = val + 1;\r\n        return val < 10 ? '0' + val : val;\r\n    };\r\n});\r\n\n/* global angular, module */\r\n\r\nmodule.factory('State', ['$timeout', function ($timeout) {\r\n    function State() {\r\n        this.isReady = false;\r\n        this.idle();\r\n    }\r\n    State.prototype = {\r\n        idle: function () {\r\n            this.isBusy = false;\r\n            this.isError = false;\r\n            this.isErroring = false;\r\n            this.isSuccess = false;\r\n            this.isSuccessing = false;\r\n            this.button = null;\r\n            this.errors = [];\r\n        },\r\n        enabled: function () {\r\n            return !this.isBusy && !this.isErroring && !this.isSuccessing;\r\n        },\r\n        busy: function () {\r\n            if (!this.isBusy) {\r\n                this.isBusy = true;\r\n                this.isError = false;\r\n                this.isErroring = false;\r\n                this.isSuccess = false;\r\n                this.isSuccessing = false;\r\n                this.errors = [];\r\n                // console.log('State.busy', this);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        },\r\n        success: function () {\r\n            this.isBusy = false;\r\n            this.isError = false;\r\n            this.isErroring = false;\r\n            this.isSuccess = true;\r\n            this.isSuccessing = true;\r\n            this.errors = [];\r\n            $timeout(function () {\r\n                this.isSuccessing = false;\r\n                this.button = null;\r\n            }.bind(this), 1000);\r\n        },\r\n        error: function (error) {\r\n            this.isBusy = false;\r\n            this.isError = true;\r\n            this.isErroring = true;\r\n            this.isSuccess = false;\r\n            this.isSuccessing = false;\r\n            this.errors.push(error);\r\n            $timeout(function () {\r\n                this.isErroring = false;\r\n                this.button = null;\r\n            }.bind(this), 1000);\r\n        },\r\n        ready: function () {\r\n            this.isReady = true;\r\n            this.success();\r\n        },\r\n        errorMessage: function () {\r\n            return this.isError ? this.errors[this.errors.length - 1] : null;\r\n        },\r\n        submitClass: function () {\r\n            return {\r\n                busy: this.isBusy,\r\n                ready: this.isReady,\r\n                successing: this.isSuccessing,\r\n                success: this.isSuccess,\r\n                errorring: this.isErroring,\r\n                error: this.isError,\r\n            };\r\n        },\r\n        submitMessage: function (idleMessage, busyMessage, successMessage, errorMessage) {\r\n            idleMessage = idleMessage || 'Submit';\r\n            if (this.isBusy) {\r\n                return busyMessage || idleMessage;\r\n            } else if (this.isSuccess) {\r\n                return successMessage || idleMessage;\r\n            } else if (this.isError) {\r\n                return errorMessage || idleMessage;\r\n            } else {\r\n                return idleMessage;\r\n            }\r\n        },\r\n    };\r\n    return State;\r\n}]);\r\n\r\nmodule.factory('Animate', [function () {\r\n    function Animate(callback, useTimeout) {\r\n        this.callback = callback;\r\n        this.isPlaying = false;\r\n        this.key = null;\r\n        this.ticks = 0;\r\n        this.useTimeout = useTimeout === true ? true : false;\r\n    }\r\n    Animate.prototype = {\r\n        play: function () {\r\n            var animate = this;\r\n            function loop(time) {\r\n                animate.ticks++;\r\n                animate.callback(time, animate.ticks);\r\n                if (animate.useTimeout) {\r\n                    animate.key = window.setTimeout(loop, 1000 / 60);\r\n                } else {\r\n                    animate.key = window.requestAnimationFrame(loop);\r\n                }\r\n            }\r\n            if (!animate.key) {\r\n                animate.isPlaying = true;\r\n                loop();\r\n            }\r\n        },\r\n        pause: function () {\r\n            var animate = this;\r\n            if (animate.key) {\r\n                if (animate.useTimeout) {\r\n                    window.clearTimeout(animate.key);\r\n                } else {\r\n                    window.cancelAnimationFrame(animate.key);\r\n                }\r\n                animate.key = null;\r\n                animate.isPlaying = false;\r\n            }\r\n        },\r\n        playpause: function () {\r\n            var animate = this;\r\n            if (animate.key) {\r\n                animate.pause();\r\n            } else {\r\n                animate.play();\r\n            }\r\n        }\r\n    }\r\n    return Animate;\r\n}]);\r\n\r\nmodule.factory('Md5', [function () {\r\n\r\n    var hex_chr = '0123456789abcdef'.split('');\r\n\r\n    function cycle(x, k) {\r\n        var a = x[0], b = x[1], c = x[2], d = x[3];\r\n\r\n        a = ff(a, b, c, d, k[0], 7, -680876936);\r\n        d = ff(d, a, b, c, k[1], 12, -389564586);\r\n        c = ff(c, d, a, b, k[2], 17, 606105819);\r\n        b = ff(b, c, d, a, k[3], 22, -1044525330);\r\n        a = ff(a, b, c, d, k[4], 7, -176418897);\r\n        d = ff(d, a, b, c, k[5], 12, 1200080426);\r\n        c = ff(c, d, a, b, k[6], 17, -1473231341);\r\n        b = ff(b, c, d, a, k[7], 22, -45705983);\r\n        a = ff(a, b, c, d, k[8], 7, 1770035416);\r\n        d = ff(d, a, b, c, k[9], 12, -1958414417);\r\n        c = ff(c, d, a, b, k[10], 17, -42063);\r\n        b = ff(b, c, d, a, k[11], 22, -1990404162);\r\n        a = ff(a, b, c, d, k[12], 7, 1804603682);\r\n        d = ff(d, a, b, c, k[13], 12, -40341101);\r\n        c = ff(c, d, a, b, k[14], 17, -1502002290);\r\n        b = ff(b, c, d, a, k[15], 22, 1236535329);\r\n\r\n        a = gg(a, b, c, d, k[1], 5, -165796510);\r\n        d = gg(d, a, b, c, k[6], 9, -1069501632);\r\n        c = gg(c, d, a, b, k[11], 14, 643717713);\r\n        b = gg(b, c, d, a, k[0], 20, -373897302);\r\n        a = gg(a, b, c, d, k[5], 5, -701558691);\r\n        d = gg(d, a, b, c, k[10], 9, 38016083);\r\n        c = gg(c, d, a, b, k[15], 14, -660478335);\r\n        b = gg(b, c, d, a, k[4], 20, -405537848);\r\n        a = gg(a, b, c, d, k[9], 5, 568446438);\r\n        d = gg(d, a, b, c, k[14], 9, -1019803690);\r\n        c = gg(c, d, a, b, k[3], 14, -187363961);\r\n        b = gg(b, c, d, a, k[8], 20, 1163531501);\r\n        a = gg(a, b, c, d, k[13], 5, -1444681467);\r\n        d = gg(d, a, b, c, k[2], 9, -51403784);\r\n        c = gg(c, d, a, b, k[7], 14, 1735328473);\r\n        b = gg(b, c, d, a, k[12], 20, -1926607734);\r\n\r\n        a = hh(a, b, c, d, k[5], 4, -378558);\r\n        d = hh(d, a, b, c, k[8], 11, -2022574463);\r\n        c = hh(c, d, a, b, k[11], 16, 1839030562);\r\n        b = hh(b, c, d, a, k[14], 23, -35309556);\r\n        a = hh(a, b, c, d, k[1], 4, -1530992060);\r\n        d = hh(d, a, b, c, k[4], 11, 1272893353);\r\n        c = hh(c, d, a, b, k[7], 16, -155497632);\r\n        b = hh(b, c, d, a, k[10], 23, -1094730640);\r\n        a = hh(a, b, c, d, k[13], 4, 681279174);\r\n        d = hh(d, a, b, c, k[0], 11, -358537222);\r\n        c = hh(c, d, a, b, k[3], 16, -722521979);\r\n        b = hh(b, c, d, a, k[6], 23, 76029189);\r\n        a = hh(a, b, c, d, k[9], 4, -640364487);\r\n        d = hh(d, a, b, c, k[12], 11, -421815835);\r\n        c = hh(c, d, a, b, k[15], 16, 530742520);\r\n        b = hh(b, c, d, a, k[2], 23, -995338651);\r\n\r\n        a = ii(a, b, c, d, k[0], 6, -198630844);\r\n        d = ii(d, a, b, c, k[7], 10, 1126891415);\r\n        c = ii(c, d, a, b, k[14], 15, -1416354905);\r\n        b = ii(b, c, d, a, k[5], 21, -57434055);\r\n        a = ii(a, b, c, d, k[12], 6, 1700485571);\r\n        d = ii(d, a, b, c, k[3], 10, -1894986606);\r\n        c = ii(c, d, a, b, k[10], 15, -1051523);\r\n        b = ii(b, c, d, a, k[1], 21, -2054922799);\r\n        a = ii(a, b, c, d, k[8], 6, 1873313359);\r\n        d = ii(d, a, b, c, k[15], 10, -30611744);\r\n        c = ii(c, d, a, b, k[6], 15, -1560198380);\r\n        b = ii(b, c, d, a, k[13], 21, 1309151649);\r\n        a = ii(a, b, c, d, k[4], 6, -145523070);\r\n        d = ii(d, a, b, c, k[11], 10, -1120210379);\r\n        c = ii(c, d, a, b, k[2], 15, 718787259);\r\n        b = ii(b, c, d, a, k[9], 21, -343485551);\r\n\r\n        x[0] = add32(a, x[0]);\r\n        x[1] = add32(b, x[1]);\r\n        x[2] = add32(c, x[2]);\r\n        x[3] = add32(d, x[3]);\r\n\r\n    }\r\n\r\n    function cmn(q, a, b, x, s, t) {\r\n        a = add32(add32(a, q), add32(x, t));\r\n        return add32((a << s) | (a >>> (32 - s)), b);\r\n    }\r\n\r\n    function ff(a, b, c, d, x, s, t) {\r\n        return cmn((b & c) | ((~b) & d), a, b, x, s, t);\r\n    }\r\n\r\n    function gg(a, b, c, d, x, s, t) {\r\n        return cmn((b & d) | (c & (~d)), a, b, x, s, t);\r\n    }\r\n\r\n    function hh(a, b, c, d, x, s, t) {\r\n        return cmn(b ^ c ^ d, a, b, x, s, t);\r\n    }\r\n\r\n    function ii(a, b, c, d, x, s, t) {\r\n        return cmn(c ^ (b | (~d)), a, b, x, s, t);\r\n    }\r\n\r\n    function md51(s) {\r\n        var txt = '';\r\n        var n = s.length,\r\n        state = [1732584193, -271733879, -1732584194, 271733878], i;\r\n        for (i = 64; i <= s.length; i += 64) {\r\n            cycle(state, md5blk(s.substring(i - 64, i)));\r\n        }\r\n        s = s.substring(i - 64);\r\n        var tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        for (i = 0; i < s.length; i++)\r\n            tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\r\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\r\n        if (i > 55) {\r\n            cycle(state, tail);\r\n            for (i = 0; i < 16; i++) tail[i] = 0;\r\n        }\r\n        tail[14] = n * 8;\r\n        cycle(state, tail);\r\n        return state;\r\n    }\r\n\r\n    /* there needs to be support for Unicode here,\r\n        * unless we pretend that we can redefine the MD-5\r\n        * algorithm for multi-byte characters (perhaps\r\n        * by adding every four 16-bit characters and\r\n        * shortening the sum to 32 bits). Otherwise\r\n        * I suggest performing MD-5 as if every character\r\n        * was two bytes--e.g., 0040 0025 = @%--but then\r\n        * how will an ordinary MD-5 sum be matched?\r\n        * There is no way to standardize text to something\r\n        * like UTF-8 before transformation; speed cost is\r\n        * utterly prohibitive. The JavaScript standard\r\n        * itself needs to look at this: it should start\r\n        * providing access to strings as preformed UTF-8\r\n        * 8-bit unsigned value arrays.\r\n        */\r\n    function md5blk(s) { /* I figured global was faster.   */\r\n        var md5blks = [], i; /* Andy King said do it this way. */\r\n        for (i = 0; i < 64; i += 4) {\r\n            md5blks[i >> 2] = s.charCodeAt(i)\r\n            + (s.charCodeAt(i + 1) << 8)\r\n            + (s.charCodeAt(i + 2) << 16)\r\n            + (s.charCodeAt(i + 3) << 24);\r\n        }\r\n        return md5blks;\r\n    }\r\n\r\n    function rhex(n) {\r\n        var s = '', j = 0;\r\n        for (; j < 4; j++)\r\n            s += hex_chr[(n >> (j * 8 + 4)) & 0x0F]\r\n            + hex_chr[(n >> (j * 8)) & 0x0F];\r\n        return s;\r\n    }\r\n\r\n    function hex(x) {\r\n        for (var i = 0; i < x.length; i++)\r\n            x[i] = rhex(x[i]);\r\n        return x.join('');\r\n    }\r\n\r\n    /* this function is much faster,\r\n    so if possible we use it. Some IEs\r\n    are the only ones I know of that\r\n    need the idiotic second function,\r\n    generated by an if clause.  */\r\n    function add32(a, b) {\r\n        return (a + b) & 0xFFFFFFFF;\r\n    }\r\n\r\n    function Md5() { }\r\n    Md5.encode = function (string) {\r\n        return hex(md51(string));\r\n    }\r\n    if (Md5.encode('hello') !== '5d41402abc4b2a76b9719d911017c592') {\r\n        add32 = function (x, y) {\r\n            var lsw = (x & 0xFFFF) + (y & 0xFFFF),\r\n            msw = (x >> 16) + (y >> 16) + (lsw >> 16);\r\n            return (msw << 16) | (lsw & 0xFFFF);\r\n        }\r\n    }\r\n    return Md5;\r\n}]);\r\n\r\nmodule.factory('Utils', ['$compile', '$controller', 'Vector', 'Md5', function ($compile, $controller, Vector, Md5) {\r\n    (function () {\r\n        // POLYFILL window.requestAnimationFrame\r\n        var lastTime = 0;\r\n        var vendors = ['ms', 'moz', 'webkit', 'o'];\r\n        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n            window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame']\r\n                                       || window[vendors[x] + 'CancelRequestAnimationFrame'];\r\n        }\r\n        if (!window.requestAnimationFrame) {\r\n            window.requestAnimationFrame = function (callback, element) {\r\n                var currTime = new Date().getTime();\r\n                var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n                var id = window.setTimeout(function () { callback(currTime + timeToCall); }, timeToCall);\r\n                lastTime = currTime + timeToCall;\r\n                return id;\r\n            };\r\n        }\r\n        if (!window.cancelAnimationFrame) {\r\n            window.cancelAnimationFrame = function (id) {\r\n                clearTimeout(id);\r\n            };\r\n        }\r\n    }());\r\n    (function () {\r\n        // POLYFILL Array.prototype.reduce\r\n        // Production steps of ECMA-262, Edition 5, 15.4.4.21\r\n        // Reference: http://es5.github.io/#x15.4.4.21\r\n        // https://tc39.github.io/ecma262/#sec-array.prototype.reduce\r\n        if (!Array.prototype.reduce) {\r\n            Object.defineProperty(Array.prototype, 'reduce', {\r\n                value: function (callback) {// , initialvalue\r\n                    if (this === null) {\r\n                        throw new TypeError('Array.prototype.reduce called on null or undefined');\r\n                    }\r\n                    if (typeof callback !== 'function') {\r\n                        throw new TypeError(callback + ' is not a function');\r\n                    }\r\n                    var o = Object(this);\r\n                    var len = o.length >>> 0;\r\n                    var k = 0;\r\n                    var value;\r\n                    if (arguments.length == 2) {\r\n                        value = arguments[1];\r\n                    } else {\r\n                        while (k < len && !(k in o)) {\r\n                            k++;\r\n                        }\r\n                        if (k >= len) {\r\n                            throw new TypeError('Reduce of empty array with no initial value');\r\n                        }\r\n                        value = o[k++];\r\n                    }\r\n                    while (k < len) {\r\n                        if (k in o) {\r\n                            value = callback(value, o[k], k, o);\r\n                        }\r\n                        k++;\r\n                    }\r\n                    return value;\r\n                }\r\n            });\r\n        }\r\n    }());\r\n    var _isTouch;\r\n    function isTouch() {\r\n        if (!_isTouch) {\r\n            _isTouch = {\r\n                value: ('ontouchstart' in window || 'onmsgesturechange' in window)\r\n            }\r\n        }\r\n        // console.log(_isTouch);\r\n        return _isTouch.value;\r\n    }\r\n    function getTouch(e, previous) {\r\n        var t = new Vector();\r\n        if (e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel') {\r\n            var touch = null;\r\n            var event = e.originalEvent ? e.originalEvent : e;\r\n            var touches = event.touches.length ? event.touches : event.changedTouches;\r\n            if (touches && touches.length) {\r\n                touch = touches[0];\r\n            }\r\n            if (touch) {\r\n                t.x = touch.pageX;\r\n                t.y = touch.pageY;\r\n            }\r\n        } else if (e.type == 'click' || e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover' || e.type == 'mouseout' || e.type == 'mouseenter' || e.type == 'mouseleave') {\r\n            t.x = e.pageX;\r\n            t.y = e.pageY;\r\n        }\r\n        if (previous) {\r\n            t.s = Vector.difference(previous, t);\r\n        }\r\n        t.type = e.type;\r\n        return t;\r\n    }\r\n    function getRelativeTouch(element, point) {\r\n        var rect = element[0].getBoundingClientRect();\r\n        var e = new Vector(rect.left, rect.top);\r\n        return Vector.difference(e, point);\r\n    }\r\n    function getClosest(el, selector) {\r\n        var matchesFn, parent;\r\n        ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\r\n            if (typeof document.body[fn] == 'function') {\r\n                matchesFn = fn;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        if (el[matchesFn](selector)) {\r\n            return el;\r\n        }\r\n        while (el !== null) {\r\n            parent = el.parentElement;\r\n            if (parent !== null && parent[matchesFn](selector)) {\r\n                return parent;\r\n            }\r\n            el = parent;\r\n        }\r\n        return null;\r\n    }\r\n    function getClosestElement(el, target) {\r\n        var matchesFn, parent;\r\n        if (el === target) {\r\n            return el;\r\n        }\r\n        while (el !== null) {\r\n            parent = el.parentElement;\r\n            if (parent !== null && parent === target) {\r\n                return parent;\r\n            }\r\n            el = parent;\r\n        }\r\n        return null;\r\n    }\r\n    var getNow = Date.now || function () {\r\n        return new Date().getTime();\r\n    };\r\n    function throttle(func, wait, options) {\r\n        // Returns a function, that, when invoked, will only be triggered at most once\r\n        // during a given window of time. Normally, the throttled function will run\r\n        // as much as it can, without ever going more than once per `wait` duration;\r\n        // but if you'd like to disable the execution on the leading edge, pass\r\n        // `{leading: false}`. To disable execution on the trailing edge, ditto.\r\n        var context, args, result;\r\n        var timeout = null;\r\n        var previous = 0;\r\n        if (!options) options = {};\r\n        var later = function () {\r\n            previous = options.leading === false ? 0 : getNow();\r\n            timeout = null;\r\n            result = func.apply(context, args);\r\n            if (!timeout) context = args = null;\r\n        };\r\n        return function () {\r\n            var now = getNow();\r\n            if (!previous && options.leading === false) previous = now;\r\n            var remaining = wait - (now - previous);\r\n            context = this;\r\n            args = arguments;\r\n            if (remaining <= 0 || remaining > wait) {\r\n                if (timeout) {\r\n                    clearTimeout(timeout);\r\n                    timeout = null;\r\n                }\r\n                previous = now;\r\n                result = func.apply(context, args);\r\n                if (!timeout) context = args = null;\r\n            } else if (!timeout && options.trailing !== false) {\r\n                timeout = setTimeout(later, remaining);\r\n            }\r\n            return result;\r\n        };\r\n    }\r\n    function where(array, query) {\r\n        var found = null;\r\n        if (array) {\r\n            angular.forEach(array, function (item) {\r\n                var has = true;\r\n                angular.forEach(query, function (value, key) {\r\n                    has = has && item[key] === value;\r\n                });\r\n                if (has) {\r\n                    found = item;\r\n                }\r\n            });\r\n        }\r\n        return found;\r\n    }\r\n    function compileController(scope, element, html, data) {\r\n        // console.log('Utils.compileController', element);\r\n        element.html(html);\r\n        var link = $compile(element.contents());\r\n        if (data.controller) {\r\n            var $scope = scope.$new();\r\n            angular.extend($scope, data);\r\n            var controller = $controller(data.controller, { $scope: $scope });\r\n            if (data.controllerAs) {\r\n                scope[data.controllerAs] = controller;\r\n            }\r\n            element.data('$ngControllerController', controller);\r\n            element.children().data('$ngControllerController', controller);\r\n            scope = $scope;\r\n        }\r\n        link(scope);\r\n    }\r\n    var ua = window.navigator.userAgent.toLowerCase();\r\n    var safari = ua.indexOf('safari') !== -1 && ua.indexOf('chrome') === -1;\r\n    var msie = ua.indexOf('trident') !== -1 || ua.indexOf('edge') !== -1 || ua.indexOf('msie') !== -1;\r\n    var chrome = !safari && !msie && ua.indexOf('chrome') !== -1;\r\n    var mobile = ua.indexOf('mobile') !== -1;\r\n    function Utils() {\r\n    }\r\n    function reverseSortOn(key) {\r\n        return function (a, b) {\r\n            if (a[key] < b[key]) {\r\n                return 1;\r\n            }\r\n            if (a[key] > b[key]) {\r\n                return -1;\r\n            }\r\n            // a must be equal to b\r\n            return 0;\r\n        }\r\n    }\r\n    function format(string, prepend, expression) {\r\n        string = string || '';\r\n        prepend = prepend || '';\r\n        var splitted = string.split(',');\r\n        if (splitted.length > 1) {\r\n            var formatted = splitted.shift();\r\n            angular.forEach(splitted, function (value, index) {\r\n                if (expression) {\r\n                    formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\r\n                } else {\r\n                    formatted = formatted.split('{' + index + '}').join(prepend + value);\r\n                }\r\n            });\r\n            if (expression) {\r\n                return '\\'' + formatted + '\\'';\r\n            } else {\r\n                return formatted;\r\n            }\r\n        } else {\r\n            return prepend + string;\r\n        }\r\n    }\r\n    function reducer(o, key) {\r\n        return o[key];\r\n    }\r\n    function reducerSetter(o, key, value) {\r\n        if (typeof key == 'string') {\r\n            return reducerSetter(o, key.split('.'), value);\r\n        } else if (key.length == 1 && value !== undefined) {\r\n            return o[key[0]] = value;\r\n        } else if (key.length == 0) {\r\n            return o;\r\n        } else {\r\n            return reducerSetter(o[key[0]], key.slice(1), value);\r\n        }\r\n    }\r\n    function reducerAdder(o, key, value) {\r\n        if (typeof key == 'string') {\r\n            return reducerAdder(o, key.split('.'), value);\r\n        } else if (key.length == 1 && value !== undefined) {\r\n            return (o[key[0]] += value);\r\n        } else if (key.length == 0) {\r\n            return o;\r\n        } else {\r\n            return reducerAdder(o[key[0]], key.slice(1), value);\r\n        }\r\n    }\r\n    Utils.reverseSortOn = reverseSortOn;\r\n    Utils.getTouch = getTouch;\r\n    Utils.getRelativeTouch = getRelativeTouch;\r\n    Utils.getClosest = getClosest;\r\n    Utils.getClosestElement = getClosestElement;\r\n    Utils.throttle = throttle;\r\n    Utils.where = where;\r\n    Utils.format = format;\r\n    Utils.compileController = compileController;\r\n    Utils.reducer = reducer;\r\n    Utils.reducerSetter = reducerSetter;\r\n    Utils.reducerAdder = reducerAdder;\r\n    Utils.toMd5 = function (string) {\r\n        return Md5.encode(string);\r\n    };\r\n    Utils.ua = {\r\n        safari: safari,\r\n        msie: msie,\r\n        chrome: chrome,\r\n        mobile: mobile,\r\n    };\r\n    angular.forEach(Utils.ua, function (value, key) {\r\n        if (value) {\r\n            angular.element(document.getElementsByTagName('body')).addClass(key);\r\n        }\r\n    });\r\n    return Utils;\r\n}]);\r\n\r\nmodule.factory('Vector', function () {\r\n    function Vector(x, y) {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n    }\r\n    Vector.make = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.size = function (a) {\r\n        return Math.sqrt(a.x * a.x + a.y * a.y);\r\n    };\r\n    Vector.normalize = function (a) {\r\n        var l = Vector.size(a);\r\n        a.x /= l;\r\n        a.y /= l;\r\n        return a;\r\n    };\r\n    Vector.incidence = function (a, b) {\r\n        var angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\r\n        // if (angle < 0) angle += 2 * Math.PI;\r\n        // angle = Math.min(angle, (Math.PI * 2 - angle));\r\n        return angle;\r\n    };\r\n    Vector.distance = function (a, b) {\r\n        return Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\r\n    };\r\n    Vector.cross = function (a, b) {\r\n        return (a.x * b.y) - (a.y * b.x);\r\n    };\r\n    Vector.difference = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.power = function (a, b) {\r\n        var x = Math.abs(b.x - a.x);\r\n        var y = Math.abs(b.y - a.y);\r\n        return (x + y) / 2;\r\n    };\r\n    Vector.prototype = {\r\n        size: function () {\r\n            return Vector.size(this);\r\n        },\r\n        normalize: function () {\r\n            return Vector.normalize(this);\r\n        },\r\n        incidence: function (b) {\r\n            return Vector.incidence(this, b);\r\n        },\r\n        cross: function (b) {\r\n            return Vector.cross(this, b);\r\n        },\r\n        distance: function (b) {\r\n            return Vector.distance(this, b);\r\n        },\r\n        difference: function (b) {\r\n            return Vector.difference(this, b);\r\n        },\r\n        power: function () {\r\n            return (Math.abs(this.x) + Math.abs(this.y)) / 2;\r\n        },\r\n        towards: function (b, friction) {\r\n            friction = friction || 0.125;\r\n            this.x += (b.x - this.x) * friction;\r\n            this.y += (b.y - this.y) * friction;\r\n            return this;\r\n        },\r\n        add: function (b) {\r\n            this.x += b.x;\r\n            this.y += b.y;\r\n            return this;\r\n        },\r\n        friction: function (b) {\r\n            this.x *= b;\r\n            this.y *= b;\r\n            return this;\r\n        },\r\n        copy: function (b) {\r\n            return new Vector(this.x, this.y);\r\n        },\r\n        toString: function () {\r\n            return '{' + this.x + ',' + this.y + '}';\r\n        },\r\n    };\r\n    return Vector;\r\n});\r\n\r\nmodule.factory('ElementRect', ['Vector', function (Vector) {\r\n    function ElementRect() {\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.center = new Vector();\r\n    }\r\n    ElementRect.fromNative = function (nativeElement) {\r\n        return new ElementRect().set(nativeElement);\r\n    }\r\n    ElementRect.prototype = {\r\n        set: function (nativeElement) {\r\n            var rect = nativeElement.getBoundingClientRect();\r\n            this.x = rect.left;\r\n            this.y = rect.top;\r\n            this.width = nativeElement.offsetWidth;\r\n            this.height = nativeElement.offsetHeight;\r\n            this.center.x = this.x + this.width / 2;\r\n            this.center.y = this.y + this.height / 2;\r\n            this.native = nativeElement;\r\n            return this;\r\n        },\r\n        offset: function (vector) {\r\n            this.x += vector.x;\r\n            this.y += vector.y;\r\n            this.center.x = this.x + this.width / 2;\r\n            this.center.y = this.y + this.height / 2;\r\n            return this;\r\n        },\r\n        intersect: function (element) {\r\n            // console.log('intersect.this', this, 'element', element);\r\n            return !(element.x > this.x + this.width ||\r\n                        element.x + element.width < this.x ||\r\n                        element.y > this.y + this.height ||\r\n                        element.y + element.height < this.y);\r\n        },\r\n        toString: function () {\r\n            return '{' + this.x + ',' + this.y + ',' + this.width + ',' + this.height + '}';\r\n        },\r\n    };\r\n    return ElementRect;\r\n}]);\r\n\r\nmodule.factory('Style', function () {\r\n    var prefix = function detectTransformProperty() {\r\n        var transform = 'transform',\r\n            webkit = 'webkitTransform';\r\n        var div = document.createElement(\"DIV\");\r\n        if (typeof div.style[transform] !== 'undefined') {\r\n            ['webkit', 'moz', 'o', 'ms'].every(function (prop) {\r\n                var prefixed = '-' + prop + '-transform';\r\n                if (typeof div.style[prefixed] !== 'undefined') {\r\n                    prefix = prefixed;\r\n                    return false;\r\n                }\r\n                return true;\r\n            });\r\n        } else if (typeof div.style[webkit] !== 'undefined') {\r\n            prefix = '-webkit-transform';\r\n        } else {\r\n            prefix = undefined;\r\n        }\r\n        return prefix;\r\n    }();\r\n    function Style() {\r\n        this.props = {\r\n            scale: 1,\r\n            hoverScale: 1,\r\n            currentScale: 1,\r\n        }\r\n    }\r\n    Style.prototype = {\r\n        set: function (element) {\r\n            var styles = [];\r\n            angular.forEach(this, function (value, key) {\r\n                if (key !== 'props')\r\n                    styles.push(key + ':' + value);\r\n            });\r\n            element.style.cssText = styles.join(';') + ';';\r\n        },\r\n        transform: function (transform) {\r\n            this[prefix] = transform;\r\n        },\r\n        transformOrigin: function (x, y) {\r\n            this[prefix + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\r\n            this[prefix + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\r\n        },\r\n    };\r\n    Style.prefix = prefix;\r\n    return Style;\r\n});\r\n\n/* global angular, module */\r\n\r\n// REPORTS\r\n\r\nmodule.factory('Filters', [function () {\r\n    function Filters() {\r\n        this.keys = {};\r\n        this.flags = {};\r\n        this.values = [];\r\n        this.search = [];\r\n    }\r\n    Filters.prototype = {\r\n        has: function (id) {\r\n            return (id && this.keys[id] === true) || false;\r\n        },\r\n        active: function (id) {\r\n            return (this.has(id) && this.flags[id] === true) || false;\r\n        },\r\n        removeAll: function () {\r\n            this.keys = {};\r\n            this.values.length = 0;\r\n        },\r\n        reset: function () {\r\n            this.removeAll();\r\n            this.flags = {};\r\n            this.search = [];\r\n        },\r\n        clear: function () {\r\n            var filters = this;\r\n            angular.forEach(this.values, function (item) {\r\n                filters.off(item);\r\n            });\r\n        },\r\n        on: function (item) {\r\n            item.active = this.flags[item.id] = true;\r\n            this.search.push(item.id);\r\n        },\r\n        off: function (item) {\r\n            item.active = this.flags[item.id] = false;\r\n            var index = this.search.indexOf(item.id);\r\n            this.search.splice(index, 1);\r\n        },\r\n        toggle: function (item) {\r\n            if (this.active(item.id)) {\r\n                this.off(item);\r\n            } else {\r\n                this.on(item);\r\n            }\r\n        },\r\n        add: function (item) {\r\n            if (item.id && !this.has(item.id)) {\r\n                this.keys[item.id] = true;\r\n                this.values.push(item);\r\n            }\r\n        },\r\n        remove: function (item) {\r\n            if (this.has(item.id)) {\r\n                var index;\r\n                if (this.flags[item.id] === true) {\r\n                    item.active = this.flags[item.id] = false;\r\n                    index = this.search.indexOf(item.id);\r\n                    this.search.splice(index, 1);\r\n                }\r\n                index = this.values.indexOf(item);\r\n                this.values.splice(index, 1);\r\n                this.keys[item.id] = false;\r\n            }\r\n        },\r\n        sort: function () {\r\n            this.values.sort(function (va, vb) {\r\n                var a, b;\r\n                a = va.name ? String(va.name).toLowerCase() : ''; // ignore upper and lowercase\r\n                b = vb.name ? String(vb.name).toLowerCase() : ''; // ignore upper and lowercase\r\n                if (a < b) {\r\n                    return -1;\r\n                }\r\n                if (a > b) {\r\n                    return 1;\r\n                }\r\n                return 0;\r\n            });\r\n        },\r\n        filter: function (cell) {\r\n            if (this.search.length) {\r\n                return (this.search.indexOf(cell.key) !== -1);\r\n            } else {\r\n                return true;\r\n            }\r\n        },\r\n    };\r\n    return Filters;\r\n}]);\r\n\r\nmodule.factory('Order', ['repoLocale', function (repoLocale) {\r\n    function Order() {\r\n        this.set(0);\r\n    }\r\n    Order.prototype = {\r\n        set: function (sort) {\r\n            switch (sort) {\r\n                case 1:\r\n                    this.name = repoLocale.asc;\r\n                    this.sort = 1;\r\n                    this.asc = true;\r\n                    this.desc = false;\r\n                    break;\r\n                case -1:\r\n                    this.name = repoLocale.desc;\r\n                    this.sort = -1;\r\n                    this.asc = false;\r\n                    this.desc = true;\r\n                    break;\r\n                default:\r\n                    this.name = repoLocale.order;\r\n                    this.sort = 0;\r\n                    this.asc = false;\r\n                    this.desc = false;\r\n            }\r\n        },\r\n        toggle: function () {\r\n            var sort = this.sort - 1;\r\n            sort === -2 ? sort = 1 : null;\r\n            this.set(sort);\r\n        },\r\n    };\r\n    return Order;\r\n}]);\r\n\r\nmodule.factory('Field', ['$parse', '$filter', 'Utils', 'Filters', 'Order', 'fieldTypes', 'fieldTotalTypes', function ($parse, $filter, Utils, Filters, Order, fieldTypes, fieldTotalTypes) {\r\n    function Field(data) {\r\n        this.filters = new Filters();\r\n        this.order = new Order();\r\n        this.typeTotal = this.typeTotal || fieldTotalTypes.SUM;\r\n        data ? angular.extend(this, data) : null;\r\n        // console.log('typeTotal', this.typeTotal);\r\n        // PREPARE GETTER SETTERS\r\n        if (angular.isFunction(this.value)) {\r\n            this.value = this.value.bind(this);\r\n        }\r\n        this.name = this.name || this.value;\r\n        this.raw = this.raw || this.value;\r\n        this.key = this.key || this.value;\r\n        this.source = this.source || this.value;\r\n        this.getters = {};\r\n        var fields = ['key', 'value', 'raw', 'source', 'post'];\r\n        angular.forEach(fields, function (field) {\r\n            if (this[field]) {\r\n                this.getters[field] = angular.isFunction(this[field]) ? this[field] : $parse(this[field]);\r\n            }\r\n        }, this);\r\n        this.setters = {};\r\n        angular.forEach(this.getters, function (getter, key) {\r\n            if (!angular.isFunction(this[key])) {\r\n                this.setters[key] = getter.assign;\r\n            }\r\n        }, this);\r\n        // PREPARE GETTER SETTERS\r\n        this.keys = {};\r\n        this.total = 0;\r\n    }\r\n    Field.prototype = {\r\n        reset: function () {\r\n            this.keys = {};\r\n            this.total = 0;\r\n            if (!this.isActive()) {\r\n                this.filters.reset();\r\n            }\r\n        },\r\n        hasKey: function (item) {\r\n            var has = true;\r\n            var key = this.getters.key(item);\r\n            if (key && this.keys[key] != true) {\r\n                this.keys[key] = true;\r\n                has = false;\r\n            }\r\n            return has;\r\n        },\r\n        initValue: function (item) {\r\n            this.setters.raw(item, (this.getters.value(item) || 0));\r\n            return this;\r\n        },\r\n        aggregation: function (item, row) {\r\n            var a = (this.getters.raw(item) || 0);\r\n            var b = (this.getters.value(row) || 0);\r\n            var field = this;\r\n            switch (field.typeTotal) {\r\n                case fieldTotalTypes.MIN:\r\n                    field.setters.raw(item, Math.min(a, b));\r\n                    break;\r\n                case fieldTotalTypes.MAX:\r\n                    field.setters.raw(item, Math.max(a, b));\r\n                    break;\r\n                case fieldTotalTypes.AVG:\r\n                    var n = 0;\r\n                    field.setters.raw(item, (b + (a * n)) / (n + 1)); // (newVal + (avg * n)) / (n+1)\r\n                    break;\r\n                default:\r\n                    field.setters.raw(item, a + b);\r\n            }\r\n            return field;\r\n        },\r\n        // AGGREGATE\r\n        addCount: function (item, row) {\r\n            if (!this.hasKey(row) && this.setters.raw) {\r\n                var v = null;\r\n                if (item != row) {\r\n                    v = (this.getters.raw(item) || 0) + 1;\r\n                } else {\r\n                    v = 1;\r\n                }\r\n                this.setters.raw(item, v);\r\n            }\r\n            return this;\r\n        },\r\n        addValue: function (item) {\r\n            var key = this.getters.key(item);\r\n            if (!this.filters.has(key)) {\r\n                var value = this.formatValue(this.getters.raw(item));\r\n                var active = this.filters.flags[key];\r\n                this.filters.add({\r\n                    id: key,\r\n                    name: value || '-',\r\n                    active: active,\r\n                });\r\n            }\r\n        },\r\n        // METHODS\r\n        getLink: function (item) {\r\n            return angular.isFunction(this.link) ? this.link(item) : null;\r\n        },\r\n        isActive: function () {\r\n            if (angular.isFunction(this.active) && this.active) {\r\n                return this.active();\r\n            } else {\r\n                return this.active;\r\n            }\r\n        },\r\n        toggle: function () {\r\n            angular.isFunction(this.active) ? null : this.active = !this.active;\r\n        },\r\n        activate: function () {\r\n            angular.isFunction(this.active) ? null : this.active = true;\r\n        },\r\n        deactivate: function () {\r\n            angular.isFunction(this.active) ? null : this.active = false;\r\n        },\r\n        // FORMATTING\r\n        formatValue: function (value) {\r\n            switch (this.type) {\r\n                case fieldTypes.RESOURCE:\r\n                case fieldTypes.DISABLED:\r\n                    value = $filter('shortName')(value);\r\n                    break;\r\n                case fieldTypes.ID:\r\n                case fieldTypes.NUMBER:\r\n                    value = $filter('customNumber')(value, 0);\r\n                    break;\r\n                case fieldTypes.DOUBLE:\r\n                    value = $filter('customNumber')(value, 2);\r\n                    break;\r\n                case fieldTypes.WEEKS:\r\n                    value = $filter('customNumber')(value, 2, ' W');\r\n                    break;\r\n                case fieldTypes.DATE:\r\n                    value = $filter('date')(value, 'yyyy-MM-dd');\r\n                    break;\r\n                case fieldTypes.HOURS:\r\n                    value = $filter('customNumber')(value, 0, ' H');\r\n                    break;\r\n                case fieldTypes.COSTS:\r\n                    value = $filter('customNumber')(value, 0, ' ');\r\n                    break;\r\n                case fieldTypes.PERCENT:\r\n                    value = $filter('customNumber')(value, 2, ' %');\r\n                    break;\r\n                case fieldTypes.GAIN:\r\n                    value = angular.isNumber(value) ? (value > 0 ? '+' : '') + $filter('customNumber')(value, 2, ' %') : (value || '-');\r\n                    break;\r\n            }\r\n            return value;\r\n        },\r\n        getTotal: function (filtered) {\r\n            var value = this.getValueTotal(filtered);\r\n            return this.formatValue(value);\r\n        },\r\n        getFormat: function () {\r\n            var format = '';\r\n            switch (this.type) {\r\n                case fieldTypes.ID:\r\n                case fieldTypes.NUMBER:\r\n                    format = '#';\r\n                    break;\r\n                case fieldTypes.DOUBLE:\r\n                    format = '#';\r\n                    break;\r\n                case fieldTypes.DATE:\r\n                    format = 'yyyy-mm-dd';\r\n                    break;\r\n                case fieldTypes.WEEKS:\r\n                    format = '#,###0 [$W]';\r\n                    break;\r\n                case fieldTypes.HOURS:\r\n                    format = '#,###0 [$H]';\r\n                    break;\r\n                case fieldTypes.COSTS:\r\n                    format = '#,###.00 ';\r\n                    break;\r\n                case fieldTypes.PERCENT:\r\n                    format = '0.00%';\r\n                    break;\r\n                case fieldTypes.GAIN:\r\n                    format = '[Color 10]+0.00%;[Red]-0.00%;-';\r\n                    break;\r\n            }\r\n            return format;\r\n        },\r\n        // TOTALS\r\n        getCellTotal: function (rows, index) {\r\n            var value = 0, field = this, cell, previousCell;\r\n            if (field.compare && field.type === fieldTypes.GAIN) {\r\n                var current = 0;\r\n                var previous = 0;\r\n                angular.forEach(rows, function (row) {\r\n                    /*\r\n                    cell = row.cols[index];\r\n                    current += (field.$field.getters.raw(item) || 0);\r\n                    previous += (cell.getValue() || 0);\r\n                    */\r\n                    cell = row.cols[field.$field.col.index];\r\n                    previousCell = row.cols[index];\r\n                    current += (cell.getValue() || 0);\r\n                    previous += (previousCell.getValue() || 0);\r\n                });\r\n                if (previous) {\r\n                    value = (current - previous) / previous * 100;\r\n                }\r\n            } else {\r\n                switch (field.typeTotal) {\r\n                    case fieldTotalTypes.SUM:\r\n                        value = 0;\r\n                        break;\r\n                    case fieldTotalTypes.MIN:\r\n                        value = Number.POSITIVE_INFINITY;\r\n                        break;\r\n                    case fieldTotalTypes.MAX:\r\n                        value = Number.NEGATIVE_INFINITY;\r\n                        break;\r\n                    case fieldTotalTypes.AVG:\r\n                        break;\r\n                }\r\n                angular.forEach(rows, function (row, i) {\r\n                    cell = row.cols[index];\r\n                    var a = value;\r\n                    var b = (cell.getValue() || 0);\r\n                    switch (field.typeTotal) {\r\n                        case fieldTotalTypes.SUM:\r\n                            value = a + b;\r\n                            break;\r\n                        case fieldTotalTypes.MIN:\r\n                            value = a < b ? a : b;\r\n                            break;\r\n                        case fieldTotalTypes.MAX:\r\n                            value = a > b ? a : b;\r\n                            break;\r\n                        case fieldTotalTypes.AVG:\r\n                            value = (b + (a * i)) / (i + 1);\r\n                            break;\r\n                    }\r\n                    /*\r\n                    // MEDIA PONDERATA\r\n                    // Here's a functional approach, requiring ES5:\r\n                    var w = a.unzip(3).map(function(v, i, a) {\r\n                        var weight = v[0] * v[1];\r\n                        var sum = weight * v[2];\r\n                        return [sum, weight];\r\n                    }).reduce(function(p, c, i, a) {\r\n                        return [p[0] + c[0], p[1] + c[1]];\r\n                    }, [0, 0]);\r\n                    var aw = w[0] / w[1];\r\n                    // which in pseudo-code is:\r\n                    // split the array into chunks of three\r\n                    // convert each three [p1, p2, x ] into a pair [ p1 * p2 * x , p1 * p2 ]\r\n                    // sum the pairs (along the array, not within each pair)\r\n                    // divide one by the other\r\n                    // and where the (non-standard) unzip function which chunks the array is:\r\n                    Object.defineProperty(Array.prototype, 'unzip', {\r\n                        value: function(n) {\r\n                            n = n || 2;\r\n                            return this.reduce(function(p, c, i, a) {\r\n                                if (i % n === 0) {\r\n                                    p.push(a.slice(i, i + n));\r\n                                }\r\n                                return p;\r\n                            }, []);\r\n                        }\r\n                    });\r\n                    */\r\n                });\r\n                (value === Number.POSITIVE_INFINITY || value === Number.NEGATIVE_INFINITY) ? value = 0 : null;\r\n            }\r\n            field.total = value;\r\n            return value;\r\n        },\r\n        getValueTotal: function (filtered) {\r\n            var value = 0, field = this;\r\n            if (field.compare && field.type === fieldTypes.GAIN) {\r\n                var current = 0; // (field.getters.raw(item) || 0);\r\n                var previous = 0; // (this.getters.raw(item) || 0);                \r\n                angular.forEach(filtered, function (item) {\r\n                    current += (field.$field.getters.raw(item) || 0);\r\n                    previous += (field.getters.raw(item) || 0);\r\n                }.bind(this));\r\n                if (previous) {\r\n                    value = (current - previous) / previous * 100;\r\n                }\r\n            } else {\r\n                switch (field.typeTotal) {\r\n                    case fieldTotalTypes.SUM:\r\n                        value = 0;\r\n                        break;\r\n                    case fieldTotalTypes.MIN:\r\n                        value = Number.POSITIVE_INFINITY;\r\n                        break;\r\n                    case fieldTotalTypes.MAX:\r\n                        value = Number.NEGATIVE_INFINITY;\r\n                        break;\r\n                    case fieldTotalTypes.AVG:\r\n                        break;\r\n                }\r\n                angular.forEach(filtered, function (item, i) {\r\n                    var a = value;\r\n                    var b = (field.getters.raw(item) || 0);\r\n                    switch (field.typeTotal) {\r\n                        case fieldTotalTypes.SUM:\r\n                            value = a + b;\r\n                            break;\r\n                        case fieldTotalTypes.MIN:\r\n                            value = a < b ? a : b;\r\n                            break;\r\n                        case fieldTotalTypes.MAX:\r\n                            value = a > b ? a : b;\r\n                            break;\r\n                        case fieldTotalTypes.AVG:\r\n                            value = (b + (a * i)) / (i + 1);\r\n                            break;\r\n                    }\r\n                });\r\n                (value === Number.POSITIVE_INFINITY || value === Number.NEGATIVE_INFINITY) ? value = 0 : null;\r\n            }\r\n            field.total = value;\r\n            return value;\r\n        },\r\n        // STYLES\r\n        getHeaderClass: function () {\r\n            return this.groupBy ? '' : 'text-right';\r\n            /*\r\n            var cc = [];\r\n            angular.forEach(this, function (value, key) {\r\n                if (value === true) {\r\n                    cc.push(key);\r\n                }\r\n            });\r\n            switch (this.type) {\r\n                case fieldTypes.NUMBER:\r\n                case fieldTypes.DOUBLE:\r\n                case fieldTypes.WEEKS:\r\n                case fieldTypes.HOURS:\r\n                case fieldTypes.COSTS:\r\n                case fieldTypes.PERCENT:\r\n                case fieldTypes.GAIN:\r\n                    cc.push('text-right');\r\n                    break;\r\n            }\r\n            */\r\n            /*\r\n            var columnClass = this.getColumnClass();\r\n            if (columnClass != '') {\r\n                cc.push(columnClass);\r\n            }\r\n            */\r\n            // return cc.join(' ');\r\n        },\r\n        getColumnClass: function () {\r\n            return this.color ? 'shade-light-blue-' + this.color : '';\r\n        },\r\n        getCellClass: function (item) {\r\n            var field = this;\r\n            var cc = [];\r\n            angular.forEach(field, function (value, key) {\r\n                if (value === true) {\r\n                    cc.push(key);\r\n                }\r\n            });\r\n            field.groupBy ? null : cc.push('text-right');\r\n            angular.forEach(fieldTypes, function (value, key) {\r\n                if (value === field.type) {\r\n                    cc.push('cell-' + key.toLowerCase());\r\n                }\r\n            });\r\n            switch (field.type) {\r\n                case fieldTypes.LINK:\r\n                    cc.push('text-underline');\r\n                    break;\r\n                    /*\r\n                case fieldTypes.NUMBER:\r\n                case fieldTypes.DOUBLE:\r\n                case fieldTypes.WEEKS:\r\n                case fieldTypes.HOURS:\r\n                case fieldTypes.COSTS:\r\n                    cc.push('text-right');\r\n                    break;\r\n                case fieldTypes.PERCENT:\r\n                    cc.push('text-right');\r\n                    break;\r\n                case fieldTypes.GAIN:\r\n                    cc.push('text-right');\r\n                    break;\r\n                    */\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getTextClass: function (item) {\r\n            var cc = [];\r\n            switch (this.type) {\r\n                case fieldTypes.GAIN:\r\n                    var value = this.getters.raw(item);\r\n                    if (angular.isNumber(value) && value < 0) {\r\n                        cc.push('text-danger');\r\n                    } else {\r\n                        cc.push('text-success');\r\n                    }\r\n                    break;\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getTotalClass: function (filtered) {\r\n            var cc = [];\r\n            switch (this.type) {\r\n                case fieldTypes.NUMBER:\r\n                case fieldTypes.DOUBLE:\r\n                case fieldTypes.WEEKS:\r\n                case fieldTypes.HOURS:\r\n                case fieldTypes.COSTS:\r\n                case fieldTypes.PERCENT:\r\n                case fieldTypes.GAIN:\r\n                    cc.push('text-right');\r\n                    break;\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        /*\r\n        getItemClass: function (item) {\r\n            var cc = [];\r\n            cc.push(item.cells[this.$id].cellClass);\r\n            var columnClass = this.getColumnClass();\r\n            if (columnClass != '') {\r\n                cc.push(columnClass);\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getFormatted: function (item) {\r\n            if (this.dynamic) {\r\n                return this.formatValue(this.getters.raw(item));\r\n            } else {\r\n                return item.cells[this.$id].name;\r\n            }\r\n        },\r\n        filter: function (item) {\r\n            if (this.isActive() && this.filters.search.length) {\r\n                return (this.filters.search.indexOf(item.cells[this.$id].key) !== -1);\r\n            } else {\r\n                return true;\r\n            }\r\n        },\r\n        */\r\n        // STATIC\r\n        toStatic: function (item) {\r\n            if (this.post) {\r\n                this.setters.raw(item, (this.getters.post(item) || 0));\r\n            }\r\n            var field = this;\r\n            // var cell = item.cells[field.$id] = {\r\n            var cell = {\r\n                cellClass: field.getCellClass(item),\r\n                textClass: field.getTextClass(item),\r\n                link: (field.link ? field.link(item) : null),\r\n                pop: (field.pop ? field.pop(item) : null),\r\n                key: field.getters.key(item),\r\n                getValue: function () {\r\n                    if (field.dynamic && !field.post) {\r\n                        return field.getters.value(item);\r\n                    } else if (cell.value) {\r\n                        return cell.value;\r\n                    } else {\r\n                        return field.getters.raw(item);\r\n                    }\r\n                },\r\n                getName: function () {\r\n                    if (field.dynamic && !field.post) {\r\n                        return field.formatValue(cell.getValue());\r\n                    } else if (cell.name) {\r\n                        return cell.name;\r\n                    } else {\r\n                        return field.formatValue(cell.getValue());\r\n                    }\r\n                },\r\n                getTotalValue: function (rows, index) {\r\n                    return field.getCellTotal(rows, index);\r\n                },\r\n                getTotalName: function (rows, index) {\r\n                    var value = cell.getTotalValue(rows, index);\r\n                    return field.formatValue(value);\r\n                },\r\n                formatValue: function (value) {\r\n                    return field.formatValue(value);\r\n                },\r\n            };\r\n            cell.value = cell.getValue();\r\n            cell.name = cell.getName();\r\n            return cell;\r\n        },\r\n    };\r\n    Field.types = fieldTypes;\r\n    Field.totalTypes = fieldTotalTypes;\r\n    return Field;\r\n}]);\r\n\r\nmodule.factory('Fields', ['$parse', 'Utils', 'Field', 'fieldTypes', function ($parse, Utils, Field, fieldTypes) {\r\n    function Fields(fields) {\r\n        var array = [];\r\n        if (fields) {\r\n            angular.forEach(fields, function (field, index) {\r\n                field.$id = index + 1;\r\n                array.push(new Field(field));\r\n            });\r\n        }\r\n        angular.extend(array, Fields.prototype);\r\n        return array;\r\n    }\r\n    Fields.prototype = {\r\n        // EXPANSION\r\n        expand: function (data) {\r\n            var options = {\r\n                dynamic: true,\r\n                compare: false,\r\n            }\r\n            data ? angular.extend(options, data) : null;\r\n            // add percentuals and compares\r\n            var array = [], fields = this;\r\n            array.radios = {};\r\n            angular.forEach(this, function (field, index) {\r\n                field.$id = array.length + 1;\r\n                array.push(field);\r\n                if (field.aggregate && field.value === field.raw) {\r\n                    if (options.dynamic) {\r\n                        array.push(new Field({\r\n                            $id: array.length + 1,\r\n                            name: '%',\r\n                            value: function (item) {\r\n                                return field.getters.raw(item) / field.total * 100;\r\n                            },\r\n                            key: field.key,\r\n                            type: fieldTypes.PERCENT,\r\n                            dynamic: true,\r\n                            active: function () {\r\n                                return array.show.dynamic && field.active;\r\n                            },\r\n                            $field: field,\r\n                        }));\r\n                    }\r\n                    if (options.compare) {\r\n                        var fieldPrevious = new Field({\r\n                            $id: array.length + 1,\r\n                            name: field.name + ' anno precedente',\r\n                            value: function (item) {\r\n                                return this.getters.raw(item);\r\n                            },\r\n                            raw: field.value + 'Last',\r\n                            source: field.value,\r\n                            key: field.key,\r\n                            type: field.type, // \r\n                            count: field.count,\r\n                            compare: true,\r\n                            dynamic: true,\r\n                            active: function () {\r\n                                return (fields.show.compare && this.$field.active) || false;\r\n                            },\r\n                            $field: field,\r\n                        });\r\n                        array.push(fieldPrevious);\r\n                        array.push(new Field({\r\n                            $id: array.length + 1,\r\n                            name: '%',\r\n                            value: function (row) {\r\n                                return 0;\r\n                            },\r\n                            post: function (row) {\r\n                                var current = (field.getters.raw(row) || 0);\r\n                                var previous = (fieldPrevious.getters.raw(row) || 0);\r\n                                if (current && previous) {\r\n                                    return ((current - previous) / previous) * 100;\r\n                                } else if (current) {\r\n                                    return Number.POSITIVE_INFINITY; // '+ %';\r\n                                } else {\r\n                                    return null; // '+ %';\r\n                                }\r\n                            },\r\n                            raw: field.value + 'Gain',\r\n                            source: field.value,\r\n                            key: field.key,\r\n                            type: fieldTypes.GAIN, // field.type, // \r\n                            count: field.count,\r\n                            compare: true,\r\n                            dynamic: true,\r\n                            active: function () {\r\n                                return (fields.show.compare && this.$field.active) || false;\r\n                            },\r\n                            $field: field,\r\n                        }));\r\n                    }\r\n                }\r\n                if (field.radio && field.active) {\r\n                    array.radios[field.radio] = field.value;\r\n                }\r\n            });\r\n            angular.extend(array, Fields.prototype);\r\n            return array;\r\n        },\r\n        // AGGREGATE, GROUPBY & COMPARE\r\n        reset: function () {\r\n            this.groups = {};\r\n            angular.forEach(this, function (field) {\r\n                field.reset();\r\n            });\r\n            return this;\r\n        },\r\n        unique: function (row, items) {\r\n            var key = this.getGroupKey(row);\r\n            var item = this.groups[key];\r\n            if (!item) {\r\n                item = this.groups[key] = row; // angular.copy(row);\r\n                item.cells = [];\r\n                items.push(item);\r\n            }\r\n            return item;\r\n        },\r\n        iterate: function (row, items) {\r\n            row = angular.copy(row);\r\n            var item = this.unique(row, items);\r\n            this.aggregation(item, row);\r\n        },\r\n        compare: function (row, items) {\r\n            row = angular.copy(row);\r\n            angular.forEach(this, function (field) {\r\n                if (field.compare) {\r\n                    var value = field.getters.source(row);\r\n                    field.setters.raw(row, value);\r\n                }\r\n            });\r\n            /*\r\n            // !!! _1_\r\n            angular.forEach(this, function (field) {\r\n                if (field.compare) {\r\n                    field.setters.source(row, 0);\r\n                }\r\n            });\r\n            */\r\n            var item = this.unique(row, items);\r\n            this.aggregation(item, row, true);\r\n        },\r\n        aggregation: function (item, row, comparing) {\r\n            angular.forEach(this, function (field) {\r\n                var mode = (comparing ? field.compare : !field.compare);\r\n                if ((field.isActive() || field.always) && mode) {\r\n                    if (field.count) {\r\n                        field.addCount(item, row);\r\n                    } else if (comparing || field.aggregate) {\r\n                        if (!field.hasKey(row)) {\r\n                            if (item === row) {\r\n                                field.initValue(item);\r\n                            } else {\r\n                                field.aggregation(item, row);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            return this;\r\n        },\r\n        // AGGREGATE, GROUPBY & COMPARE\r\n        getCount: function () {\r\n            var i = 0;\r\n            angular.forEach(this, function (field) {\r\n                i += field.isActive() ? 1 : 0;\r\n            }.bind(this));\r\n            return i;\r\n        },\r\n        getFirstField: function () {\r\n            var first = null;\r\n            angular.forEach(this, function (field) {\r\n                if (first === null && field.isActive() && field.groupBy && field.value !== 'month' && field.value !== 'monthShort') {\r\n                    first = field;\r\n                }\r\n            });\r\n            return first;\r\n        },\r\n        getGroupKey: function (item) {\r\n            var keys = [];\r\n            angular.forEach(this, function (field) {\r\n                if (field.isActive() && field.groupBy) {\r\n                    keys.push(field.getters.key(item));\r\n                }\r\n            });\r\n            return keys.join('-');\r\n        },\r\n        getGroups: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (field, index) {\r\n                if (field.groupBy) {\r\n                    array.push(field);\r\n                }\r\n            });\r\n            angular.extend(array, Fields.prototype);\r\n            return array;\r\n        },\r\n        getAggregates: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (field, index) {\r\n                if (field.aggregate && !field.count) {\r\n                    array.push(field);\r\n                }\r\n            });\r\n            angular.extend(array, Fields.prototype);\r\n            return array;\r\n        },\r\n        getPercentages: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (field, index) {\r\n                if (field.type === fieldTypes.PERCENT) {\r\n                    array.push(field);\r\n                }\r\n            });\r\n            angular.extend(array, Fields.prototype);\r\n            return array;\r\n        },\r\n        getDynamics: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (field, index) {\r\n                if (field.dynamic) {\r\n                    array.push(field);\r\n                }\r\n            });\r\n            angular.extend(array, Fields.prototype);\r\n            return array;\r\n        },\r\n        getCompares: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (field, index) {\r\n                if (field.compare) {\r\n                    array.push(field);\r\n                }\r\n            });\r\n            angular.extend(array, Fields.prototype);\r\n            return array;\r\n        },\r\n        getCounters: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (field, index) {\r\n                if (field.count) {\r\n                    array.push(field);\r\n                }\r\n            });\r\n            angular.extend(array, Fields.prototype);\r\n            return array;\r\n        },\r\n        activeInRange: function (range) {\r\n            var flag = false;\r\n            var i = 0;\r\n            while (!flag && i < this.length) {\r\n                var field = this[i];\r\n                if (field.active) {\r\n                    flag = (range.indexOf(field.value) !== -1);\r\n                }\r\n                i++;\r\n            }\r\n            return flag;\r\n        },\r\n        toggleFields: function (field) {\r\n            if (field.radio) {\r\n                angular.forEach(this, function (item) {\r\n                    if (field.radio === item.radio && field !== item) {\r\n                        item.deactivate();\r\n                    }\r\n                });\r\n                field.activate();\r\n                this.radios[field.radio] = field.value;\r\n            } else {\r\n                field.toggle();\r\n            }\r\n        },\r\n        show: {\r\n            table: true, // defaults\r\n        },\r\n        // ELIMINARE\r\n        /*\r\n        isFilterDisabled: function (row, field, filtered) { // check if other values are disabled !! unused\r\n            var id = row.id,\r\n                t = this;\r\n            var has = false,\r\n                index = 0;\r\n            while (index < filtered.length) {\r\n                has = has || field.getters.key(filtered[index]) === id;\r\n                if (has) {\r\n                    index = filtered.length;\r\n                } else {\r\n                    index++;\r\n                }\r\n            }\r\n            return !has;\r\n        },\r\n        getSortKey: function (item) {\r\n            var values = [];\r\n            angular.forEach(this, function (field) {\r\n                if (field.isActive() && field.groupBy) {\r\n                    values.push(field.sort ? $parse(field.sort)(item) : field.formatValue(field.getters.raw(item)));\r\n                }\r\n            });\r\n            return values.join('');\r\n        },\r\n        */\r\n        toStatic: function (items) {\r\n            var fields = this,\r\n                cols = [],\r\n                rows = [],\r\n                cell;\r\n            // primo ciclo\r\n            angular.forEach(fields, function (field, index) {\r\n                field.filters.removeAll();\r\n                field.col = {\r\n                    active: field.isActive(),\r\n                    headerClass: field.getHeaderClass(),\r\n                    columnClass: field.getColumnClass(),\r\n                    totalClass: field.getTotalClass(),\r\n                    format: field.getFormat(),\r\n\r\n                    $id: field.$id,\r\n                    colName: field.name,\r\n                    type: field.type,\r\n                    groupBy: field.groupBy,\r\n                    aggregate: field.aggregate,\r\n                    compare: field.compare,\r\n                    filters: field.filters,\r\n                    order: field.order,\r\n                    originaIndex: index,\r\n                };\r\n                if (field.col.active) {\r\n                    field.col.index = cols.length;\r\n                    cols.push(field.col);\r\n                }\r\n            });\r\n            // lasciare serve un secondo ciclo!\r\n            angular.forEach(fields, function (field) {\r\n                if (field.col.active || (field.dynamic && !field.compare) || field.always) {\r\n                    angular.forEach(items, function (item, i) {\r\n                        cell = field.toStatic(item);\r\n                        if (field.hasSearch && field.groupBy) {\r\n                            field.addValue(item);\r\n                        }\r\n                        var row = rows[i] = (rows[i] || { cols: [] });\r\n                        cell = angular.extend(angular.copy(cell), field.col);\r\n                        row.cols[field.col.index] = cell;\r\n                    });\r\n                    if (field.hasSearch && field.groupBy) {\r\n                        field.filters.sort();\r\n                    }\r\n                }\r\n            });\r\n            // lasciare serve un terzo ciclo!\r\n            angular.forEach(cols, function (field, index) {\r\n                var last = rows.length ? (rows[rows.length - 1].cols[index]) : null;\r\n                field.$last = last;\r\n                field.getTotalValue = function (rows) {\r\n                    return this.$last ? this.$last.getTotalValue(rows, index) : null;\r\n                };\r\n                field.getTotalName = function (rows) {\r\n                    return this.$last ? this.$last.getTotalName(rows, index) : null;\r\n                };\r\n                /*\r\n                field.totalValue = field.getTotalValue();\r\n                field.totalName = field.getTotalName();\r\n                */\r\n            });\r\n            //console.log('Fields.toStatic', 'cols', cols.length, 'rows', rows.length);\r\n            return { cols: cols, rows: rows };\r\n        },\r\n    };\r\n    Fields.fromDatas = function (datas) {\r\n        return Fields.parseDatas(datas);\r\n    }\r\n    Fields.parseDatas = function getFields(datas) {\r\n        var fields = null;\r\n        if (datas && datas.length) {\r\n            fields = [];\r\n            function parse(item, prop) {\r\n                if (angular.isArray(item)) {\r\n                    angular.forEach(item, function (value, key) {\r\n                        parse(value, (prop || '') + '[' + key + ']');\r\n                    });\r\n                } else if (angular.isObject(item)) {\r\n                    angular.forEach(item, function (value, key) {\r\n                        parse(value, (prop ? prop + '.' : '') + key);\r\n                    });\r\n                } else {\r\n                    var field = {\r\n                        value: prop,\r\n                        type: fieldTypes.TEXT,\r\n                        active: fields.length < 6,\r\n                    };\r\n                    if (angular.isDate(item) || (angular.isNumber(item) &&\r\n                        (prop.toLowerCase().indexOf('date') !== -1 || prop.toLowerCase().indexOf('time') !== -1)\r\n                        )) {\r\n                        field.type = fieldTypes.DATE;\r\n                        field.groupBy = true;\r\n                        field.hasSearch = true;\r\n                    } else if (angular.isNumber(item)) {\r\n                        field.type = fieldTypes.NUMBER;\r\n                        field.aggregate = true;\r\n                        field.color = 1;\r\n                    } else {\r\n                        if (angular.isString(item) && item.indexOf('http') === 0) {\r\n                            field.type = fieldTypes.LINK;\r\n                        }\r\n                        field.groupBy = true;\r\n                        field.hasSearch = true;\r\n                    }\r\n                    fields.push(field);\r\n                }\r\n            }\r\n            parse(datas[0]);\r\n        }\r\n        return fields;\r\n    };\r\n    Fields.types = fieldTypes;\r\n    return Fields;\r\n}]);\r\n\r\nmodule.factory('Table', ['$parse', '$filter', 'Fields', 'fieldTypes', 'fieldTotalTypes', 'repoLocale', function ($parse, $filter, Fields, fieldTypes, fieldTotalTypes, repoLocale) {\r\n    var MAX_FIELDS_ORDERED = 4;\r\n    function Table(fields, options) {\r\n        this.fields = new Fields(fields).expand(options);\r\n        this.defaults = fields.map(function (field) {\r\n            return {\r\n                $id: field.$id,\r\n                active: field.active,\r\n            };\r\n        });\r\n        this.groupables = [{\r\n            name: repoLocale.groupBy,\r\n            items: this.fields.getGroups()\r\n        }, ];\r\n        this.aggregables = [{\r\n            name: repoLocale.aggregate,\r\n            items: this.fields.getAggregates()\r\n        }, ];\r\n        this.excludes = [];\r\n        this.includes = [];\r\n        this.setOptions(options);\r\n        // DATAS\r\n        this.datas = [];\r\n        this.items = [];\r\n        this.rows = [];\r\n        this.cols = [];\r\n        this.locale = repoLocale;\r\n    }\r\n    Table.prototype = {\r\n        setDatas: function (datas, compares) {\r\n            if (datas) {\r\n                angular.forEach(datas, function (item, index) {\r\n                    item.$id = index + 1;\r\n                });\r\n            }\r\n            this.datas = datas;\r\n            if (compares) {\r\n                angular.forEach(compares, function (item, index) {\r\n                    item.$id = index + 1;\r\n                });\r\n            }\r\n            this.compares = compares;\r\n            this.update();\r\n        },\r\n        setOptions: function (options) {\r\n            var table = this;\r\n            this.options = [{\r\n                name: repoLocale.columns,\r\n                icon: 'icon-columns',\r\n                groups: this.groupables,\r\n                toggle: function (item) {\r\n                    return table.toggleField(item);\r\n                },\r\n                active: true,\r\n            }, {\r\n                name: repoLocale.values,\r\n                icon: 'icon-values',\r\n                groups: this.aggregables,\r\n                toggle: function (item) {\r\n                    return table.toggleField(item);\r\n                },\r\n            }, {\r\n                name: repoLocale.options,\r\n                icon: 'icon-options',\r\n                groups: [{\r\n                    name: repoLocale.exclude,\r\n                    items: this.excludes,\r\n                    toggle: function (item) {\r\n                        return table.exclude(item);\r\n                    },\r\n                }, {\r\n                    name: repoLocale.include,\r\n                    items: this.includes,\r\n                    toggle: function (item) {\r\n                        return table.include(item);\r\n                    },\r\n                }, {\r\n                    name: repoLocale.flags,\r\n                    items: [{\r\n                        name: repoLocale.incidence,\r\n                        key: 'dynamic',\r\n                    }],\r\n                    toggle: function (item) {\r\n                        return table.toggle(item.key);\r\n                    }\r\n                }],\r\n            }, ];\r\n        },\r\n        update: function () {\r\n            this.items = [];\r\n            this.rows = [];\r\n            this.cols = [];\r\n            var datas = this.datas;\r\n            var items = this.items;\r\n            var fields = this.fields;\r\n            var excludes = this.excludes;\r\n            var includes = this.includes;\r\n            var compares = this.compares;\r\n            fields.reset();\r\n            // var compared = null;\r\n            angular.forEach(datas, function (row) {\r\n                var has = true;\r\n                angular.forEach(excludes, function (e) {\r\n                    if (e.active) {\r\n                        has = has && e.filter(row);\r\n                    }\r\n                });\r\n                angular.forEach(includes, function (i) {\r\n                    if (i.active) {\r\n                        has = has && i.filter(row);\r\n                    }\r\n                });\r\n                if (has) {\r\n                    fields.iterate(row, items);\r\n                }\r\n            });\r\n            if (compares) {\r\n                // compared = [];\r\n                angular.forEach(compares, function (row) {\r\n                    var has = true;\r\n                    angular.forEach(excludes, function (e) {\r\n                        if (e.active) {\r\n                            has = has && e.filter(row);\r\n                        }\r\n                    });\r\n                    angular.forEach(includes, function (i) {\r\n                        if (i.active) {\r\n                            has = has && i.filter(row);\r\n                        }\r\n                    });\r\n                    if (has) {\r\n                        // compared.push(row);\r\n                        fields.compare(row, items);\r\n                    }\r\n                });\r\n            }\r\n            this.toStatic();\r\n        },\r\n        setOrderBy: function () {\r\n            // var defaults = [];\r\n            // var orders = [];\r\n            var table = this;\r\n            var defaultsFiltered = [];\r\n            var ordersFiltered = [];\r\n            var sign;\r\n            angular.forEach(table.fields, function (field, index) {\r\n                if (field.col.active) {\r\n                    if (field.order.sort !== 0) {\r\n                        sign = (field.order.sort === -1 ? '-' : '');\r\n                        ordersFiltered.push(sign + 'cols[' + defaultsFiltered.length + '].getValue()');\r\n                        // orders.push(sign + field.raw);                        \r\n                    }\r\n                    defaultsFiltered.push('cols[' + defaultsFiltered.length + '].getValue()');\r\n                    // defaults.push(field.raw);\r\n                }\r\n            });\r\n            // defaults.length = Math.min(MAX_FIELDS_ORDERED, defaults.length);\r\n            defaultsFiltered.length = Math.min(MAX_FIELDS_ORDERED, defaultsFiltered.length);\r\n            // table.orderBy = orders.length ? orders : defaults; // null;\r\n            table.filteredOrderBy = ordersFiltered.length ? ordersFiltered : defaultsFiltered; // null;\r\n            // console.log('Table.sort', 'filteredOrderBy', table.filteredOrderBy);\r\n        },\r\n        exclude: function (item) {\r\n            item.active = !item.active;\r\n            this.update();\r\n        },\r\n        include: function (item) {\r\n            item.active = !item.active;\r\n            this.update();\r\n        },\r\n        active: function (item) {\r\n            if (this.fields && this.fields.indexOf(item) !== -1) {\r\n                return item.isActive();\r\n            } else if (this.excludes.indexOf(item) !== -1 || this.includes.indexOf(item) !== -1) {\r\n                return item.active;\r\n            } else {\r\n                return this.has(item.key);\r\n            }\r\n        },\r\n        has: function (key) {\r\n            return (this.fields ? this.fields.show[key] : null);\r\n        },\r\n        set: function (key, value) {\r\n            if (this.fields) {\r\n                this.fields.show[key] = value;\r\n            }\r\n            return this;\r\n        },\r\n        resetFilters: function () {\r\n            var table = this;\r\n            angular.forEach(table.fields, function (field, key) {\r\n                angular.forEach(table.defaults, function (item) {\r\n                    if (field.$id === item.$id) {\r\n                        angular.isFunction(field.active) ? null : field.active = item.active;\r\n                    }\r\n                });\r\n                field.filters.reset();\r\n            });\r\n            table.fields = table.fields.sort(function (a, b) {\r\n                return a.$id - b.$id;\r\n            });\r\n            // table.fields.radios.workloads = 'supplier.name'; //??? default radios ???\r\n            table.update();\r\n        },\r\n        hasRow: function (row) {\r\n            var table = this, cell;\r\n            var has = true;\r\n            angular.forEach(table.cols, function (col, index) {\r\n                cell = row.cols[index];\r\n                cell.matches = null;\r\n                has = has && col.filters.filter(cell);\r\n            });\r\n            // SPOSTARE RICERCA SEARCH OBJECT\r\n            if (has && table.search && table.search.length) {\r\n                var match = false;\r\n                angular.forEach(row.cols, function (cell) {\r\n                    cell.matches = new RegExp(table.search, 'gim').exec(cell.name);\r\n                    match = match || (cell.matches !== null);\r\n                });\r\n                has = has && match;\r\n            }\r\n            return has;\r\n        },\r\n        doFilterStatic: function (cols) {\r\n            var table = this;\r\n            var fields = table.fields, cell;\r\n            return function (row) {\r\n                return table.hasRow(row);\r\n            };\r\n        },\r\n        toggle: function (mode) {\r\n            var value = null;\r\n            if (this.fields) {\r\n                var show = this.fields.show;\r\n                show[mode] = !show[mode];\r\n                switch (mode) {\r\n                    case 'dynamic':\r\n                        show.compare = false;\r\n                        break;\r\n                    case 'compare':\r\n                        show.dynamic = false;\r\n                        break;\r\n                }\r\n                value = show[mode];\r\n            }\r\n            this.toStatic(); //!!! nuovo\r\n            return value;\r\n        },\r\n        toggleField: function (field) {\r\n            this.fields.toggleFields(field);\r\n            this.update();\r\n        },\r\n        toggleOrder: function (field) {\r\n            angular.forEach(this.fields, function (f) {\r\n                if (f.$id !== field.$id) {\r\n                    f.order.set(0);\r\n                }\r\n            });\r\n            field.order.toggle();\r\n            this.setOrderBy();\r\n        },\r\n        swap: function (from, to) {\r\n            // console.log('Table.swap', 'from', from, 'to', to);\r\n            angular.forEach(this.fields, function (field) {\r\n                if (field.$id === from.$id) {\r\n                    from = field;\r\n                }\r\n                if (field.$id === to.$id) {\r\n                    to = field;\r\n                }\r\n            });\r\n            // from = this.fields[this.fields.indexOf(from)];\r\n            // to = this.fields[this.fields.indexOf(to)];\r\n            var fi = this.fields.indexOf(from);\r\n            var field = this.fields[fi];\r\n            this.fields.splice(fi, 1);\r\n            var ti = this.fields.indexOf(to);\r\n            this.fields.splice(ti, 0, field);\r\n            // console.log('Table.swap', fi, ti, field);\r\n            this.update();\r\n        },\r\n        toStatic: function () {\r\n            var table = this;\r\n            var filtered = table.fields.toStatic(table.items);\r\n            table.rows = filtered.rows;\r\n            table.cols = filtered.cols;\r\n            table.setOrderBy();\r\n            if (this.after && angular.isFunction(this.after)) {\r\n                this.after(table.items);\r\n            }\r\n        },\r\n        toJson: function (data) {\r\n            var table = this;\r\n            var json = {\r\n                name: 'Repotable',\r\n                description: 'a view of selected datas', // + $filter('date')(filters.dateFrom, 'dd MMM yyyy') + ' al ' + $filter('date')(filters.dateTo, 'dd MMM yyyy'),\r\n            };\r\n            data ? angular.extend(json, data) : null;\r\n            json.columns = [];\r\n            json.rows = [];\r\n            if (table.rows.length) {\r\n                var cols = table.cols;\r\n                var rows = table.rows;\r\n                var filteredRows = [];\r\n                angular.forEach(cols, function (col, index) {\r\n                    json.columns.push({\r\n                        index: index,\r\n                        name: col.colName,\r\n                        format: col.format,\r\n                    });\r\n                });\r\n                angular.forEach(rows, function (row, index) {\r\n                    if (table.hasRow(row)) {\r\n                        filteredRows.push(row);\r\n                    }\r\n                });\r\n                filteredRows = $filter('orderBy')(filteredRows, table.filteredOrderBy);\r\n                angular.forEach(filteredRows, function (row, index) {\r\n                    var item = [];\r\n                    angular.forEach(cols, function (col, index) {\r\n                        var cell = row.cols[index];\r\n                        item[index] = cell.getValue();\r\n                        switch (col.type) {\r\n                            case fieldTypes.PERCENT:\r\n                            case fieldTypes.GAIN:\r\n                                item[index] /= 100;\r\n                                break;\r\n                        }\r\n                    });\r\n                    json.rows.push(item);\r\n                });                \r\n                var item = [];\r\n                angular.forEach(cols, function (col, index) {\r\n                    if (col.aggregate) {\r\n                        item[index] = col.getTotalValue(filteredRows);\r\n                        switch (col.type) {\r\n                            case fieldTypes.PERCENT:\r\n                            case fieldTypes.GAIN:\r\n                                item[index] /= 100;\r\n                                break;\r\n                        }\r\n                    } else {\r\n                        item[index] = null;\r\n                    }\r\n                });\r\n                json.rows.push(item);\r\n            }\r\n            return json;\r\n        },\r\n    };\r\n    Table.fromDatas = function (datas) {\r\n        if (!angular.isArray(datas) || !datas.length > 1 || !angular.isObject(datas[0])) {\r\n            angular.forEach(datas, function (data) {\r\n                if (angular.isArray(data) && data.length && angular.isObject(data[0])) {\r\n                    datas = data;\r\n                }\r\n            });\r\n        }\r\n        if (!angular.isArray(datas)) {\r\n            datas = [datas];\r\n        }\r\n        var fields = Fields.fromDatas(datas);\r\n        var table = new Table(fields);\r\n        table.setDatas(datas);\r\n        return table;\r\n    };\r\n    Table.types = fieldTypes;\r\n    Table.totalTypes = fieldTotalTypes;\r\n    return Table;\r\n}]);\r\n\r\n// REPORTS\r\n\r\nmodule.value('repoLocale', {\r\n    report: 'Report',\r\n    groupBy: 'GroupBy',\r\n    aggregate: 'Aggregate',\r\n    columns: 'Columns',\r\n    values: 'Values',\r\n    options: 'Options',\r\n    exclude: 'Exclude',\r\n    include: 'Include',\r\n    flags: 'Flags',\r\n    incidence: 'Incidence',\r\n    filter: 'Filter',\r\n    order: 'Order',\r\n    desc: 'Desc',\r\n    asc: 'Asc',\r\n    reset: 'Reset',\r\n    no_results: 'no results',\r\n});\r\n\r\nmodule.service('Droppables', ['ElementRect', function(ElementRect) {\r\n    this.natives = [];\r\n    this.callbacks = [];\r\n    this.rects = [];\r\n    this.add = function(nativeElement, callback) {\r\n        this.natives.push(nativeElement);\r\n        this.callbacks.push(callback || function() {});\r\n        this.rects.push(ElementRect.fromNative(nativeElement));\r\n    };\r\n    this.remove = function(nativeElement) {\r\n        var index = this.natives.indexOf(nativeElement);\r\n        if (index !== -1) {\r\n            this.natives.splice(index, 1);\r\n            this.callbacks.splice(index, 1);\r\n            this.rects.splice(index, 1);\r\n        }\r\n    };\r\n    this.getIntersections = function(item) {\r\n        var intersections = [],\r\n            element;\r\n        angular.forEach(this.rects, function(rect, index) {\r\n            rect.set(rect.native);\r\n            element = angular.element(rect.native);\r\n            element.removeClass('dropping');\r\n            if (rect.intersect(item)) {\r\n                rect.distance = rect.center.distance(item.center);\r\n                rect.data = this.callbacks[index]();\r\n                intersections.push(rect);\r\n                element.addClass('over');\r\n            } else {\r\n                element.removeClass('over');\r\n            }\r\n        }.bind(this));\r\n        intersections.sort(function(a, b) {\r\n            if (a.distance < b.distance) {\r\n                return -1;\r\n            }\r\n            if (a.distance > b.distance) {\r\n                return 1;\r\n            }\r\n            return 0;\r\n        });\r\n        return intersections;\r\n    };\r\n}]);\r\n\n//HEAD \n(function(app) {\ntry { app = angular.module(\"repotable\"); }\ncatch(err) { app = angular.module(\"repotable\", []); }\napp.run([\"$templateCache\", function($templateCache) {\n\"use strict\";\n\n$templateCache.put(\"repotable/partials/filters\",\"<div>\\n\" +\n    \"    <span class=\\\"float-right\\\" ng-click=\\\"table.resetFilters()\\\" ng-bind=\\\"table.locale.reset\\\"></span>\\n\" +\n    \"    <!-- OPTIONS -->\\n\" +\n    \"    <div class=\\\"option\\\" ng-repeat=\\\"option in table.options track by $index\\\" ng-class=\\\"{ active: !option.closed }\\\">\\n\" +\n    \"        <h6 ng-click=\\\"option.closed = !option.closed\\\"><i ng-class=\\\"option.icon\\\"></i> <span ng-bind=\\\"option.name\\\"></span></h6>\\n\" +\n    \"        <!-- GROUP -->\\n\" +\n    \"        <div class=\\\"group\\\" ng-repeat=\\\"group in option.groups track by $index\\\" ng-if=\\\"group.items.length && !option.closed\\\">\\n\" +\n    \"            <h4 ng-bind=\\\"group.name\\\"></h4>\\n\" +\n    \"            <ul class=\\\"fields\\\">\\n\" +\n    \"                <!-- ITEMS -->\\n\" +\n    \"                <li class=\\\"field\\\" ng-class=\\\"{ 'active': table.active(item) }\\\" ng-repeat=\\\"item in group.items track by $index\\\" ng-click=\\\"group.toggle ? group.toggle(item) : option.toggle(item)\\\">\\n\" +\n    \"                    <span ng-bind=\\\"item.name\\\"></span> <i class=\\\"icon-check-mark\\\"></i>\\n\" +\n    \"                </li>\\n\" +\n    \"            </ul>\\n\" +\n    \"        </div>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\")\n\n$templateCache.put(\"repotable/partials/repotable\",\"<div class=\\\"repotable\\\">\\n\" +\n    \"    <div style=\\\"display: flex;\\\">\\n\" +\n    \"        <section class=\\\"container-fluid shadow section-bordered margin-bottom-xs-40\\\">\\n\" +\n    \"            <h6 class=\\\"headline foreground light-60\\\">\\n\" +\n    \"                <i ng-class=\\\"{ 'icon-search': !table.search, 'icon-close': table.search }\\\" ng-click=\\\"table.search = null\\\"></i>\\n\" +\n    \"                <input type=\\\"text\\\" class=\\\"form-control\\\" placeholder=\\\"{{table.name}}\\\" ng-model=\\\"table.search\\\" ng-model-options=\\\"{ allowInvalid: true, debounce: 250 }\\\">\\n\" +\n    \"                <i class=\\\"icon-settings float-right\\\" ng-click=\\\"tabs.opened = !tabs.opened\\\"></i>\\n\" +\n    \"            </h6>\\n\" +\n    \"            <div class=\\\"inner\\\" ng-if=\\\"table.has('table')\\\">\\n\" +\n    \"                <div ng-include=\\\"'repotable/partials/table'\\\"></div>\\n\" +\n    \"            </div>\\n\" +\n    \"            <!-- FILTERS -->\\n\" +\n    \"            <div class=\\\"filters\\\" ng-class=\\\"{ opened: tabs.opened }\\\" ng-include=\\\"'repotable/partials/filters'\\\" ng-if=\\\"tabs.opened\\\"></div>\\n\" +\n    \"            <!-- ERRORS -->\\n\" +\n    \"            <div ng-include=\\\"'partials/errors'\\\"></div>\\n\" +\n    \"            <!-- EXCEL -->\\n\" +\n    \"            <div class=\\\"row\\\" ng-if=\\\"filtered.length\\\">\\n\" +\n    \"                <div class=\\\"col-lg-12 text-xs-right\\\">\\n\" +\n    \"                    <button type=\\\"button\\\" ng-click=\\\"excel()\\\" class=\\\"btn btn-sm btn-outline-primary btn-icon btn-block-md-down\\\">Esporta in Excel <i class=\\\"icon-print\\\"></i></button>\\n\" +\n    \"                </div>\\n\" +\n    \"            </div>\\n\" +\n    \"        </section>\\n\" +\n    \"    </div>\\n\" +\n    \"</div>\")\n\n$templateCache.put(\"repotable/partials/table\",\"<div>\\n\" +\n    \"    <table class=\\\"atable-responsive atable-responsive-default atable-dynamic\\\" style=\\\"table-layout: auto; width: 100%;\\\">\\n\" +\n    \"        <!-- HEAD -->\\n\" +\n    \"        <thead>\\n\" +\n    \"            <tr>\\n\" +\n    \"                <th class=\\\"{{col.headerClass}}\\\" ng-repeat=\\\"col in table.cols track by $index\\\" ng-model=\\\"col\\\" droppable-item=\\\".draggable\\\" droppable-index=\\\"$index\\\" draggable-item=\\\".draggable\\\" draggable-if=\\\"col.groupBy\\\" droppable-if=\\\"col.groupBy\\\" ng-disabled=\\\"!col.groupBy\\\">\\n\" +\n    \"                    <div class=\\\"draggable\\\">\\n\" +\n    \"                        <span class=\\\"th-label\\\" title=\\\"{{col.colName}}\\\" ng-bind=\\\"col.colName\\\"></span>\\n\" +\n    \"                        <div ng-if=\\\"col.filters.values.length > 1\\\">\\n\" +\n    \"                            <button class=\\\"filter-btn dropdown-toggle\\\" toggler=\\\"table.dropdown\\\" value=\\\"col.$id\\\" target=\\\"#nav-col-{{col.$id}}\\\">\\n\" +\n    \"                                <span ng-bind=\\\"table.locale.filter\\\"></span>\\n\" +\n    \"                            </button>\\n\" +\n    \"                        </div>\\n\" +\n    \"                        <button class=\\\"sort-btn\\\" ng-click=\\\"table.toggleOrder(col)\\\" ng-title=\\\"col.order.name\\\">\\n\" +\n    \"                            <span><span ng-bind=\\\"col.order.name\\\"></span> <i ng-class=\\\"{ 'icon-sort-asc' : col.order.asc, 'icon-sort-desc' : col.order.desc }\\\"></i></span>\\n\" +\n    \"                        </button>\\n\" +\n    \"                    </div>\\n\" +\n    \"                </th>\\n\" +\n    \"            </tr>\\n\" +\n    \"        </thead>\\n\" +\n    \"        <!-- ROWS -->\\n\" +\n    \"        <tbody ng-repeat=\\\"row in table.rows | filter:table.doFilterStatic(table.cols) | orderBy:table.filteredOrderBy | limitTo:(tabs.opened ? 3 : null) as filteredRows track by $index\\\" ng-if=\\\"!source.state.isBusy && table.rows.length\\\">\\n\" +\n    \"            <tr>\\n\" +\n    \"                <td ng-repeat=\\\"cell in row.cols track by $index\\\" style=\\\"position: relative;\\\" link-to=\\\"cell.link\\\" class=\\\"{{cell.cellClass}} {{cell.columnClass}}\\\">\\n\" +\n    \"                    <label ng-bind=\\\"cell.colName\\\"></label>\\n\" +\n    \"                    <span class=\\\"{{cell.textClass}}\\\" ng-class=\\\"{ 'text-underline': cell.pop, 'text-highlight': cell.matches.length }\\\" ng-bind=\\\"cell.getName()\\\" pop=\\\"cell.pop\\\"></span>\\n\" +\n    \"                </td>\\n\" +\n    \"            </tr>\\n\" +\n    \"        </tbody>\\n\" +\n    \"        <!-- FOOT -->\\n\" +\n    \"        <tfoot ng-if=\\\"!source.state.isBusy && filteredRows.length\\\">\\n\" +\n    \"            <tr class=\\\"row-recap\\\">\\n\" +\n    \"                <td class=\\\"{{col.headerClass}}\\\" ng-repeat=\\\"col in table.cols track by $index\\\">\\n\" +\n    \"                    <label ng-if=\\\"col.aggregate || col.compare\\\" ng-bind=\\\"col.colName\\\"></label>\\n\" +\n    \"                    <span ng-if=\\\"col.aggregate || col.compare\\\" class=\\\"tag {{col.textClass}} {{col.totalClass}}\\\" ng-bind=\\\"col.getTotalName(filteredRows)\\\"></span>\\n\" +\n    \"                </td>\\n\" +\n    \"            </tr>\\n\" +\n    \"        </tfoot>\\n\" +\n    \"        <!-- NO RESULTS -->\\n\" +\n    \"        <tbody ng-if=\\\"!source.state.isBusy && !filteredRows.length\\\">\\n\" +\n    \"            <tr>\\n\" +\n    \"                <td class=\\\"text-xs-center\\\" colspan=\\\"{{table.fields.getCount()}}\\\">\\n\" +\n    \"                    <p>\\n\" +\n    \"                        <span ng-bind=\\\"table.locale.no_results\\\"></span>\\n\" +\n    \"                    </p>\\n\" +\n    \"                </td>\\n\" +\n    \"            </tr>\\n\" +\n    \"        </tbody>\\n\" +\n    \"    </table>\\n\" +\n    \"    <ul ng-repeat=\\\"col in table.cols track by $index\\\" ng-if=\\\"table.dropdown == col.$id\\\" class=\\\"fields fields-filters\\\" id=\\\"nav-col-{{col.$id}}\\\">\\n\" +\n    \"        <li ng-repeat=\\\"value in col.filters.values\\\" class=\\\"field\\\" ng-class=\\\"{ active: value.active }\\\" ng-click=\\\"stop($event) && col.filters.toggle(value)\\\">\\n\" +\n    \"            <span ng-bind=\\\"value.name\\\"></span> <i class=\\\"icon-check-mark\\\"></i>\\n\" +\n    \"        </li>\\n\" +\n    \"    </ul>\\n\" +\n    \"</div>\")\n}]);\n})();\n\r\n})(window, window.angular);\r\n"]}