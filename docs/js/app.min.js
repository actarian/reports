"use strict";var app=angular.module("app",["ngSanitize","ngMessages"]);app.config(["$httpProvider",function(t){}]),window.console?null:window.console={log:function(){}},window.domain="//"+location.hostname+(location.port?":"+location.port:""),app.constant("domain",domain),app.constant("formActions",{CLI_PULL_NEW:1,CLI_PUSH_EXHISTING:2,COM_HANDLED:3,COM_SUPPORT:4,COM_UNAUTHORIZED:5,COM_EXTRA_BUDGET:6,COM_CLOSE:7,PLDSSPETC_AC_SHORT_YES:8,PLDSSPETC_AC_SHORT_NO:9,PLDSSPETC_SHORT_YES:10,PLDSSPETC_SHORT_NO:11,CAPOF_CLOSE:12,CAPOF_NO_BUDGET:13,CAPOF_CREATE:14,CAPOF_TASK:15,DIRCOM_ACCEPTED:16,DIRCOM_REFUSED:17,CAPOF_INFO:18,ASSIGNTO_CLOSE:19}),app.constant("formTypes",{CLI_PULL:1,COM_PULL_AC:2,COM_PULL:3,COM_PUSH:4,COM_LONG:5,COM_EXTRA:6,COM_EXTRA_CONFIRMED:7,PLDSSPETC_PUSH:8,PLDSSPETC_PULL:9,CAPOF_ASSIGNATION:10,DIRCOM_EXTRA:11,COMPLETE:12,COM_TASK:13}),app.constant("formStatus",{STATUS_WAITING:1,STATUS_TASK:2,STATUS_COM:3,STATUS_BUDGET:4,STATUS_COMPLETE:5}),app.constant("taskStatus",{STATUS_OPENED:1,STATUS_HANDLED:2,STATUS_WAITING:3,STATUS_COMPLETED:4,STATUS_ESTIMATION:5,STATUS_PLANNED:6}),app.constant("teamStatus",{STATUS_UNDONE:0,STATUS_DONE:1}),app.constant("negotiationStatus",{STATUS_OPENED:1,STATUS_CLOSED:2}),app.constant("estimationStatus",{STATUS_RAI:255,STATUS_COM:270,STATUS_NEGOTIATION:254,STATUS_ACCEPTED:252,STATUS_REFUSED:253,STATUS_COMPLETED:271}),app.constant("projectTypes",{NORMAL:1,DOWNWARD:2}),app.constant("projectStatus",{STATUS_OPENED:1,STATUS_CLOSED:2}),app.constant("userAreas",{DIRCOM:250,COM:210,SEG:200,CAPOF:80,PLDSSPE:170,TEC:140,NONE:0}),app.constant("userGroups",{ADMIN:[1e4],DIRCOM:[1e4,250,1],COM:[1e4,210,200],SEG:[1e4,200],PLDSSPETC:[1e4,220,170,160,150,140],PLDSSPE:[1e4,220,170,160,150],RR:[1e4,220],DS:[1e4,170],PL:[1e4,160],SPE:[1e4,150],TEC:[1e4,140],CAPOF:[1e4,80],GESTIONALE:[1e4,1],REPORTTRATT:[1e4,1,190,80,250]}),app.constant("colTypes",{ID:1,IDS:2,TITLE:3,DATE:4,CUSTOMER:5,RESOURCE:6,STATUS:7,STATUSSM:8,FAMILY:9,NUMBER:10,HOURS:11,COSTS:12,PERCENT:13,INCREMENT:14,ICON:15,BUTTONS:16,DISABLED:17,LINK:18,BOOL:19,DOUBLE:20,WEEKS:21}),app.controller("RootCtrl",["$scope","$location","$timeout","$http","$templateCache","$compile","$window","Appearance",function(t,e,n,a,r,s,i,o){t.appearance=o,t.stop=function(t){return t.stopImmediatePropagation(),!0},t.goBack=function(){i.history.back()}}]),app.controller("TableCtrl",["$scope",function(t){t.init=function(e){t.source=e,t.state=t.source.state,t.source.paging()}}]),app.controller("ReportCtrl",["$scope","$filter","$location","$http","$q","State","Utils","Appearance","DataFilter","DataSource","Columns","Range","ChartData","colTypes",function(t,e,n,a,r,s,i,o,c,u,l,h,f,p){function d(t,e,n){w.reset();var a=null;angular.forEach(t,function(t){var n=!0;angular.forEach(T,function(e){e.active&&(n=n&&e.filter(t))}),angular.forEach(C,function(e){e.active&&(n=n&&e.filter(t))}),n&&w.iterate(t,e)}),n&&(a=[],angular.forEach(n,function(t){var n=!0;angular.forEach(T,function(e){e.active&&(n=n&&e.filter(t))}),angular.forEach(C,function(e){e.active&&(n=n&&e.filter(t))}),n&&(a.push(t),w.compare(t,e))})),w.makeStatic(e)}function m(){return[{name:"region",value:"region",key:"region",type:p.TEXT,active:!0,hasSearch:!0,groupBy:!0},{name:"name",value:"name",key:"name",type:p.TEXT,active:!1,hasSearch:!0,groupBy:!0,radio:"country"},{name:"capital",value:"capital",key:"name",type:p.TEXT,active:!1,hasSearch:!0,groupBy:!0,radio:"country"},{name:"language",value:"languages[0].name",key:"languages[0].name",type:p.TEXT,active:!1,hasSearch:!0,groupBy:!0,radio:"country"},{name:"currency",value:"currencies[0].name",key:"currencies[0].name",type:p.TEXT,active:!1,hasSearch:!0,groupBy:!0,radio:"country"},{name:"alpha2Code",value:"alpha2Code",key:"name",type:p.TEXT,active:!1,hasSearch:!0,groupBy:!0,radio:"country"},{name:"lat",value:"latlng[0]",key:"name",type:p.NUMBER,active:!1,groupBy:!0,color:1},{name:"lng",value:"latlng[1]",key:"name",type:p.NUMBER,active:!1,groupBy:!0,color:1},{name:"area",value:"area",key:"name",type:p.NUMBER,active:!0,aggregate:!0,color:2},{name:"population",value:"population",key:"name",type:p.NUMBER,active:!0,aggregate:!0,color:3}]}var g=t.state=new s,v=t.tabs=[{id:2,name:"Colonne",template:"partials/report/filters/columns",icon:"icon-time"},{id:3,name:"Valori",template:"partials/report/filters/values",icon:"icon-time"},{id:4,name:"Opzioni",template:"partials/report/filters/flags",icon:"icon-time"}];v.show=!0,v.description="partials/report/description",v.id=2;var y=t.filters=new c,b=t.ranges=[(new h).currentQuarter().set(y),(new h).currentSemester(),(new h).currentYear()],w=t.cols=new l(m());w=t.cols=w.expand({dynamic:!0,compare:!1}),w.showReport=!0;var S,E=w.map(function(t){return{id:t.id,active:t.active}}),T=(t.colGroups=[{name:"GroupBy",cols:w.getGroups()}],t.valGroups=[{name:"Aggregate",cols:w.getAggregates()}],t.excludes=[]),C=t.includes=[],x=t.source=new u({unpaged:!0,uri:function(){return"api/restcountries.all.js"},filters:y,resolveItems:function(t,n,a){return console.log(t),angular.forEach(t,function(t,r){t.id=this.id;var s=new Date(t.created_at);a&&(s=new Date(s.setFullYear(s.getFullYear()+1))),t.dt=s,t.dt.setDate(1),t.dt.setHours(0,0,0,0),t.dt=t.dt.getTime(),t.month=e("date")(s,"(yyyy MM) MMMM"),t.monthShort=e("date")(s,"MMM yy"),n.push(t),this.id++},this),n},resolve:function(t){S=null,this.id=1,this.resolveItems(this.response.data,this.rows),t.resolve()},group:function(t){if(w.showComparison)if(S)d(this.rows,this.items,S),t.resolve();else{var e=new Date(y.dateFrom.getTime()),n=new Date(y.dateTo.getTime()),a={dateFrom:new Date(e.setFullYear(e.getFullYear()-1)),dateTo:new Date(n.setFullYear(n.getFullYear()-1))};Api.reports.negotiations(a).then(function(e){S=this.resolveItems(e,[],!0),d(this.rows,this.items,S),t.resolve()}.bind(this))}else d(this.rows,this.items),t.resolve()},search:function(t){},sort:function(t){}});t.setRangeDiff=function(t){angular.forEach(b,function(e){e.is(y)&&(e.setDiff(t),e.set(y,x))})},t.resetFilters=function(){angular.forEach(w,function(t,e){angular.forEach(E,function(e){t.id===e.id&&(angular.isFunction(t.active)?null:t.active=e.active)}),t.search=null}),w=t.cols=w.sort(function(t,e){return t.id-e.id}),x.update()},t.exclude=function(t){t.active=!t.active,x.update()},t.include=function(t){t.active=!t.active,x.update()},t.toggleCol=function(t){w.toggleColumns(t),x.update()},t.doFilter=function(t){return function(e){var n=!0;return angular.forEach(t,function(t){t.isActive()&&t.search&&0!==t.search.id&&(n=n&&t.getKey(e)===t.search.id)}.bind(this)),n}},t.doFilterMultiple=function(t){return function(e){var n=!0;return angular.forEach(t,function(t){t.isActive()&&t.search.length&&(n=n&&t.search.indexOf(t.getKey(e))!=-1)}.bind(this)),n}},t.doFilterColumns=function(t){return function(t){return t.isActive()}},t.doOrder=function(t){return function(e){return t.getSortKey(e)}},t.getRowClass=function(t){return""},t.onOpen=function(t){n.path("/trattative/"+t.id)},t.excel=function(t,e){console.log("excel",t,e);var n={name:"Report carichi di lavoro",description:"Report carichi di lavoro",columns:[],rows:[]};angular.forEach(t,function(t,e){n.columns.push({index:e,name:t.name,format:t.getFormat()})}),angular.forEach(e,function(e,a){var r=[];angular.forEach(t,function(t,n){switch(r[n]=t.getValue(e),t.type){case p.PERCENT:case p.INCREMENT:r[n]/=100}}),n.rows.push(r)});var a=[];angular.forEach(t,function(t,n){if(t.aggregate)switch(a[n]=t.getValueTotal(e),t.type){case p.PERCENT:case p.INCREMENT:a[n]/=100}else a[n]=null}),n.rows.push(a),Api.app.exportExcel(n).then(function(t){var e=t.headers(),n=new Blob([t.data],{type:e["content-type"]}),a=window.URL||window.webkitURL,r=a.createObjectURL(n),s=document.createElement("a");s.href=r;var i=/filename[^;=\n]*=((['"]).*?\2|[^;\n]*)/;s.download=i.exec(e["content-disposition"])[1],document.body.appendChild(s),s.click(),a.revokeObjectURL(n),s.remove()},function(t){g.error(t)})},t.$on("onDropItem",function(t,e){var n=w.indexOf(e.from.model),a=w.indexOf(e.to.model),r=w[n];w.splice(n,1),w.splice(a,0,r)}),t.$on("onDropOut",function(t,e){})}]);var aid=0;app.directive("controlRow",["$http","$templateCache","$compile","Utils",function(t,e,n,a){function r(t,e){var n=e.form||"Form",r=e.title||"Untitled",s=e.placeholder||r,i=r.replace(/[^0-9a-zA-Z]/g,"").split(" ").join("")+ ++aid,o=n+"."+i,c=' ng-focus="'+o+'.hasFocus=true" ng-blur="'+o+'.hasFocus=false"',u="",l="",h="",f=e.label?e.label:"name",p=e.key?e.key:"id",d=e.model,m=e.onChange?' ng-change="'+e.onChange+'"':"",g=e.cols?6:9,v="col-lg-"+g,y="col-lg-"+(12-g),b=e.required?' required="true"':"",w=e.readonly?" readonly":"",S=e.options?' ng-model-options="'+e.options+'" ':"",E=e.validate?' validate-type="'+e.validate+'" ':"",T=e.format?' format="'+e.format+'" ':"",C=e.precision?' precision="'+e.precision+'" ':"";switch(e.disabled&&(h=" disabled"),e.required&&(l=e.readonly||e.disabled?"":"<sup>✽</sup>"),u='<span ng-messages="'+(e.readonly?"":"("+n+".$submitted || "+o+".$touched) && ")+o+'.$error" role="alert">',u+='<span ng-message="required" class="label-error animated flash">obbligatorio ⤴</span>',e.controlRow){case"password":u+='<span ng-message="minlength" class="label-error animated flash">almeno 3 caratteri ⤴</span>';break;case"email":u+='<span ng-message="email" class="label-error animated flash">valore non corretto ⤴</span>';break;case"number":case"range":u+='<span ng-message="positive" class="label-error animated flash">solo valori positivi ⤴</span>',u+='<span ng-message="number" class="label-error animated flash">solo valori numerici ⤴</span>'}void 0!==e.match&&(u+='<span ng-message="match" class="label-error animated flash">non corrispondente ⤴</span>'),u+="</span>";var x=" ng-class=\"{ 'control-focus': "+o+".hasFocus, 'control-success': "+o+".$valid, 'control-error': "+o+".$invalid && ("+n+".$submitted || "+o+".$touched), 'control-empty': !"+o+'.$viewValue }"',k='<div class="row" '+x+'><label for="'+i+'" class="'+y+' col-form-label">'+r+l+'</label><div class="'+v+" col-"+e.controlRow+'">';switch(e.controlRow){case"static":var M=e.click?' ng-click="'+e.click+'"':"",$=e.mouseover?' ng-mouseover="'+e.mouseover+'"':"",O=e.mouseout?' ng-mouseover="'+e.mouseout+'"':"",A=e.icon?'<i class="pull-xs-right '+e.icon+'"></i>':"";k+='<p class="form-control" '+M+$+O+'><span ng-bind-html="'+d+" || '&nbsp;'\"></span>"+A+"</p>";break;case"checkbox":k='<div class="'+v+'"'+x+'><div class="col-xs-12"><label class="custom-control custom-checkbox">',k+='   <input type="checkbox" class="custom-control-input" ng-model="'+d+'">',k+='   <span class="custom-control-indicator"></span>',k+='   <span class="custom-control-description">'+r+"</span>",k+="</label>";break;case"yesno":k='<div class="row" '+x+'><label class="col-lg-6 custom-control custom-checkbox">'+r+l+"</label>",k+='<div class="'+y+'"><label class="custom-control custom-checkbox">',k+='   <input type="checkbox" class="custom-control-input" ng-model="'+d+'" ng-change="'+d+"No=!"+d+'">',k+='   <span class="custom-control-indicator"></span>',k+='   <span class="custom-control-description">Sì</span>',k+="</label></div>",k+='<div class="'+y+'"><label class="custom-control custom-checkbox">',k+='   <input type="checkbox" class="custom-control-input" ng-model="'+d+'No" ng-change="'+d+"=!"+d+'No">',k+='   <span class="custom-control-indicator"></span>',k+='   <span class="custom-control-description">No</span>',k+="</label>";break;case"switch":k='<div class="row control-switch" '+x+'><label for="'+i+'" class="'+y+' col-form-label">'+r+l+"</label>",k+='<div class="'+v+'">',k+='<switch name="'+i+'" ng-model="'+d+'" '+m+S+' on="Sì" off="No" '+b+h+w+c+"></switch>";break;case"range":E=' validate-type="number"';var N=i+"Hi",R=n+"."+N,D=e.modelHi,U=" ng-class=\"{ 'control-focus': "+R+".hasFocus, 'control-success': "+R+".$valid, 'control-error': "+R+".$invalid && ("+n+".$submitted || "+R+".$touched), 'control-empty': !"+R+'.$viewValue }"',F=b;"true"==e.requiredHi?F=' required="true"':"false"==e.requiredHi&&(F="");var I=" ",P=" ";switch(e.required&&"false"!==e.requiredHi&&(P=e.readonly||e.disabled?"":"<sup>✽</sup>"),I='<span ng-messages="'+(e.readonly?"":"("+n+".$submitted || "+R+".$touched) && ")+R+'.$error" role="alert">',I+='<span ng-message="required" class="label-error animated flash">obbligatorio ⤴</span>',e.controlRow){case"password":I+='<span ng-message="minlength" class="label-error animated flash">almeno 3 caratteri ⤴</span>';break;case"email":I+='<span ng-message="email" class="label-error animated flash">valore non corretto ⤴</span>';break;case"number":case"range":I+='<span ng-message="positive" class="label-error animated flash">solo valori positivi ⤴</span>',I+='<span ng-message="number" class="label-error animated flash">solo valori numerici ⤴</span>'}return void 0!==e.match&&(I+='<span ng-message="match" class="label-error animated flash">non corrispondente ⤴</span>'),I+="</span>",k='<div class="row"><label for="'+i+'" class="'+y+' col-form-label">'+r+'</label><div class="'+v+" col-"+e.controlRow+'">',k+='<div class="form-control-range form-control-range-min" '+x+">"+l+'<input class="form-control" name="'+i+'" ng-model="'+d+'" '+m+S+' placeholder="'+s+'" type="text"'+b+h+w+c+E+T+C+">"+u+"</div>",k+='<div class="form-control-range form-control-range-max" '+U+">"+P+'<input class="form-control" name="'+N+'" ng-model="'+D+'" '+m+S+' placeholder="'+s+'" type="text"'+F+h+w+c+E+T+C+">"+I+"</div>",k+"</div></div>";case"range-slider":var L=e.himodel?' rz-slider-high="'+e.himodel+'" ':"";S=e.options?' rz-slider-options="'+e.options+'" ':"",k+='<rzslider rz-slider-model="'+d+'" '+L+S+'"></rzslider>';break;case"select":var B=e.min?" | filter:gte('"+p+"', "+e.min+")":"",_=a.format(f,"item.",!0),S=e.number?"item."+p+" as "+_+" disable when item.disabled for item in "+e.source+B:_+" disable when item.disabled for item in "+e.source+B+" track by item."+p;k+='<select name="'+i+'" class="form-control" ng-model="'+d+'" '+m+' ng-options="'+S+'" '+(e.number?"convert-to-number":"")+b+'><option value="" disabled selected hidden>'+s+"</option></select>";break;case"autocomplete":var z=!!e.canCreate&&e.canCreate,q=!!e.flatten&&e.flatten,H=!!e.queryable&&e.queryable,j=e.onSelected?' on-selected="'+e.onSelected+'"':"";k+='<input name="'+i+'" ng-model="'+d+'" type="hidden" '+(e.required?"required":"")+">",k+='<div control-autocomplete="'+e.source+'" model="'+d+'" label="'+f+'"  key="'+p+'" can-create="'+z+'" flatten="'+q+'" queryable="'+H+'" placeholder="'+s+'" on-focus="'+o+'.hasFocus=true" on-blur="'+o+'.hasFocus=false"'+j+"></div>";break;case"textarea":var V=e.rows?e.rows:"1";k+='<textarea name="'+i+'" class="form-control" ng-model="'+d+'" '+m+S+' placeholder="'+s+'" '+b+h+' rows="'+V+'"'+c+"></textarea>";break;case"htmltext":k+='<div text-angular name="'+i+'" ng-model="'+d+'" '+m+S+' placeholder="'+s+'" '+b+h+w+c+(e.required?' ta-min-text="1"':"")+"></div>";break;case"password":k+='<input name="'+i+'" class="form-control" ng-model="'+d+'" '+m+S+' placeholder="'+s+'" type="password" ng-minlength="2" '+b+h+c+">";break;case"email":k+='<input name="'+i+'" class="form-control" ng-model="'+d+'" '+m+S+' placeholder="'+s+'" type="email" '+b+h+c+">";break;case"number":E=' validate-type="number"',k+='<input name="'+i+'" class="form-control" ng-model="'+d+'" '+m+S+' placeholder="'+s+'" type="text"'+b+h+w+c+E+T+C+">";break;case"date":E=' validate-type="date"',T=' format="dd-MM-yyyy"',e.disabled||e.readonly?k+='<div class="input-group"><input type="text" class="form-control" name="'+i+'" ng-model="'+d+'" placeholder="'+s+'" '+b+h+w+c+E+T+'><span class="input-group-addon"><i class="icon-calendar"></i></span></div>':(k+='<input type="date" name="'+i+'" class="form-control form-control-hidden" is-open="flags.'+i+'" ng-model="'+d+'" placeholder="dd-MM-yyyy" '+b+h+w+c+' uib-datepicker-popup datepicker-options="sources.datepickerOptions" datepicker-template-url="uib/template/datepicker/datepicker.html" show-button-bar="false" current-text="Oggi" clear-text="Rimuovi" close-text="Chiudi">',k+='<div ng-click="(flags.'+i+' = true)" class="input-group disabled"><input type="text" class="form-control" name="'+i+'" ng-model="'+d+'" placeholder="'+s+'" '+b+h+w+c+E+T+'><span class="input-group-addon"><i class="icon-calendar"></i></span></div>');break;case"datetime-local":s=s||"dd-MM-yyyyTHH:mm:ss",k+='<input name="'+i+'" class="form-control" ng-model="'+d+'" '+m+S+' placeholder="'+s+'" type="datetime-local"'+b+h+w+c+">";break;case"text":default:k+='<input name="'+i+'" class="form-control" ng-model="'+d+'" '+m+S+' placeholder="'+s+'" type="text"'+b+h+w+c+E+T+C+">"}return k+u+"</div></div>"}return{restrict:"A",replace:!0,compile:function(t,e){return function(a,s,i){s.html(r(t,e)),n(s.contents())(a)}}}}]),app.directive("control",[function(){return{restrict:"A",replace:!0,template:function(t,e){var n=e.form||"Form",a=e.title||"Untitled",r=e.placeholder||a,s=a.replace(/[^0-9a-zA-Z]/g,"").split(" ").join("")+ ++aid,i=s,o=' ng-focus="'+i+'.hasFocus=true" ng-blur="'+i+'.hasFocus=false"',c="",u="",l="",h=e.label?e.label:"name",f=e.key?e.key:"id",p=e.model,d=e.onChange?' ng-change="'+e.onChange+'"':"",m=e.required?' required="true"':"",g=e.readonly?" readonly":"",v=e.options?' ng-model-options="'+e.options+'" ':"",y=e.validate?' validate-type="'+e.validate+'" ':"";if(e.required){switch(u=e.readonly||e.disabled?"":"<sup>✽</sup>",c='<span ng-messages="'+(e.readonly?"":"("+n+".$submitted || "+i+".$dirty) && ")+i+'.$error" role="alert"><span ng-message="required" class="label-error animated flash"> ⤴ required</span>',e.control){case"password":c+='<span ng-message="minlength" class="label-error animated flash"> ⤴ at least 3 chars</span>';break;case"email":c+='<span ng-message="email" class="label-error animated flash"> ⤴ incorrect</span>';break;case"number":c+='<span ng-message="number" class="label-error animated flash"> ⤴ enter a valid number</span>',c+='<span ng-message="number" class="label-error animated flash"> ⤴ enter a positive number</span>'}void 0!==e.match&&(c+='<span ng-message="match" class="label-error animated flash"> ⤴ not matching</span>'),c+="</span>"}else c=" ";e.disabled&&(l=" disabled");var b='<ng-form name="'+s+"\" ng-class=\"{ 'control-focus': "+i+'.hasFocus }"><label for="'+s+'" class="control-label"><span class="control-title">'+a+"</span>"+u+" "+c+"</label>";switch(e.control){case"checkbox":b='<ng-form name="'+s+'" class="checkbox">',b+='<span class="checkbox-label"><span class="control-title">'+a+"</span>"+u+" "+c+"</span>",b+='<span class="switch"><input id="'+s+'" name="'+s+'" type="checkbox" ng-model="'+p+'" '+d+m+' class="toggle toggle-round-flat"><label for="'+s+'"></label></span>',b+="</div>";break;case"select":var w=e.min?" | filter:gte('"+f+"', "+e.min+")":"",v=e.number?"item."+f+" as item."+h+" for item in "+e.source+w:"item."+h+" for item in "+e.source+w+" track by item."+f;b+='<select name="'+s+'" class="form-control" ng-model="'+p+'" '+d+' ng-options="'+v+'" '+(e.number?"convert-to-number":"")+m+'><option value="" disabled selected hidden>'+r+"</option></select>";break;case"autocomplete":var S=!!e.canCreate&&e.canCreate,E=!!e.flatten&&e.flatten,T=!!e.queryable&&e.queryable,C=e.onSelected?' on-selected="'+e.onSelected+'"':"";b+='<input name="'+s+'" ng-model="'+p+'" '+d+' type="hidden" '+m+l+">",b+='<div control-autocomplete="'+e.source+'" model="'+p+'" label="'+h+'"  key="'+f+'" can-create="'+S+'" flatten="'+E+'" queryable="'+T+'" placeholder="'+r+'" on-focus="'+i+'.hasFocus=true" on-blur="'+i+'.hasFocus=false"'+C+"></div>";break;case"textarea":var x=e.rows?e.rows:"1";b+='<textarea name="'+s+'" class="form-control" ng-model="'+p+'" '+d+v+' placeholder="'+r+'" '+m+l+' rows="'+x+'"'+o+"></textarea>";break;case"datetime-local":r==a?r="yyyy-MM-ddTHH:mm:ss":null,b+='<input name="'+s+'" class="form-control" ng-model="'+p+'" '+d+v+' placeholder="'+r+'" type="datetime-local"'+m+g+o+">";break;case"password":b+='<input name="'+s+'" class="form-control" ng-model="'+p+'" '+d+v+' placeholder="'+r+'" type="password" ng-minlength="2" '+m+l+o+">";break;case"email":b+='<input name="'+s+'" class="form-control" ng-model="'+p+'" '+d+v+' placeholder="'+r+'" type="email" '+m+l+o+">";break;case"number":y=' validate-type="number"',b+='<input name="'+s+'" class="form-control" ng-model="'+p+'" '+d+v+' placeholder="'+r+'" type="text"'+m+l+g+o+' validate-type="number">';break;case"text":default:var k="";b+='<input name="'+s+'" '+k+' class="form-control" ng-model="'+p+'" '+d+v+' placeholder="'+r+'" type="text"'+m+l+g+o+">"}return b+"</ng-form>"},link:function(t,e,n,a){}}}]),app.directive("validateType",["$filter",function(t){return{require:"ngModel",link:function(e,n,a,r){function s(){p=!0,h&&(n[0].value=r.$modelValue||null,r.$modelValue||r.$setViewValue(null))}function i(){if(h&&!r.$invalid)switch(l){case"date":case"datetime":case"datetime-local":n[0].value=r.$modelValue?t("date")(r.$modelValue,h):" ";break;default:n[0].value=r.$modelValue?t("number")(r.$modelValue,f)+" "+h:" "}}function o(){p=!1,i()}function c(){n.on("focus",s),n.on("blur",o)}function u(){n.off("focus",s),n.off("blur",o)}var l=a.validateType,h=a.format||"",f=a.precision||2,p=!1;switch(l){case"date":case"datetime":case"datetime-local":r.$formatters.push(function(e){return e?t("date")(e,h):null});break;case"number":r.$parsers.unshift(function(t){var e=!1;return void 0!==t&&""!==t?(e=String(t).indexOf(Number(t).toString())!==-1,t=Number(t),r.$setValidity("number",e),e&&(r.$setValidity("positive",t>=.01),void 0!==a.min?r.$setValidity("range",t>=Number(a.min)):null,void 0!==a.max?r.$setValidity("range",t<=Number(a.max)):null)):(e=!0,t=Number(t),r.$setValidity("number",!0),r.$setValidity("positive",!0),void 0!==a.min?r.$setValidity("range",!0):null,void 0!==a.max?r.$setValidity("range",!0):null),t}),r.$formatters.push(function(e){return e?t("number")(e,f)+" "+h:null})}e.$on("$destroy",function(){u()}),c()}}}]),app.directive("dropdown",["$window","Utils",function(t,e){return{restrict:"C",link:function(n,a,r,s){function i(t){a.toggleClass("open"),f.setAttribute("aria-expanded",a.hasClass("open").toString()),c()}function o(t){return!!e.getClosest(t.target,".dropdown")||(a.removeClass("open"),f.setAttribute("aria-expanded",a.hasClass("open").toString()),u(),void 0)}function c(){angular.element(t).on("touchend mouseup",o)}function u(){angular.element(t).off("touchend mouseup",o)}function l(){angular.element(f).on("touchstart mousedown",i)}function h(){angular.element(f).off("touchstart mousedown",i)}var f=a[0].querySelector(".dropdown-toggle");a.hasClass("open");n.$on("$destroy",function(){h(),u()}),l()}}}]),app.directive("dropup",["$window","Utils",function(t,e){return{restrict:"C",link:function(n,a,r,s){function i(t){a.toggleClass("open"),l.setAttribute("aria-expanded",a.hasClass("open").toString())}function o(t){return!!e.getClosest(t.target,".dropdown")||(a.removeClass("open"),void l.setAttribute("aria-expanded",a.hasClass("open").toString()))}function c(){angular.element(l).on("touchstart mousedown",i),angular.element(t).on("touchend mouseup",o)}function u(){angular.element(l).off("touchstart mousedown",i),angular.element(t).off("touchend mouseup",o)}var l=a[0].querySelector(".dropdown-toggle");a.hasClass("open");n.$on("$destroy",function(){u()}),c()}}}]),app.directive("toggle",["$window","$document","$timeout","Utils","Style",function(t,e,n,a,r){var s=[];return{restrict:"A",link:function(e,n,i,o){function c(){var t=angular.element(g);if(!t.hasClass("in")){if(t.removeClass("collapse"),g){var a=g.offsetHeight;v.height="0px",v.set(g),t.removeClass("collapse").addClass("collapsing"),g.setAttribute("aria-expanded",!0),n.removeClass("collapsed"),n[0].setAttribute("aria-expanded",!0),setTimeout(function(){v.height=a+"px",v.set(g),setTimeout(function(){t.removeClass("collapsing").addClass("collapse").addClass("in"),g.style.height="auto"},500)},1),e.$broadcast("onToggled",g)}f()}}function u(){var t=angular.element(g);if(t.hasClass("in")){var e=g?g.offsetHeight:0;v.height=e+"px",v.set(g),t.addClass("collapsing").removeClass("collapse").removeClass("in"),g.setAttribute("aria-expanded",!1),n.addClass("collapsed"),n[0].setAttribute("aria-expanded",!1),setTimeout(function(){v.height="0px",v.set(g),setTimeout(function(){t.removeClass("collapsing").addClass("collapse"),g.style.height="auto"},500)},1),p()}}function l(t){angular.element(g).hasClass("in")?u():c()}function h(t){return!!a.getClosest(t.target,i.target)||void u()}function f(){angular.element(t).on("touchend mouseup",h)}function p(){angular.element(t).off("touchend mouseup",h)}function d(){n.on("touchstart mousedown",l)}function m(){n.off("touchstart mousedown",l)}if(i.target){var g,v=new r;e.$on("onToggled",function(t,e){g!==e&&u()}),e.$on("$destroy",function(){var t=s.indexOf(g);t!==-1&&s.splice(t,1),m(),p()}),setTimeout(function(){g=document.querySelector(i.target),s.push(g),d()})}}}}]),app.directive("toggleEnter",["$window","$document","$timeout","Utils","Style",function(t,e,n,a,r){var s=[];return{restrict:"A",link:function(e,n,i,o){function c(){var t=angular.element(v);if(!t.hasClass("in")){if(y?clearTimeout(y):null,t.removeClass("collapse"),v){var a=v.offsetHeight;b.height="0px",b.set(v),t.removeClass("collapse").addClass("collapsing"),v.setAttribute("aria-expanded",!0),n.removeClass("collapsed"),n[0].setAttribute("aria-expanded",!0),y=setTimeout(function(){b.height=a+"px",b.set(v),y=setTimeout(function(){t.removeClass("collapsing").addClass("collapse").addClass("in"),v.style.height="auto"},500)},1),e.$broadcast("onToggleEntered",v)}p()}}function u(){var t=angular.element(v);t.hasClass("in")&&(y?clearTimeout(y):null,y=setTimeout(function(){var e=v?v.offsetHeight:0;b.height=e+"px",b.set(v),t.addClass("collapsing").removeClass("collapse").removeClass("in"),v.setAttribute("aria-expanded",!1),n.addClass("collapsed"),n[0].setAttribute("aria-expanded",!1),y=setTimeout(function(){b.height="0px",b.set(v),y=setTimeout(function(){t.removeClass("collapsing").addClass("collapse"),v.style.height="auto"},125)},1),d()},500))}function l(t){angular.element(v).hasClass("collapsing")||c()}function h(t){return!!a.getClosest(t.toElement,i.target)||void u()}function f(t){return!!a.getClosestElement(t.target,n[0])||(!!a.getClosest(t.target,i.target)||void u())}function p(){i.toggleLeave?(n.on("mouseleave",h),angular.element(v).on("mouseleave",h)):angular.element(t).on("click",f)}function d(){i.toggleLeave?(n.off("mouseleave",h),angular.element(v).off("mouseleave",h)):angular.element(t).off("click",f)}function m(){n.on("mouseenter",l)}function g(){n.off("mouseenter",l)}if(i.target){var v,y,b=new r;e.$on("onToggleEntered",function(t,e){v!==e&&(console.log("toggleEnter.onToggleEntered"),u())}),e.$on("$destroy",function(){var t=s.indexOf(v);t!==-1&&s.splice(t,1),g(),d()}),setTimeout(function(){v=document.querySelector(i.target),s.push(v),m()})}}}}]),app.directive("state",["$timeout",function(t){return{restrict:"EA",template:'<button type="button" class="btn btn-sm btn-primary btn-block-md-down" ng-class="stateClass()" ng-disabled="stateDisabled()"><span ng-transclude></span></button>',transclude:!0,replace:!0,scope:{state:"="},link:function(e,n,a,r){function s(){t(function(){return e.$parent.$eval(a.onValidate)?void e.$parent.$eval("form.$setSubmitted()"):(console.log("state.onClick",a.onValidate,a.onClick),e.state.button=n,e.$parent.$eval(a.onClick))})}function i(){n.on("touchstart click",s)}function o(){n.off("touchstart click",s)}e.stateClass=function(){if(e.state.button===n){var t={busy:e.state.isBusy,successing:e.state.isSuccessing,success:e.state.isSuccess,errorring:e.state.isErroring,error:e.state.isError};return t}return null},e.stateDisabled=function(){var t=e.state.button&&e.state.button!==n;return t},e.$on("$destroy",function(){o()}),i()}}}]),app.directive("sortable",["$timeout",function(t){return{restrict:"A",scope:{source:"=sortable",key:"@sortableKey",sort:"=?"},template:"<th ng-class=\"{ 'sorted-up': sort == 1, 'sorted-down': sort == -1 }\" ng-transclude></th>",transclude:!0,replace:!0,link:function(t,e,n,a){function r(){t.sort=t.source.getSort(t.key)}function s(){if(t.source.state.enabled()){var e=t.sort?t.sort*-1:1;t.source.setSort(t.key,e).then(function(n){t.sort=e})}}function i(){e.on("touchstart click",s)}function o(){e.off("touchstart click",s)}t.sort=t.sort||0,t.$watchCollection("source.filters.sort",r),r(),t.$on("$destroy",function(){o()}),i()}}}]),app.directive("draggableItem",["$parse","$timeout","Utils","Style","ElementRect","Droppables",function(t,e,n,a,r,s){return{require:"ngModel",link:function(i,o,c,u){function l(t){return C(i)&&(v=n.getTouch(t),p()),!1}function h(t){return y=n.getTouch(t),b=v.difference(y),!w&&b.power()>25&&(w=!0,o.addClass("dragging")),w&&(k.transform="translateX("+b.x+"px) translateY("+b.y+"px)",k.set(x),M.set(E).offset(b),S=s.getIntersections(M),S.length&&angular.element(S[0].native).addClass("dropping")),!1}function f(n){if(w){w=!1,o.removeClass("dragging"),k.transform="none",k.set(x);var a=t(c.droppableIndex)(i),r=t(c.ngModel)(i);if(S.length){var s=null;angular.forEach(S,function(t,n){angular.element(t.native).removeClass("dropping over"),t.data.droppable(i)&&!s&&(s={from:{index:a,model:r,target:x},to:{index:t.data.index,model:t.data.model,target:t.native}},e(function(){i.$emit("onDropItem",s)}))})}else{var s={from:{index:a,model:r,target:x},to:null};e(function(){i.$emit("onDropOut",s)})}}return d(),!1}function p(){angular.element(window).on("touchmove mousemove",h),angular.element(window).on("touchend mouseup",f)}function d(){angular.element(window).off("touchmove mousemove",h),angular.element(window).off("touchend mouseup",f)}function m(){o.on("touchstart mousedown",l)}function g(){o.off("touchstart mousedown",l)}var v,y,b,w,S,E=o[0],T=c.draggableItem||".item",C=void 0!==c.draggableIf?t(c.draggableIf):function(){return!0},x=E.querySelector(T),k=new a,M=new r;i.$on("$destroy",function(){g()}),m()}}}]),app.directive("droppableItem",["$parse","Utils","Style","Droppables",function(t,e,n,a){return{require:"ngModel",link:function(e,n,r,s){function i(){var n=t(r.droppableIndex)(e),a=t(r.ngModel)(e),s=void 0!==r.droppableIf?t(r.droppableIf):function(){return!0};return{index:n,model:a,droppable:s}}var o=n[0];r.droppableItem||".item";a.add(o,i),e.$on("$destroy",function(){a.remove(o)})}}}]),app.directive("linkTo",["$parse","$timeout","$location",function(t,e,n){return{link:function(a,r,s,i){function o(){var e=t(s.linkTo)(a);e&&(r.attr("href",e.href),r.attr("target",e.target))}function c(i){var o=t(s.linkTo)(a);if(o)return r.attr("href",o.href),r.attr("target",o.target),"_blank"===o.target?window.open(o.href,"_blank"):e(function(){var t=o.href.split(window.domain).join("");n.path(t)}),i.stopImmediatePropagation(),i.preventDefault(),!1}function u(){r.on(h.tap,c)}function l(){r.off(h.tap,c)}if(s.linkTo){var h={tap:"click"};a.$on("$destroy",function(){l()}),u(),e(o)}}}}]),app.directive("pop",["$parse","$templateRequest","$compile","$controller","$window","$document","$timeout","Utils","Style",function(t,e,n,a,r,s,i,o,c){return{restrict:"A",link:function(n,a,c,u){function l(){var t=void 0!==window.pageXOffset,e="CSS1Compat"===(document.compatMode||""),n=t?window.pageXOffset:e?document.documentElement.scrollLeft:document.body.scrollLeft,a=t?window.pageYOffset:e?document.documentElement.scrollTop:document.body.scrollTop;return{x:n,y:a}}function h(){if(!b.native){var a=angular.copy(t(c.pop)(n));if(a&&void 0!=a){a.onClose=function(){d(),b.element.remove(),b.native=b.element=v=null},b.native=document.createElement("div"),b.element=angular.element(b.native),b.element.addClass("pop");var r=s.find("body").eq(0);r.append(b.element),a.template?e(a.template).then(function(t){o.compileController(n,b.element,t,a)}):o.compileController(n,b.element,"<div>pop</div>",a),n.$emit("onPopUp",b.native),i(function(){p()},1e3)}}}function f(t){return!!o.getClosest(t.target,".pop")||void(b.native&&(d(),b.element.remove(),b.native=b.element=v=null))}function p(){
angular.element(r).on("click",f)}function d(){angular.element(r).off("click",f)}function m(){a.on("click",h)}function g(){a.off("click",h)}var v,y=a[0],b={target:null,element:null,native:null};n.$watch(function(){return b.element?b.element[0].offsetHeight:0},function(t,e){if(t!==e&&b.element){var n=y.getBoundingClientRect(),a=l(),r=Math.max(80,n.top+a.y-t);b.element.attr("style","top:"+r+"px")}}),n.$on("onPopUp",function(t,e){b.native!==e&&f()}),n.$on("$destroy",function(){g()}),m()}}}]),app.directive("onClickOut",["$document","$parse","$timeout","Utils",function(t,e,n,a){return{restrict:"A",link:function(r,s,i,o){function c(t){null===a.getClosestElement(t.target,s[0])&&n(function(){console.log("onClickOut",i.onClickOut,r.cols.showValues);var t=e(i.onClickOut);t(r)})}function u(){angular.element(t).on("click",c)}function l(){angular.element(t).off("click",c)}r.$on("$destroy",function(){l()}),u()}}}]),app.directive("toggler",["$document","$parse","$timeout","Utils",function(t,e,n,a){return{restrict:"A",link:function(r,s,i,o){function c(){return e(i.toggler+"=="+i.value)(r)}function u(){p(),n(function(){e(i.toggler+"="+i.value)(r)})}function l(){d(),n(function(){e(i.toggler+"=null")(r)})}function h(t){setTimeout(function(){c()?l():u()},100)}function f(t){c()&&null===a.getClosestElement(t.target,s[0])&&null===a.getClosest(t.target,i.target)&&l()}function p(){angular.element(t).on("click",f)}function d(){angular.element(t).off("click",f)}function m(){s.on("click",h)}function g(){s.off("click",h)}if(void 0===i.value)throw new Error("[toggler] attribute value required");if(void 0===i.target)throw new Error("[toggler] attribute target required");r.$on("$destroy",function(){g(),d()}),m()}}}]),app.filter("shortName",["$filter",function(t){function e(t){return t.replace(/\w\S*/g,function(t){return t.charAt(0).toUpperCase()+t.substr(1).toLowerCase()})}return function(t){if(!t)return"";t.indexOf(" .")===t.length-2&&(t=t.split(" .").join(""));var n=t.split(" "),a=n.shift();if(n.length){var r=n.join(" ");return a.substr(0,1).toUpperCase()+"."+e(r)}return a}}]),app.filter("customCurrency",["$filter",function(t){var e=t("currency");return function(t,n){return e(t*n.ratio,n.formatting)}}]),app.filter("customNumber",["$filter",function(t){var e=t("number");return function(t,n,a){return a=a||"",t?e(t,n)+a:"-"}}]),app.filter("customHours",[function(){return function(t){if(t){var e=Math.floor(t),n=Math.floor(60*(t-e)),a=e?e+" H":"";return a+=n?" "+n+" m":""}return"-"}}]),app.filter("customDate",["$filter",function(t){var e=t("date");return function(t,n,a){return t?e(t,n,a):"-"}}]),app.filter("customTime",["$filter",function(t){return function(t,e){return t?Utils.parseTime(t):e?e:"-"}}]),app.filter("customDigital",["$filter",function(t){return function(t,e){return t?Utils.parseHour(t):e?e:"-"}}]),app.filter("customString",["$filter",function(t){return function(t,e){return t?t:e?e:"-"}}]),app.filter("customEnum",function(){return function(t){return t+=1,t<10?"0"+t:t}}),app.filter("groupBy",["$parse","filterWatcher",function(t,e){function n(t,e){var n,a={};return angular.forEach(t,function(t){n=e(t),a[n]||(a[n]=[]),a[n].push(t)}),a}return function(a,r){return!angular.isObject(a)||angular.isUndefined(r)?a:e.isMemoized("groupBy",arguments)||e.memoize("groupBy",arguments,this,n(a,t(r)))}}]),app.provider("filterWatcher",function(){function t(t){return null===t}function e(t){return t&&t.$evalAsync&&t.$watch}this.$get=["$window","$rootScope",function(n,a){function r(a,r){function s(){var a=[];return function(r,s){if(angular.isObject(s)&&!t(s)){if(~a.indexOf(s))return"[Circular]";a.push(s)}return n==s?"$WINDOW":n.document==s?"$DOCUMENT":e(s)?"$SCOPE":s}}return[a,JSON.stringify(r,s())].join("#").replace(/"/g,"")}function s(t){var e=t.targetScope.$id;angular.forEach(h[e],function(t){delete l[t]}),delete h[e]}function i(){f(function(){a.$$phase||(l={})},2e3)}function o(t,e){var n=t.$id;return angular.isUndefined(h[n])&&(t.$on("$destroy",s),h[n]=[]),h[n].push(e)}function c(t,e){var n=r(t,e);return l[n]}function u(t,n,a,s){var c=r(t,n);return l[c]=s,e(a)?o(a,c):i(),s}var l={},h={},f=n.setTimeout;return{isMemoized:c,memoize:u}}]}),app.factory("Range",["$filter",function(t){function e(t){this.type=e.types.QUARTER,t?angular.extend(this,t):null}return e.prototype={currentQuarter:function(){return this.diff=0,this.setQuarter()},currentSemester:function(){return this.diff=0,this.setSemester()},currentYear:function(){return this.diff=0,this.setYear()},setQuarter:function(){this.type=e.types.QUARTER;var t=new Date;t.setMonth(t.getMonth()+3*this.diff);var n=t.getFullYear(),a=Math.floor(t.getMonth()/3);return this.from=new Date(n,3*a,1),this.to=new Date(n,3*a+3,0),this},setSemester:function(){this.type=e.types.SEMESTER;var t=new Date;t.setMonth(t.getMonth()+6*this.diff);var n=t.getFullYear(),a=Math.floor(t.getMonth()/6);return this.from=new Date(n,6*a,1),this.to=new Date(n,6*a+6,0),this},setYear:function(){this.type=e.types.YEAR;var t=new Date;t.setMonth(t.getMonth()+12*this.diff);var n=t.getFullYear();return this.from=new Date(n,0,1),this.to=new Date(n,12,0),this},getName:function(){switch(this.type){case e.types.QUARTER:return"Trimestre "+t("date")(this.from,"MMM")+"-"+t("date")(this.to,"MMM")+" "+t("date")(this.from,"yyyy");case e.types.SEMESTER:return"Semestre "+t("date")(this.from,"MMM")+"-"+t("date")(this.to,"MMM")+" "+t("date")(this.from,"yyyy");case e.types.YEAR:return"Anno "+t("date")(this.from,"yyyy")}},setDiff:function(t){switch(this.diff+=t,this.type){case e.types.QUARTER:return this.setQuarter();case e.types.SEMESTER:return this.setSemester();case e.types.YEAR:return this.setYear()}},set:function(t,e){return t.dateFrom=this.from,t.dateTo=this.to,e?e.setDates(t.dateFrom,t.dateTo):null,this},is:function(t){return t.dateFrom.getTime()==this.from.getTime()&&t.dateTo.getTime()==this.to.getTime()}},e.types={QUARTER:1,SEMESTER:2,YEAR:3},e}]),app.factory("Base",[function(){function t(){}return t.prototype={$$super:null,$super:{},$ctor:function(){this.$$super.apply(this,[].splice.call(arguments,0))}},t.extend=function(t){if(!t||!t.constructor)throw"Base.extend.error: please pass an object with constructor eg. { constructor: function myFunc() {...} }";var e=t.constructor,n=t.methods||{};return angular.extend(e,this),e.prototype=angular.extend(Object.create(this.prototype),n),e.prototype.constructor=e,e.prototype.$$super=this,e.prototype.$super={},angular.forEach(this.prototype,function(t,n){e.prototype.$super[n]=function(e){t.apply(e,[].splice.call(arguments,1))}}),e},t.prototype.constructor=t,t}]),app.factory("Point",["Base",function(t){var e=t.extend({constructor:function(t,e,n){this.x=t||0,this.y=e||0,this.radius=n||100},methods:{move:function(t,e,n,a){var r=this.radius*(1+a);this.x=e/2+r*Math.sin(t),this.y=n/2+r*Math.cos(t)},draw:function(t){t.fillStyle="white",t.fillRect(this.x,this.y,4,4)}}});return e}]),app.factory("Vector",function(){function t(t,e){this.x=t||0,this.y=e||0}return t.make=function(e,n){return new t(n.x-e.x,n.y-e.y)},t.size=function(t){return Math.sqrt(t.x*t.x+t.y*t.y)},t.normalize=function(e){var n=t.size(e);return e.x/=n,e.y/=n,e},t.incidence=function(t,e){var n=Math.atan2(e.y,e.x)-Math.atan2(t.y,t.x);return n},t.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},t.cross=function(t,e){return t.x*e.y-t.y*e.x},t.difference=function(e,n){return new t(n.x-e.x,n.y-e.y)},t.power=function(t,e){var n=Math.abs(e.x-t.x),a=Math.abs(e.y-t.y);return(n+a)/2},t.prototype={size:function(){return t.size(this)},normalize:function(){return t.normalize(this)},incidence:function(e){return t.incidence(this,e)},cross:function(e){return t.cross(this,e)},distance:function(e){return t.distance(this,e)},difference:function(e){return t.difference(this,e)},power:function(){return(Math.abs(this.x)+Math.abs(this.y))/2},towards:function(t,e){return e=e||.125,this.x+=(t.x-this.x)*e,this.y+=(t.y-this.y)*e,this},add:function(t){return this.x+=t.x,this.y+=t.y,this},friction:function(t){return this.x*=t,this.y*=t,this},copy:function(e){return new t(this.x,this.y)},toString:function(){return"{"+this.x+","+this.y+"}"}},t}),app.factory("ElementRect",["Vector",function(t){function e(){this.x=0,this.y=0,this.width=0,this.height=0,this.center=new t}return e.fromNative=function(t){return(new e).set(t)},e.prototype={set:function(t){var e=t.getBoundingClientRect();return this.x=e.left,this.y=e.top,this.width=t.offsetWidth,this.height=t.offsetHeight,this.center.x=this.x+this.width/2,this.center.y=this.y+this.height/2,this.native=t,this},offset:function(t){return this.x+=t.x,this.y+=t.y,this.center.x=this.x+this.width/2,this.center.y=this.y+this.height/2,this},intersect:function(t){return!(t.x>this.x+this.width||t.x+t.width<this.x||t.y>this.y+this.height||t.y+t.height<this.y)},toString:function(){return"{"+this.x+","+this.y+","+this.width+","+this.height+"}"}},e}]),app.factory("Style",function(){function t(){this.props={scale:1,hoverScale:1,currentScale:1}}var e=function(){var t="transform",n="webkitTransform",a=document.createElement("DIV");return"undefined"!=typeof a.style[t]?["webkit","moz","o","ms"].every(function(t){var n="-"+t+"-transform";return"undefined"==typeof a.style[n]||(e=n,!1)}):e="undefined"!=typeof a.style[n]?"-webkit-transform":void 0,e}();return t.prototype={set:function(t){var e=[];angular.forEach(this,function(t,n){"props"!==n&&e.push(n+":"+t)}),t.style.cssText=e.join(";")+";"},transform:function(t){this[e]=t},transformOrigin:function(t,n){this[e+"-origin-x"]=Math.round(1e3*t)/1e3+"%",this[e+"-origin-y"]=Math.round(1e3*n)/1e3+"%"}},t.prefix=e,t}),app.factory("Matrix",[function(){function t(t){this.element=t||document.createElement("div"),this.translate={x:0,y:0,z:0},this.rotate={x:0,y:0,z:0},this.scale={x:1,y:1,z:1},this.skew={x:0,y:0},this.matrix=this.decompose(),this.decompositionType=a.QRLike,console.log("Matrix",n,e),this.get()}var e={name:"transform",key:"transform",matrix:null},n=function(){if(!window.getComputedStyle)return!1;if(e.matrix=window.WebKitCSSMatrix||window.MozCSSMatrix||window.MsCSSMatrix||window.OCSSMatrix||window.CSSMatrix,!e.matrix)return!1;var t=document.createElement("div"),n=!1,a={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(t,null);for(var r in a)if(void 0!==t.style[r]){t.style[r]="translate3d(1px,1px,1px)",n=window.getComputedStyle(t).getPropertyValue(a[r]),e.name=r,e.key=a[r];break}return document.body.removeChild(t),void 0!==n&&n.length>0&&"none"!==n}(e),a={QRLike:1,LULike:2};return t.prototype.decompose=function(){var t=window.getComputedStyle(this.element),n=t[e.name];if(n)if(n=n.trim(),this.matrix=new e.matrix(n),"none"===n)this.translate.x=this.translate.y=this.translate.z=0,this.rotate.x=this.rotate.y=this.rotate.z=0,this.scale.x=this.scale.y=this.scale.z=1,this.skew.x=this.skew.y=0;else{var r=/matrix3d\((.*),(.*),(.*),(.*),(.*),(.*),(.*),(.*),(.*),(.*),(.*),(.*),(.*),(.*),(.*),(.*)\)/,s=r.exec(n),i=/matrix\((.*),(.*),(.*),(.*),(.*),(.*)\)/,o=i.exec(n);if(null!==s){var c=new e.matrix(n);if(!c||isNaN(c.a)||isNaN(c.b)||isNaN(c.c)||isNaN(c.m41)||isNaN(c.m42)||isNaN(c.m43)||isNaN(c.m11))throw"Could not catch CSSMatrix constructor for current browser, OR the constructor has returned a non-standard matrix object (need .a, .b, .c and mXX numerical properties to work)";this.rotate.x=180*Math.asin(c.m22)/Math.PI,this.rotate.y=180*Math.acos(c.m11)/Math.PI*(c.m13>0?-1:1),this.rotate.z=0,this.translate.x=c.m41,this.translate.y=c.m42,this.translate.z=c.m43,this.scale.x=c.m11,this.scale.y=c.m11,this.scale.z=c.m11,this.skew.x=0,this.skew.y=0}else if(null!==o){var u=parseFloat(o[1]),l=parseFloat(o[2]),h=parseFloat(o[3]),f=parseFloat(o[4]),p=parseFloat(o[5]),d=parseFloat(o[6]),m=u*f-l*h;if(this.rotate.x=0,this.rotate.y=0,this.rotate.z=0,this.translate.x=p,this.translate.y=d,this.translate.z=0,this.scale.x=1,this.scale.y=1,this.scale.z=1,this.skew.x=0,this.skew.y=0,this.decompositionType===a.QRLike)if(0!=u||0!=l){var g=Math.sqrt(u*u+l*l);this.rotate.z=l>0?Math.acos(u/g):-Math.acos(u/g),this.scale.x=g,this.scale.y=m/g,this.skew.x=Math.atan((u*h+l*f)/(g*g)),this.skew.y=0}else if(0!=h||0!=f){var v=Math.sqrt(h*h+f*f);this.rotate.z=Math.PI/2-(f>0?Math.acos(-h/v):-Math.acos(h/v)),this.scale.x=m/v,this.scale.y=v,this.skew.x=0,this.skew.y=Math.atan((u*h+l*f)/(v*v))}else this.rotate.z=0,this.scale.x=0,this.scale.y=0,this.skew.x=0,this.skew.y=0;else 0!=u?(this.rotate.z=0,this.scale.x=u,this.scale.y=m/u,this.skew.x=Math.atan(h/u),this.skew.y=Math.atan(l/u)):0!=l?(this.rotate.z=Math.PI/2,this.scale.x=l,this.scale.y=m/l,this.skew.x=Math.atan(f/l),this.skew.y=0):(this.rotate.z=0,this.scale.x=h,this.scale.y=f,this.skew.x=Math.PI/4,this.skew.y=0,this.scale.x=0,this.scale.y=1)}}else this.matrix=new e.matrix;return this.matrix},t.prototype.compose=function(){var t=new e.matrix;return n?(t=t.translate(this.translate.x,this.translate.y,this.translate.z),t=t.scale(this.scale.x,this.scale.y,this.scale.z),t=t.rotate(this.rotate.x,this.rotate.y,this.rotate.z)):(t=t.translate(this.translate.x,this.translate.y),t=t.scale(this.scale.x,this.scale.y),t=t.rotate(this.rotate.z)),t},t.prototype.get=function(){this.decompose(),console.log(this.toString())},t.prototype.set=function(){var t=this.compose().toString();this.element.style[e.name]=t},t.prototype.toString=function(){var t=this.translate,e=this.rotate,n=this.scale;return"Matrix translate("+t.x+","+t.y+","+t.z+") rotate("+e.x+","+e.y+","+e.z+") scale("+n.x+","+n.y+","+n.z+")"},t}]),app.service("Appearance",["colTypes",function(t){this.tableColumnClass=function(e){var n="";switch(e){case t.ID:n="tag tag-link";break;case t.TEXT:case t.CUSTOMER:case t.FAMILY:n="text-uppercase";break;case t.TITLE:n="col-text text-uppercase";break;case t.DATE:n="tag tag-date";break;case t.RESOURCE:case t.STATUS:case t.STATUSSM:n="tag tag-pill";break;case t.DISABLED:n="tag tag-pill disabled";break;case t.IDS:case t.NUMBER:case t.DOUBLE:case t.WEEKS:case t.HOURS:case t.COSTS:case t.ICON:case t.BUTTONS:}return n},this.tableHeaderClass=function(e){var n="";switch(e){case t.ID:n="th-id";break;case t.IDS:n="th-ids";break;case t.TEXT:n="th-text";break;case t.TITLE:n="th-title";break;case t.DATE:n="th-date";break;case t.CUSTOMER:n="th-customer";break;case t.RESOURCE:case t.DISABLED:n="th-resource";break;case t.STATUS:n="th-status";break;case t.STATUSSM:n="th-status-sm";break;case t.FAMILY:n="th-family";break;case t.NUMBER:case t.DOUBLE:case t.WEEKS:n="th-number";break;case t.HOURS:n="th-hours";break;case t.COSTS:n="th-costs";break;case t.ICON:n="th-icon";break;case t.BUTTONS:n="th-buttons"}return n}}]),app.factory("Cookie",["$q","$window",function(t,e){function n(){}return n.TIMEOUT=3e5,n._set=function(t,n,a){if(a){var r=new Date;r.setTime(r.getTime()+24*a*60*60*1e3);var s="; expires="+r.toGMTString()}else var s="";e.document.cookie=t+"="+n+s+"; path=/"},n.set=function(t,e,a){try{var r=[],s=JSON.stringify(e,function(t,e){if("pool"!==t){if("object"==typeof e&&null!==e){if(r.indexOf(e)!==-1)return;r.push(e)}return e}});r=null,n._set(t,s,a)}catch(n){console.log("Cookie.set.error serializing",t,e,n)}},n.get=function(t){for(var n=t+"=",a=e.document.cookie.split(";"),r=0;r<a.length;r++){for(var s=a[r];" "==s.charAt(0);)s=s.substring(1,s.length);if(0==s.indexOf(n)){var i=s.substring(n.length,s.length),o=null;try{o=JSON.parse(i)}catch(t){console.log("Cookie.get.error parsing",key,t)}return o}}return null},n.delete=function(t){n._set(t,"",-1)},n.on=function(e){function a(){if(o>c)s.reject("timeout");else{var t=n.get(e);t?s.resolve(t):(o+=i,r=setTimeout(a,i))}}var r,s=t.defer(),i=1e3,o=0,c=n.TIMEOUT;return a(),s.promise},n}]),app.factory("LocalStorage",["$q","$window","Cookie",function(t,e,n){function a(){}function r(){var t=!1;try{t="localStorage"in e&&null!==e.localStorage,t?(e.localStorage.setItem("test","1"),e.localStorage.removeItem("test")):t=!1}catch(e){t=!1}return t}return a.isSupported=r(),a.isSupported?(a.set=function(t,n){try{var a=[],r=JSON.stringify(n,function(t,e){if("pool"!==t){if("object"==typeof e&&null!==e){if(a.indexOf(e)!==-1)return;a.push(e)}return e}});a=null,e.localStorage.setItem(t,r)}catch(e){console.log("LocalStorage.set.error serializing",t,n,e)}},a.get=function(t){var n=null;if(void 0!==e.localStorage[t])try{n=JSON.parse(e.localStorage[t])}catch(e){console.log("LocalStorage.get.error parsing",t,e)}return n},a.delete=function(t){e.localStorage.removeItem(t)},a.on=function(a){function r(t){if(clearTimeout(s),t.originalEvent.key==a)try{var e=JSON.parse(t.originalEvent.newValue);i.resolve(e)}catch(t){console.log("LocalStorage.on.error parsing",a,t),i.reject("error parsing "+a)}}var s,i=t.defer(),o=n.TIMEOUT;return angular.element(e).on("storage",r),s=setTimeout(function(){i.reject("timeout")},o),i.promise}):(console.log("LocalStorage.unsupported switching to cookies"),a.set=n.set,a.get=n.get,a.delete=n.delete,a.on=n.on),a}]),app.factory("SessionStorage",["$q","$window","Cookie",function(t,e,n){function a(){}function r(){var t=!1;try{t="sessionStorage"in e&&void 0!==e.sessionStorage,t?(e.sessionStorage.setItem("test","1"),e.sessionStorage.removeItem("test")):t=!1}catch(e){t=!1}return t}return a.isSupported=r(),a.isSupported?(a.set=function(t,n){try{var a=[],r=JSON.stringify(n,function(t,e){if("pool"!==t){if("object"==typeof e&&null!==e){if(a.indexOf(e)!==-1)return;a.push(e)}return e}});a=null,e.sessionStorage.setItem(t,r)}catch(e){console.log("SessionStorage.set.error serializing",t,n,e)}},a.get=function(t){var n=null;if(void 0!==e.sessionStorage[t])try{n=JSON.parse(e.sessionStorage[t])}catch(e){console.log("SessionStorage.get.error parsing",t,e)}return n},a.delete=function(t){e.sessionStorage.removeItem(t)},a.on=function(a){function r(t){if(clearTimeout(s),t.originalEvent.key===a)try{var e=JSON.parse(t.originalEvent.newValue);i.resolve(e)}catch(t){console.log("SessionStorage.on.error parsing",a,t),i.reject("error parsing "+a)}}var s,i=t.defer(),o=n.TIMEOUT;return angular.element(e).on("storage",r),s=setTimeout(function(){i.reject("timeout")},o),i.promise}):(console.log("SessionStorage.unsupported switching to cookies"),a.set=n.set,a.get=n.get,a.delete=n.delete,a.on=n.on),a}]),app.factory("Animate",[function(){function t(t,e){this.callback=t,this.isPlaying=!1,this.key=null,this.ticks=0,this.useTimeout=e===!0}return t.prototype={play:function(){function t(n){e.ticks++,e.callback(n,e.ticks),this.useTimeout?e.key=window.setTimeout(t,1e3/60):e.key=window.requestAnimationFrame(t)}var e=this;this.key||(this.isPlaying=!0,t())},pause:function(){this.key&&(this.useTimeout?window.clearTimeout(this.key):window.cancelAnimationFrame(this.key),this.key=null,this.isPlaying=!1)},playpause:function(){this.key?this.pause():this.play()}},t}]),app.factory("Md5",[function(){function t(t,e){var i=t[0],o=t[1],c=t[2],u=t[3];i=n(i,o,c,u,e[0],7,-680876936),u=n(u,i,o,c,e[1],12,-389564586),c=n(c,u,i,o,e[2],17,606105819),o=n(o,c,u,i,e[3],22,-1044525330),i=n(i,o,c,u,e[4],7,-176418897),u=n(u,i,o,c,e[5],12,1200080426),c=n(c,u,i,o,e[6],17,-1473231341),o=n(o,c,u,i,e[7],22,-45705983),i=n(i,o,c,u,e[8],7,1770035416),u=n(u,i,o,c,e[9],12,-1958414417),c=n(c,u,i,o,e[10],17,-42063),o=n(o,c,u,i,e[11],22,-1990404162),i=n(i,o,c,u,e[12],7,1804603682),u=n(u,i,o,c,e[13],12,-40341101),c=n(c,u,i,o,e[14],17,-1502002290),o=n(o,c,u,i,e[15],22,1236535329),i=a(i,o,c,u,e[1],5,-165796510),u=a(u,i,o,c,e[6],9,-1069501632),c=a(c,u,i,o,e[11],14,643717713),o=a(o,c,u,i,e[0],20,-373897302),i=a(i,o,c,u,e[5],5,-701558691),u=a(u,i,o,c,e[10],9,38016083),c=a(c,u,i,o,e[15],14,-660478335),o=a(o,c,u,i,e[4],20,-405537848),i=a(i,o,c,u,e[9],5,568446438),u=a(u,i,o,c,e[14],9,-1019803690),c=a(c,u,i,o,e[3],14,-187363961),o=a(o,c,u,i,e[8],20,1163531501),i=a(i,o,c,u,e[13],5,-1444681467),u=a(u,i,o,c,e[2],9,-51403784),c=a(c,u,i,o,e[7],14,1735328473),o=a(o,c,u,i,e[12],20,-1926607734),i=r(i,o,c,u,e[5],4,-378558),u=r(u,i,o,c,e[8],11,-2022574463),c=r(c,u,i,o,e[11],16,1839030562),o=r(o,c,u,i,e[14],23,-35309556),i=r(i,o,c,u,e[1],4,-1530992060),u=r(u,i,o,c,e[4],11,1272893353),c=r(c,u,i,o,e[7],16,-155497632),o=r(o,c,u,i,e[10],23,-1094730640),i=r(i,o,c,u,e[13],4,681279174),u=r(u,i,o,c,e[0],11,-358537222),c=r(c,u,i,o,e[3],16,-722521979),o=r(o,c,u,i,e[6],23,76029189),i=r(i,o,c,u,e[9],4,-640364487),u=r(u,i,o,c,e[12],11,-421815835),c=r(c,u,i,o,e[15],16,530742520),o=r(o,c,u,i,e[2],23,-995338651),i=s(i,o,c,u,e[0],6,-198630844),u=s(u,i,o,c,e[7],10,1126891415),c=s(c,u,i,o,e[14],15,-1416354905),o=s(o,c,u,i,e[5],21,-57434055),i=s(i,o,c,u,e[12],6,1700485571),u=s(u,i,o,c,e[3],10,-1894986606),c=s(c,u,i,o,e[10],15,-1051523),o=s(o,c,u,i,e[1],21,-2054922799),i=s(i,o,c,u,e[8],6,1873313359),u=s(u,i,o,c,e[15],10,-30611744),c=s(c,u,i,o,e[6],15,-1560198380),o=s(o,c,u,i,e[13],21,1309151649),i=s(i,o,c,u,e[4],6,-145523070),u=s(u,i,o,c,e[11],10,-1120210379),c=s(c,u,i,o,e[2],15,718787259),o=s(o,c,u,i,e[9],21,-343485551),t[0]=l(i,t[0]),t[1]=l(o,t[1]),t[2]=l(c,t[2]),t[3]=l(u,t[3])}function e(t,e,n,a,r,s){return e=l(l(e,t),l(a,s)),l(e<<r|e>>>32-r,n)}function n(t,n,a,r,s,i,o){return e(n&a|~n&r,t,n,s,i,o)}function a(t,n,a,r,s,i,o){return e(n&r|a&~r,t,n,s,i,o)}function r(t,n,a,r,s,i,o){return e(n^a^r,t,n,s,i,o)}function s(t,n,a,r,s,i,o){return e(a^(n|~r),t,n,s,i,o)}function i(e){var n,a=e.length,r=[1732584193,-271733879,-1732584194,271733878];for(n=64;n<=e.length;n+=64)t(r,o(e.substring(n-64,n)));e=e.substring(n-64);var s=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(n=0;n<e.length;n++)s[n>>2]|=e.charCodeAt(n)<<(n%4<<3);if(s[n>>2]|=128<<(n%4<<3),n>55)for(t(r,s),n=0;n<16;n++)s[n]=0;return s[14]=8*a,t(r,s),r}function o(t){var e,n=[];for(e=0;e<64;e+=4)n[e>>2]=t.charCodeAt(e)+(t.charCodeAt(e+1)<<8)+(t.charCodeAt(e+2)<<16)+(t.charCodeAt(e+3)<<24);return n}function c(t){for(var e="",n=0;n<4;n++)e+=f[t>>8*n+4&15]+f[t>>8*n&15];return e}function u(t){for(var e=0;e<t.length;e++)t[e]=c(t[e]);return t.join("")}function l(t,e){return t+e&4294967295}function h(){}var f="0123456789abcdef".split("");return h.encode=function(t){return u(i(t))},"5d41402abc4b2a76b9719d911017c592"!==h.encode("hello")&&(l=function(t,e){var n=(65535&t)+(65535&e),a=(t>>16)+(e>>16)+(n>>16);return a<<16|65535&n}),h}]),app.factory("Utils",["$compile","$controller","Vector","Md5",function(t,e,n,a){function r(t,e){var a=new n;if("touchstart"==t.type||"touchmove"==t.type||"touchend"==t.type||"touchcancel"==t.type){var r=null,s=t.originalEvent?t.originalEvent:t,i=s.touches.length?s.touches:s.changedTouches;i&&i.length&&(r=i[0]),r&&(a.x=r.pageX,a.y=r.pageY)}else"click"!=t.type&&"mousedown"!=t.type&&"mouseup"!=t.type&&"mousemove"!=t.type&&"mouseover"!=t.type&&"mouseout"!=t.type&&"mouseenter"!=t.type&&"mouseleave"!=t.type||(a.x=t.pageX,a.y=t.pageY);return e&&(a.s=n.difference(e,a)),a.type=t.type,a}function s(t,e){var a=t[0].getBoundingClientRect(),r=new n(a.left,a.top);return n.difference(r,e)}function i(t,e){var n,a;if(["matches","webkitMatchesSelector","mozMatchesSelector","msMatchesSelector","oMatchesSelector"].some(function(t){return"function"==typeof document.body[t]&&(n=t,!0)}),t[n](e))return t;for(;null!==t;){if(a=t.parentElement,null!==a&&a[n](e))return a;t=a}return null}function o(t,e){var n;if(t===e)return t;for(;null!==t;){if(n=t.parentElement,null!==n&&n===e)return n;t=n}return null}function c(t,e,n){var a,r,s,i=null,o=0;n||(n={});var c=function(){o=n.leading===!1?0:v(),i=null,s=t.apply(a,r),i||(a=r=null)};return function(){var u=v();o||n.leading!==!1||(o=u);var l=e-(u-o);return a=this,r=arguments,l<=0||l>e?(i&&(clearTimeout(i),i=null),o=u,s=t.apply(a,r),i||(a=r=null)):i||n.trailing===!1||(i=setTimeout(c,l)),s}}function u(t,e){var n=null;return t&&angular.forEach(t,function(t){var a=!0;angular.forEach(e,function(e,n){a=a&&t[n]===e}),a&&(n=t)}),n}function l(n,a,r,s){a.html(r);var i=t(a.contents());if(s.controller){var o=n.$new();angular.extend(o,s);var c=e(s.controller,{$scope:o});s.controllerAs&&(n[s.controllerAs]=c),a.data("$ngControllerController",c),a.children().data("$ngControllerController",c),n=o}i(n)}function h(){}function f(t){return function(e,n){return e[t]<n[t]?1:e[t]>n[t]?-1:0}}function p(t,e,n){t=t||"",e=e||"";var a=t.split(",");if(a.length>1){var r=a.shift();return angular.forEach(a,function(t,a){r=n?r.split("{"+a+"}").join("' + "+e+t+" + '"):r.split("{"+a+"}").join(e+t)}),n?"'"+r+"'":r}return e+t}function d(t,e){return t[e]}function m(t,e,n){return"string"==typeof e?m(t,e.split("."),n):1==e.length&&void 0!==n?t[e[0]]=n:0==e.length?t:m(t[e[0]],e.slice(1),n)}function g(t,e,n){return"string"==typeof e?g(t,e.split("."),n):1==e.length&&void 0!==n?t[e[0]]+=n:0==e.length?t:g(t[e[0]],e.slice(1),n)}!function(){for(var t=0,e=["ms","moz","webkit","o"],n=0;n<e.length&&!window.requestAnimationFrame;++n)window.requestAnimationFrame=window[e[n]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[e[n]+"CancelAnimationFrame"]||window[e[n]+"CancelRequestAnimationFrame"];window.requestAnimationFrame||(window.requestAnimationFrame=function(e,n){var a=(new Date).getTime(),r=Math.max(0,16-(a-t)),s=window.setTimeout(function(){e(a+r)},r);return t=a+r,s}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(t){clearTimeout(t)})}(),function(){Array.prototype.reduce||Object.defineProperty(Array.prototype,"reduce",{value:function(t){if(null===this)throw new TypeError("Array.prototype.reduce called on null or undefined");if("function"!=typeof t)throw new TypeError(t+" is not a function");var e,n=Object(this),a=n.length>>>0,r=0;if(2==arguments.length)e=arguments[1];else{for(;r<a&&!(r in n);)r++;if(r>=a)throw new TypeError("Reduce of empty array with no initial value");e=n[r++]}for(;r<a;)r in n&&(e=t(e,n[r],r,n)),r++;return e}})}();var v=Date.now||function(){return(new Date).getTime()},y=window.navigator.userAgent.toLowerCase(),b=y.indexOf("safari")!==-1&&y.indexOf("chrome")===-1,w=y.indexOf("trident")!==-1||y.indexOf("edge")!==-1||y.indexOf("msie")!==-1,S=!b&&!w&&y.indexOf("chrome")!==-1,E=y.indexOf("mobile")!==-1;return h.reverseSortOn=f,h.getTouch=r,h.getRelativeTouch=s,h.getClosest=i,h.getClosestElement=o,h.throttle=c,h.where=u,h.format=p,h.compileController=l,h.reducer=d,h.reducerSetter=m,h.reducerAdder=g,h.toMd5=function(t){return a.encode(t)},h.ua={safari:b,msie:w,chrome:S,mobile:E},angular.forEach(h.ua,function(t,e){t&&angular.element(document.getElementsByTagName("body")).addClass(e)}),h}]),app.factory("State",["$timeout",function(t){function e(){this.isReady=!1,this.idle()}return e.prototype={idle:function(){this.isBusy=!1,this.isError=!1,this.isErroring=!1,this.isSuccess=!1,this.isSuccessing=!1,this.button=null,this.errors=[]},enabled:function(){return!this.isBusy&&!this.isErroring&&!this.isSuccessing},busy:function(){return!this.isBusy&&(this.isBusy=!0,this.isError=!1,this.isErroring=!1,this.isSuccess=!1,this.isSuccessing=!1,this.errors=[],!0)},success:function(){this.isBusy=!1,this.isError=!1,this.isErroring=!1,this.isSuccess=!0,this.isSuccessing=!0,this.errors=[],t(function(){this.isSuccessing=!1,this.button=null}.bind(this),1e3)},error:function(e){this.isBusy=!1,this.isError=!0,this.isErroring=!0,this.isSuccess=!1,this.isSuccessing=!1,this.errors.push(e),t(function(){this.isErroring=!1,this.button=null}.bind(this),1e3)},ready:function(){this.isReady=!0,this.success()},errorMessage:function(){return this.isError?this.errors[this.errors.length-1]:null},submitClass:function(){return{busy:this.isBusy,ready:this.isReady,successing:this.isSuccessing,success:this.isSuccess,errorring:this.isErroring,error:this.isError}},submitMessage:function(t,e,n,a){return t=t||"Submit",this.isBusy?e||t:this.isSuccess?n||t:this.isError?a||t:t}},e}]),app.factory("DataFilter",["$filter",function(t){function e(t){t?angular.extend(this,t):null}return e.prototype={getObjectParams:function(t){var e=[];if(t)for(var n in t)e.push({name:n,value:t[n]});return e},getParams:function(t){var e,n={};for(var a in this)switch(a){case"dateFrom":case"dateTo":case"status":e=this[a],void 0!==e&&(n[a]=e);break;case"search":case"sort":var r=JSON.stringify(this.getObjectParams(this[a]),null,"");n[a]=window.btoa(r)}return t.unpaged||(n.page=t.page,n.size=t.size),n},getMonths:function(){function e(t,e){var n;return n=12*(e.getFullYear()-t.getFullYear()),n-=t.getMonth()+1,n+=e.getMonth()+1,n++,n<=0?0:n}var n=[];if(this.dateFrom&&this.dateTo){var a=[this.dateFrom,this.dateTo];a=a.sort(function(t,e){return t.getTime()-e.getTime()});for(var r=Math.max(1,e(a[0],a[1])),s=0;s<r;){var i=new Date(a[0].getFullYear(),a[0].getMonth()+s,1);n.push({id:i.getTime(),name:t("date")(i,"(yyyy MM) MMMM"),nameShort:t("date")(i,"MMM yy")}),s++}}return n}},e}]),app.factory("DataSource",["$q","$http","$rootScope","$location","LocalStorage","State","DataFilter",function(t,e,n,a,r,s,i){function o(t){this.state=new s,this.page=c,this.size=u,this.pages=l,this.count=0,this.maxPages=10,this.items=[],this.rows=[],this.allrows=[],this.steps=[],this.filters=new i({}),this.uri="/api/items/paging",this.unpaged=!1,t?angular.extend(this,t):null}var c=1,u=7,l=Number.POSITIVE_INFINITY;return o.prototype={resolve:function(t){angular.forEach(this.response.data,function(t){this.push(t)},this.rows),t.resolve()},group:function(t){t.resolve()},next:function(e){if(this.steps.length){var n=t.defer();n.promise.then(function(t){this.next(e)}.bind(this),function(t){this.error(t)}.bind(this));var a=this.steps.shift();a.call(this,n)}else e.resolve()},when:function(){var e=t.defer();return angular.forEach(Array.prototype.slice.call(arguments),function(t){this.push(t)},this.steps),this.next(e),e.promise},unallowed:function(t){this.deferred.reject(t),this.deferred=null,this.state.error(t),a.$$lastRequestedPath=a.path(),a.path("/signin")},error:function(t){var e=t?{message:t.data?t.data.message:"error",status:t.status}:null;if("ERROR_NOT_ALLOWED"===e.message){var n=r.get("q");console.log("onError",e,"q",n),this.unallowed(e)}else this.deferred.reject(e),this.deferred=null,this.state.error(e)},parseHeader:function(){var t=this.response.headers("X-Pagination"),e=t?JSON.parse(t):null;e?(this.page=e.page,this.size=e.size,this.count=e.count,this.pages=e.pages):(this.page=c,this.size=this.size||u,this.count=this.response.data.length,this.pages=Math.ceil(this.count/this.size)),this.pagination=this.getPages()},getUri:function(){return angular.isFunction(this.uri)?this.uri():this.uri},getParams:function(){return{params:this.filters.getParams(this)}},get:function(){e.get(this.getUri(),this.getParams()).then(function(t){this.rows.length=0,this.items.length=0,this.response=t,this.parseHeader(),this.when(this.resolve,this.group).then(function(){this.allrows=this.allrows.concat(this.rows),n.$broadcast("onDataSourceUpdate",this),this.state.success(),this.deferred.resolve(this.rows),this.deferred=null}.bind(this))}.bind(this),function(t){this.error(t)}.bind(this))},update:function(t){this.items=[],this.state.busy()&&this.when(this.group).then(function(){this.state.success()}.bind(this))},paging:function(e){var n=this.deferred=e||t.defer();return(this.page<=this.pages||void 0!==e)&&this.state.busy()&&(this.opened=null,this.get()),n.promise},filter:function(){var e=t.defer();return this.allrows=[],this.paging(e),e.promise},add:function(t){this.rows.push(t),this.allrows.push(t),this.update(),this.count++,this.pages=Math.ceil(this.count/this.size)},remove:function(t){var e=this.rows.indexOf(t);e!==-1&&this.rows.splice(e,1),e=this.allrows.indexOf(t),e!==-1&&this.allrows.splice(e,1),this.update(),this.count--,this.pages=Math.ceil(this.count/this.size)},prevPage:function(){var t=this.page-1;t>0&&t<=this.pages&&(this.page=t,this.paging())},nextPage:function(){var t=this.page+1;t>0&&t<=this.pages&&(this.page=t,this.paging())},gotoPage:function(t){t>0&&t<=this.pages&&(this.page=t,this.paging())},firstPage:function(){1!==this.page&&(this.page=1,this.paging())},lastPage:function(){this.page!==this.pages&&(this.page=this.pages,this.paging())},hasMany:function(){return this.pages>this.maxPages},hasMorePagesBehind:function(){var t=Math.max(0,this.page-this.maxPages);
return t>0},hasMorePagesNext:function(){var t=Math.max(0,this.page-this.maxPages)+this.maxPages;return t<this.pages},isPage:function(t){return this.page===t},hasPages:function(){return this.pages>0&&this.pages<l},getPages:function(){var t,e=[];if(this.hasPages()){var n=Math.max(0,this.page-this.maxPages),a=Math.min(this.pages,n+this.maxPages);for(t=n;t<a;)e.push({number:t+1}),t++}return e},openClose:function(t){this.opened===t?this.opened=null:this.opened=t},setSort:function(e,n){var a=t.defer();return this.state.isBusy||(this.filters.sort={},this.filters.sort[e]=n,angular.isFunction(this.sort)?(this.sort(this),a.resolve(this.rows)):(this.allrows=[],this.paging(a))),a.promise},getSort:function(t){return this.filters.sort?this.filters.sort[t]||0:0},hasSort:function(){if(this.filters.sort){var t=!1;return angular.forEach(this.filters.sort,function(e){t=t||e}),t}return!1},setSearch:function(e,n){var a=t.defer();return this.state.isBusy||(this.filters.search={},n&&""!==n&&(this.filters.search[e]=n),angular.isFunction(this.search)?(this.search(this),a.resolve(this.rows)):(this.allrows=[],this.paging(a))),a.promise},getSearch:function(t){return this.filters.search?this.filters.search[t]||0:0},hasSearch:function(){if(this.filters.search){var t=!1;return angular.forEach(this.filters.search,function(e){t=t||e&&""!==e}),t}return!1},setDateFrom:function(e){var n=t.defer();return this.state.isBusy||(this.filters.dateFrom=e||"",angular.isFunction(this.dateFrom)?(this.dateFrom(this),n.resolve(this.rows)):(this.allrows=[],this.paging(n))),n.promise},getDateFrom:function(){return this.filters.dateFrom||null},setDateTo:function(e){var n=t.defer();return this.state.isBusy||(this.filters.dateTo=e||"",angular.isFunction(this.dateTo)?(this.dateTo(this),n.resolve(this.rows)):(this.allrows=[],this.paging(n))),n.promise},getDateTo:function(){return this.filters.dateTo||null},setDates:function(e,n){var a=t.defer();return this.state.isBusy||(this.filters.dateFrom=e||"",this.filters.dateTo=n||"",this.allrows=[],this.paging(a)),a.promise}},o}]),app.factory("Column",["$parse","$filter","Utils","colTypes",function(t,e,n,a){function r(e){e?angular.extend(this,e):null,angular.isFunction(this.value)&&(this.value=this.value.bind(this)),this.raw=this.raw||this.value,this.source=this.source||this.value,this.getters={};var n=["key","value","raw","source","post"];angular.forEach(n,function(e){this[e]&&(this.getters[e]=angular.isFunction(this[e])?this[e]:t(this[e]))},this),this.setters={},angular.forEach(this.getters,function(t,e){angular.isFunction(this[e])||(this.setters[e]=t.assign)},this),this.reset()}return r.prototype={getKey:function(t){return this.getters.key(t)},getValue:function(t){return this.getters.value(t)},getRaw:function(t){return this.getters.raw(t)},getSource:function(t){return this.getters.source(t)},reset:function(){this.values=[],this.keys={},this.search=[],this.total=0},hasKey:function(t){var e=!0,n=this.getKey(t);return n&&1!=this.keys[n]&&(this.keys[n]=!0,e=!1),e},initValue:function(t){return this.setters.raw(t,this.getters.value(t)||0),this},addTotal:function(t,e){return this.setters.raw(t,(this.getters.raw(t)||0)+(this.getters.value(e)||0)),this},addCount:function(t,e){if(!this.hasKey(e)&&this.setters.raw){var n=null;n=t!=e?(this.getters.raw(t)||0)+1:1,this.setters.raw(t,n)}return this},addValue:function(t){this.values=this.values||[];var e=this.getKey(t),n=!1;if(angular.forEach(this.values,function(t){t.id==e&&(n=!0)}),!n){var a=this.getRaw(t);this.values.push({id:e,name:a||"-"})}},getValueTotal:function(t){var e=0;if(this.compare&&this.type===a.INCREMENT){var n=0,r=0;angular.forEach(t,function(t){n+=this.col.getters.raw(t)||0,r+=this.getters.raw(t)||0}.bind(this)),r&&(e=(n-r)/r*100)}else angular.forEach(t,function(t){e+=this.getRaw(t)||0}.bind(this));return this.total=e,e},getValueFormatted:function(t){var n=this.getRaw(t);switch(this.type){case a.RESOURCE:case a.DISABLED:n=e("shortName")(n);break;case a.ID:case a.NUMBER:n=e("customNumber")(n,0);break;case a.DOUBLE:n=e("customNumber")(n,2);break;case a.WEEKS:n=e("customNumber")(n,2," W");break;case a.DATE:n=e("date")(n,"yyyy-MM-dd");break;case a.HOURS:n=e("customNumber")(n,0," H");break;case a.COSTS:n=e("customNumber")(n,0," €");break;case a.PERCENT:n=e("customNumber")(n,2," %");break;case a.INCREMENT:n=angular.isNumber(n)?(n>0?"+":"")+e("customNumber")(n,2," %"):n||"-"}return n},getFormatted:function(t){return this.dynamic?this.getValueFormatted(t):t.static[this.id].value},getTotal:function(t){var n=this.getValueTotal(t);switch(this.type){case a.NUMBER:n=e("customNumber")(n,0);break;case a.DOUBLE:n=e("customNumber")(n,2);break;case a.WEEKS:n=e("customNumber")(n,2," W");break;case a.HOURS:n=e("customNumber")(n,0," H");break;case a.COSTS:n=e("customNumber")(n,0," €");break;case a.PERCENT:n=e("customNumber")(n,2," %");break;case a.INCREMENT:n=angular.isNumber(n)?(n>0?"+":"")+e("customNumber")(n,2," %"):n||"-"}return n},getFormat:function(){var t="";switch(this.type){case a.ID:case a.NUMBER:t="#";break;case a.DOUBLE:t="#";break;case a.DATE:t="yyyy-mm-dd";break;case a.WEEKS:t="#,###0 [$W]";break;case a.HOURS:t="#,###0 [$H]";break;case a.COSTS:t="#,###.00 €";break;case a.PERCENT:t="0.00%";break;case a.INCREMENT:t="[Color 10]+0.00%;[Red]-0.00%;-"}return t},getLink:function(t){return angular.isFunction(this.link)?this.link(t):null},getHeaderClass:function(){var t=[];switch(angular.forEach(this,function(e,n){e===!0&&t.push(n)}),this.type){case a.NUMBER:case a.DOUBLE:case a.WEEKS:case a.HOURS:case a.COSTS:case a.PERCENT:case a.INCREMENT:t.push("text-xs-right")}var e=this.getColumnClass();return""!=e&&t.push(e),t.join(" ")},getCellClass:function(t){var e=[];switch(angular.forEach(this,function(t,n){t===!0&&e.push(n)}),this.type){case a.LINK:e.push("text-underline");break;case a.NUMBER:case a.DOUBLE:case a.WEEKS:case a.HOURS:case a.COSTS:e.push("text-xs-right");break;case a.PERCENT:e.push("text-xs-right");break;case a.INCREMENT:e.push("text-xs-right")}return e.join(" ")},getColumnClass:function(){return this.color?"shade-light-blue-"+this.color:""},getItemClass:function(t){var e=[];e.push(t.static[this.id].baseClass);var n=this.getColumnClass();return""!=n&&e.push(n),e.join(" ")},getTextClass:function(t){var e=[];switch(this.type){case a.INCREMENT:var n=this.getRaw(t);angular.isNumber(n)&&n<0?e.push("text-danger"):e.push("text-success")}return e.join(" ")},getTotalClass:function(t){var e=[];switch(this.type){case a.NUMBER:case a.DOUBLE:case a.WEEKS:case a.HOURS:case a.COSTS:case a.PERCENT:case a.INCREMENT:e.push("text-xs-right")}return e.join(" ")},searchToggle:function(t){var e=this.search.indexOf(t.id);e===-1?(t.active=!0,this.search.push(t.id)):(t.active=!1,this.search.splice(e,1))},isActive:function(){return angular.isFunction(this.active)&&this.active?this.active():this.active},toggle:function(){angular.isFunction(this.active)?null:this.active=!this.active},activate:function(){angular.isFunction(this.active)?null:this.active=!0},deactivate:function(){angular.isFunction(this.active)?null:this.active=!1},makeStatic:function(t){this.post&&this.setters.raw(t,this.getters.post(t)||0);var e=this;t.static[e.id]={baseClass:e.getCellClass(t),textClass:e.getTextClass(t),value:e.getValueFormatted(t),link:e.link?e.link(t):null,pop:e.pop?e.pop(t):null}}},r.types=a,r}]),app.factory("Columns",["$parse","Utils","Column","colTypes",function(t,e,n,a){function r(t){var e=[];return t&&angular.forEach(t,function(t,a){t.id=a+1,e.push(new n(t))}),angular.extend(e,r.prototype),e}return r.prototype={getCount:function(){var t=0;return angular.forEach(this,function(e){t+=e.isActive()?1:0}.bind(this)),t},getFirstCol:function(){var t=null;return angular.forEach(this,function(e){null===t&&e.isActive()&&e.groupBy&&"month"!==e.value&&"monthShort"!==e.value&&(t=e)}),t},getChartKey:function(t,e){var n=[];return angular.forEach(this,function(e){e.isActive()&&e.groupBy&&"month"!==e.value&&"monthShort"!==e.value&&0===n.length&&n.push(e.getKey(t))}),n.push(e),n.join("-")},getGroupKey:function(t){var e=[];return angular.forEach(this,function(n){n.isActive()&&n.groupBy&&e.push(n.getKey(t))}),e.join("-")},getSortKey:function(e){var n=[];return angular.forEach(this,function(a){a.isActive()&&a.groupBy&&n.push(a.sort?t(a.sort)(e):a.getValueFormatted(e))}),n.join("")},expand:function(t){var e={dynamic:!0,compare:!0};t?angular.extend(e,t):null;var s=[];return s.radios={},angular.forEach(this,function(t,r){t.id=s.length+1,s.push(t),t.aggregate&&(e.dynamic&&s.push(new n({id:s.length+1,name:"%",value:function(e){return t.getters.raw(e)/t.total*100},key:t.key,type:a.PERCENT,dynamic:!0,active:function(){return s.showDynamics&&t.active},col:t})),e.compare&&(s.push(new n({id:s.length+1,name:"anno precedente",value:function(t){return this.getters.raw(t)},raw:t.value+"Last",source:t.value,key:t.key,type:t.type,count:t.count,compare:!0,dynamic:!0,active:function(){return s.showComparison&&t.active},col:t})),s.push(new n({id:s.length+1,name:"%",value:function(e){var n=t.getters.raw(e)||0,a=this.getters.raw(e)||0;return a?(n-a)/a*100:null},raw:t.value+"Gain",source:t.value,key:t.key,type:a.INCREMENT,count:t.count,compare:!0,dynamic:!0,active:function(){return s.showComparison&&t.active},col:t})))),t.radio&&t.active&&(s.radios[t.radio]=t.value)}),angular.extend(s,r.prototype),s},getGroups:function(){var t=[];return angular.forEach(this,function(e,n){e.groupBy&&t.push(e)}),angular.extend(t,r.prototype),t},getCounters:function(){var t=[];return angular.forEach(this,function(e,n){e.count&&t.push(e)}),angular.extend(t,r.prototype),t},getAggregates:function(){var t=[];return angular.forEach(this,function(e,n){e.aggregate&&!e.count&&t.push(e)}),angular.extend(t,r.prototype),t},getPercentages:function(){var t=[];return angular.forEach(this,function(e,n){e.type===a.PERCENT&&t.push(e)}),angular.extend(t,r.prototype),t},getDynamics:function(){var t=[];return angular.forEach(this,function(e,n){e.dynamic&&t.push(e)}),angular.extend(t,r.prototype),t},getCompares:function(){var t=[];return angular.forEach(this,function(e,n){e.compare&&t.push(e)}),angular.extend(t,r.prototype),t},reset:function(){return this.groups={},angular.forEach(this,function(t){t.reset()}),this},makeStatic:function(t){angular.forEach(this,function(t,e){t.values=[],t.static={active:t.isActive(),headerClass:t.getHeaderClass()}}),angular.forEach(this,function(e,n){(e.static.active||e.dynamic)&&(angular.forEach(t,function(t){e.makeStatic(t),e.groupBy?e.addValue(t):null}),e.groupBy&&(e.values=e.values.sort(function(t,e){var n,a;return n=t.name?String(t.name).toLowerCase():"",a=e.name?String(e.name).toLowerCase():"",n<a?-1:n>a?1:0})))})},activeInRange:function(t){for(var e=!1,n=0;!e&&n<this.length;){var a=this[n];a.static.active&&(e=t.indexOf(a.value)!==-1),n++}return e},unique:function(t,e){var n=this.getGroupKey(t),a=this.groups[n];return a||(a=this.groups[n]=t,a.static=[],e.push(a)),a},iterate:function(t,e){t=angular.copy(t);var n=this.unique(t,e);this.addTotals(n,t)},compare:function(t,e){t=angular.copy(t),angular.forEach(this,function(e){if(e.compare){var n=e.getters.source(t);e.setters.raw(t,n)}}),angular.forEach(this,function(e){e.compare&&e.setters.source(t,0)});var n=this.unique(t,e);this.addTotals(n,t,!0)},addTotals:function(t,e,n){return angular.forEach(this,function(a){a.isActive()&&(n?a.compare:!a.compare)&&(a.count?a.addCount(t,e):(n||a.aggregate)&&(a.hasKey(e)||(t===e?a.initValue(t):a.addTotal(t,e))))}),this},toggleColumns:function(t){t.radio?(angular.forEach(this,function(e){t.radio===e.radio&&t!==e&&e.deactivate()}),t.activate(),this.radios[t.radio]=t.value):t.toggle()},searchDisabled:function(t,e,n){for(var a=t.id,r=!1,s=0;s<n.length;)r=r||e.getKey(n[s])===a,r?s=n.length:s++;return!r},setMode:function(t){switch(this[t]=!this[t],t){case"showDynamics":this.showComparison=!1;break;case"showComparison":this.showDynamics=!1}return this[t]}},r.types=a,r}]),app.factory("ChartData",["$filter",function(t){function e(e){var n={type:"chart-line",labels:[],series:[],data:[],options:{bezierCurve:!1,elements:{line:{tension:0}},scaleLabel:function(e){return t("currency")(e.value)},tooltipTemplate:function(e){return t("currency")(e.value)},scales:{yAxes:[{gridLines:{display:!1},ticks:{min:0,callback:function(e,n,a){return t("customNumber")(e,2," W")}}}],callbacks:{label:function(e){return console.log("b"),t("customNumber")(e.value,2," W")}}},tooltips:{callbacks:{title:function(t,e){return""},label:function(e,n){var a=n.datasets[e.datasetIndex].label,r=n.datasets[e.datasetIndex].data[e.index];return a+": "+t("customNumber")(r,2," W")}}}},onClick:function(t,e){console.log("chart",t,e)},datasetOverride:[]};angular.extend(this,n),e?angular.extend(this,e):null}return e.prototype={getObjectParams:function(t){var e=[];if(t)for(var n in t)e.push({name:n,value:t[n]});return e},getParams:function(t){var e,n={};for(var a in this)switch(a){case"dateFrom":case"dateTo":case"status":e=this[a],void 0!==e&&(n[a]=e);break;case"search":case"sort":var r=JSON.stringify(this.getObjectParams(this[a]),null,"");n[a]=window.btoa(r)}return t.unpaged||(n.page=t.page,n.size=t.size),n},getMonths:function(){function e(t,e){var n;return n=12*(e.getFullYear()-t.getFullYear()),n-=t.getMonth()+1,n+=e.getMonth()+1,n++,n<=0?0:n}var n=[];if(this.dateFrom&&this.dateTo){var a=[this.dateFrom,this.dateTo];a=a.sort(function(t,e){return t.getTime()-e.getTime()});for(var r=Math.max(1,e(a[0],a[1])),s=0;s<r;){var i=new Date(a[0].getFullYear(),a[0].getMonth()+s,1);n.push({id:i.getTime(),name:t("date")(i,"(yyyy MM) MMMM"),nameShort:t("date")(i,"MMM yy")}),s++}}return n}},e}]),app.service("Droppables",["ElementRect",function(t){this.natives=[],this.callbacks=[],this.rects=[],this.add=function(e,n){this.natives.push(e),this.callbacks.push(n||function(){}),this.rects.push(t.fromNative(e))},this.remove=function(t){var e=this.natives.indexOf(t);e!==-1&&(this.natives.splice(e,1),this.callbacks.splice(e,1),this.rects.splice(e,1))},this.getIntersections=function(t){var e,n=[];return angular.forEach(this.rects,function(a,r){a.set(a.native),e=angular.element(a.native),e.removeClass("dropping"),a.intersect(t)?(a.distance=a.center.distance(t.center),a.data=this.callbacks[r](),n.push(a),e.addClass("over")):e.removeClass("over")}.bind(this)),n.sort(function(t,e){return t.distance<e.distance?-1:t.distance>e.distance?1:0}),n}}]);
//# sourceMappingURL=app.min.js.map
