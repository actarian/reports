{"version":3,"sources":["docs/modules/report.js"],"names":["window","angular","module","console","log","constant","ID","IDS","TITLE","DATE","CUSTOMER","RESOURCE","STATUS","STATUSSM","FAMILY","NUMBER","HOURS","COSTS","PERCENT","INCREMENT","ICON","BUTTONS","DISABLED","LINK","BOOL","DOUBLE","WEEKS","directive","$timeout","restrict","template","transclude","replace","scope","state","link","element","attributes","model","onClick","$parent","$eval","onValidate","button","addListeners","on","removeListeners","off","stateClass","sclass","busy","isBusy","successing","isSuccessing","success","isSuccess","errorring","isErroring","error","isError","stateDisabled","disabled","$on","source","key","sort","onSort","getSort","onTap","enabled","setSort","then","response","$watchCollection","$parse","Utils","Style","ElementRect","Droppables","require","onStart","e","condition","down","getTouch","addDragListeners","onMove","move","diff","difference","dragging","power","addClass","style","transform","x","y","set","target","elementRect","nativeElement","offset","rects","getIntersections","length","native","onEnd","removeClass","fromIndex","droppableIndex","fromModel","ngModel","event","forEach","rect","index","data","droppable","from","to","$emit","removeDragListeners","selector","draggableItem","undefined","draggableIf","querySelector","onGetData","droppableIf","droppableItem","add","remove","$document","getClosestElement","onClickOut","cols","showValues","isActive","toggler","value","activate","addOutListeners","deactivate","removeOutListeners","setTimeout","getClosest","Error","filter","$filter","toTitleCase","str","txt","charAt","toUpperCase","substr","toLowerCase","indexOf","split","join","splitted","firstName","shift","lastName","legacyFilter","cost","currency","ratio","formatting","precision","unit","hours","Math","floor","minutes","label","format","timezone","placeholder","parseTime","parseHour","val","filterWatcher","_groupBy","collection","getter","dict","item","push","property","isObject","isUndefined","isMemoized","arguments","memoize","this","provider","isNull","isScope","obj","$evalAsync","$watch","$get","$window","$rootScope","getHashKey","fName","args","replacerFactory","cache","document","JSON","stringify","removeCache","id","targetScope","$id","$$listeners","$$cache","cleanStateless","$$timeout","$$phase","addListener","hashKey","$$isMemoized","filterName","$$memoize","result","factory","Animate","callback","useTimeout","isPlaying","ticks","prototype","play","loop","time","_this","requestAnimationFrame","pause","clearTimeout","cancelAnimationFrame","playpause","cycle","k","a","b","c","d","ff","gg","hh","ii","add32","cmn","q","s","t","md51","i","n","md5blk","substring","tail","charCodeAt","md5blks","rhex","j","hex_chr","hex","Md5","encode","string","lsw","msw","$compile","$controller","Vector","previous","type","touch","originalEvent","touches","changedTouches","pageX","pageY","getRelativeTouch","point","getBoundingClientRect","left","top","el","matchesFn","parent","some","fn","body","parentElement","throttle","func","wait","options","context","timeout","later","leading","getNow","apply","now","remaining","trailing","where","array","query","found","has","compileController","html","contents","controller","$scope","$new","extend","controllerAs","children","reverseSortOn","prepend","expression","formatted","reducer","o","reducerSetter","slice","reducerAdder","lastTime","vendors","currTime","Date","getTime","timeToCall","max","Array","reduce","Object","defineProperty","TypeError","len","ua","navigator","userAgent","safari","msie","chrome","mobile","toMd5","getElementsByTagName","State","isReady","idle","errors","bind","ready","errorMessage","submitClass","submitMessage","idleMessage","busyMessage","successMessage","Range","types","QUARTER","currentQuarter","setQuarter","currentSemester","setSemester","currentYear","setYear","setMonth","getMonth","year","getFullYear","quarter","SEMESTER","semester","YEAR","getName","setDiff","filters","dateFrom","dateTo","setDates","is","make","size","sqrt","normalize","l","incidence","angle","atan2","distance","cross","abs","towards","friction","copy","toString","width","height","center","fromNative","offsetWidth","offsetHeight","vector","intersect","props","scale","hoverScale","currentScale","prefix","webkit","div","createElement","every","prop","prefixed","styles","cssText","transformOrigin","round","DataFilter","getObjectParams","p","name","getParams","post","json","btoa","unpaged","page","getMonths","monthDiff","months","range","date","nameShort","$q","$http","$location","DataSource","PAGES_FIRST","PAGES_SIZE","pages","PAGES_MAX","count","maxPages","items","rows","allrows","steps","uri","Number","POSITIVE_INFINITY","resolve","deferred","group","next","$d","defer","promise","step","call","when","unallowed","reject","$$lastRequestedPath","path","message","status","parseHeader","responseHeader","headers","responseView","parse","ceil","pagination","getPages","getUri","isFunction","params","get","concat","$broadcast","update","paging","opened","splice","prevPage","nextPage","gotoPage","firstPage","lastPage","hasMany","hasMorePagesBehind","startingIndex","hasMorePagesNext","endingIndex","isPage","number","hasPages","min","openClose","hasSort","setSearch","search","getSearch","hasSearch","setDateFrom","getDateFrom","setDateTo","getDateTo","colTypes","Column","raw","getters","fields","field","setters","assign","reset","getKey","getValue","getRaw","getSource","values","keys","total","hasKey","initValue","addTotal","row","addCount","v","addValue","getValueTotal","filtered","compare","current","col","getValueFormatted","isNumber","getFormatted","dynamic","static","getTotal","getFormat","getLink","getHeaderClass","cc","columnClass","getColumnClass","getCellClass","color","getItemClass","baseClass","getTextClass","getTotalClass","searchToggle","active","toggle","makeStatic","textClass","pop","Columns","columns","list","getCount","getFirstCol","first","groupBy","getChartKey","getGroupKey","getSortKey","expand","radios","aggregate","showDynamics","showComparison","radio","getGroups","getCounters","getAggregates","getPercentages","getDynamics","getCompares","groups","headerClass","va","vb","String","activeInRange","flag","unique","iterate","addTotals","comparing","toggleColumns","searchDisabled","setMode","mode","ChartData","defaults","labels","series","bezierCurve","elements","line","tension","scaleLabel","tooltipTemplate","scales","yAxes","gridLines","display","callbacks","tooltips","title","tooltipItems","tooltipItem","datasets","datasetIndex","datasetLabel","points","evt","datasetOverride","service","natives","intersections"],"mappings":"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","file":"report.min.js","sourcesContent":["\n(function(window, angular) {'use strict';\n\n/* global angular */\r\n\r\nvar module = angular.module('reports', ['ng', 'ngSanitize', 'ngMessages']);\r\n\n/* global angular, module */\r\n\r\nwindow.console ? null : window.console = { log: function () { } };\r\n\r\n/*\r\nwindow.domain = '//' + location.hostname + (location.port ? ':' + location.port : ''); // location.protocol + \r\nmodule.constant('domain', domain);\r\n*/\r\n\r\nmodule.constant('colTypes', {\r\n    ID: 1,\r\n    IDS: 2,\r\n    TITLE: 3,\r\n    DATE: 4,\r\n    CUSTOMER: 5,\r\n    RESOURCE: 6,\r\n    STATUS: 7,\r\n    STATUSSM: 8,\r\n    FAMILY: 9,\r\n    NUMBER: 10,\r\n    HOURS: 11,\r\n    COSTS: 12,\r\n    PERCENT: 13,\r\n    INCREMENT: 14,\r\n    ICON: 15,\r\n    BUTTONS: 16,\r\n    DISABLED: 17,\r\n    LINK: 18,\r\n    BOOL: 19,\r\n    DOUBLE: 20,\r\n    WEEKS: 21,\r\n});\r\n\n/* global angular, module */\r\n\n/* global angular, module */\r\n\r\nvar aid = 0; // application unique id counter using for dev\r\n\r\nmodule.directive('state', ['$timeout', function ($timeout) {\r\n    return {\r\n        restrict: 'EA',\r\n        template: '<button type=\"button\" class=\"btn btn-sm btn-primary btn-block-md-down\" ng-class=\"stateClass()\" ng-disabled=\"stateDisabled()\"><span ng-transclude></span></button>',\r\n        transclude: true,\r\n        replace: true,\r\n        scope: {\r\n            state: '=',\r\n        },\r\n        link: function (scope, element, attributes, model) {\r\n            scope.stateClass = function () {\r\n                if (scope.state.button === element) {\r\n                    var sclass = {\r\n                        busy: scope.state.isBusy,\r\n                        successing: scope.state.isSuccessing,\r\n                        success: scope.state.isSuccess,\r\n                        errorring: scope.state.isErroring,\r\n                        error: scope.state.isError,\r\n                    };\r\n                    // console.log('stateClass', sclass);\r\n                    return sclass;\r\n                } else {\r\n                    return null;\r\n                }\r\n            };\r\n            scope.stateDisabled = function () {\r\n                var disabled = (scope.state.button && scope.state.button !== element); // || scope.$parent.$eval(attributes.onValidate);\r\n                // console.log('stateDisabled', disabled);\r\n                return disabled;\r\n            };\r\n            function onClick() {\r\n                $timeout(function () {\r\n                    if (!scope.$parent.$eval(attributes.onValidate)) {\r\n                        console.log('state.onClick', attributes.onValidate, attributes.onClick);\r\n                        scope.state.button = element;\r\n                        return scope.$parent.$eval(attributes.onClick);\r\n                    } else {\r\n                        scope.$parent.$eval('form.$setSubmitted()');\r\n                    }\r\n                });\r\n            };\r\n            function addListeners() {\r\n                element.on('touchstart click', onClick);\r\n            };\r\n            function removeListeners() {\r\n                element.off('touchstart click', onClick);\r\n            };\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n            });\r\n            addListeners();\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.directive('sortable', ['$timeout', function ($timeout) {    \r\n    return {\r\n        restrict: 'A',\r\n        scope: {\r\n            source: '=sortable',\r\n            key: '@sortableKey',\r\n            sort: '=?',\r\n        },\r\n        template: '<th ng-class=\"{ \\'sorted-up\\': sort == 1, \\'sorted-down\\': sort == -1 }\" ng-transclude></th>',\r\n        transclude: true,\r\n        replace: true,\r\n        link: function (scope, element, attributes, model) {\r\n            scope.sort = scope.sort || 0;\r\n            function onSort() {\r\n                scope.sort = scope.source.getSort(scope.key);\r\n                // console.log('sortable.onSort', scope.key, scope.source.filters.sort);\r\n            }\r\n            scope.$watchCollection('source.filters.sort', onSort);\r\n            onSort();\r\n            function onTap() {\r\n                if (scope.source.state.enabled()) {\r\n                    var sort = scope.sort ? (scope.sort * -1) : 1;\r\n                    scope.source.setSort(scope.key, sort).then(function (response) {\r\n                        scope.sort = sort;\r\n                    });\r\n                }\r\n            }\r\n            function addListeners() {\r\n                element.on('touchstart click', onTap);\r\n            };\r\n            function removeListeners() {\r\n                element.off('touchstart click', onTap);\r\n            };\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n            });\r\n            addListeners();\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.directive('draggableItem', ['$parse', '$timeout', 'Utils', 'Style', 'ElementRect', 'Droppables', function ($parse, $timeout, Utils, Style, ElementRect, Droppables) {\r\n\r\n    return {\r\n        require: 'ngModel',\r\n        link: function (scope, element, attributes, model) {\r\n            var nativeElement = element[0];\r\n            var selector = attributes.draggableItem || '.item';\r\n            var condition = attributes.draggableIf !== undefined ? $parse(attributes.draggableIf) : function () { return true; };\r\n            var target = nativeElement.querySelector(selector);\r\n            var style = new Style();\r\n            var elementRect = new ElementRect();\r\n            var down, move, diff, dragging, rects;\r\n            function onStart(e) {\r\n                if (condition(scope)) {\r\n                    down = Utils.getTouch(e);\r\n                    addDragListeners();\r\n                }\r\n                return false;\r\n            }\r\n            function onMove(e) {\r\n                move = Utils.getTouch(e);\r\n                diff = down.difference(move);\r\n                if (!dragging && diff.power() > 25) {\r\n                    dragging = true;\r\n                    element.addClass('dragging');\r\n                }\r\n                if (dragging) {\r\n                    style.transform = 'translateX(' + diff.x + 'px) translateY(' + diff.y + 'px)';\r\n                    style.set(target);\r\n                    elementRect.set(nativeElement).offset(diff);\r\n                    rects = Droppables.getIntersections(elementRect);\r\n                    if (rects.length) {\r\n                        angular.element(rects[0].native).addClass('dropping');\r\n                    }\r\n                }\r\n                // console.log(diff);\r\n                return false;\r\n            }\r\n            function onEnd(e) {\r\n                if (dragging) {\r\n                    dragging = false;\r\n                    element.removeClass('dragging');\r\n                    style.transform = 'none';\r\n                    style.set(target);\r\n                    var fromIndex = $parse(attributes.droppableIndex)(scope);\r\n                    var fromModel = $parse(attributes.ngModel)(scope);\r\n                    if (rects.length) {\r\n                        var event = null;\r\n                        angular.forEach(rects, function (rect, index) {\r\n                            angular.element(rect.native).removeClass('dropping over');\r\n                            if (rect.data.droppable(scope) && !event) {\r\n                                event = {\r\n                                    from: {\r\n                                        index: fromIndex,\r\n                                        model: fromModel,\r\n                                        target: target,\r\n                                    },\r\n                                    to: {\r\n                                        index: rect.data.index,\r\n                                        model: rect.data.model,\r\n                                        target: rect.native\r\n                                    },\r\n                                };\r\n                                $timeout(function () {\r\n                                    scope.$emit('onDropItem', event);\r\n                                });\r\n                            }\r\n                        });\r\n                    } else {\r\n                        var event = {\r\n                            from: {\r\n                                index: fromIndex,\r\n                                model: fromModel,\r\n                                target: target,\r\n                            },\r\n                            to: null,\r\n                        };\r\n                        $timeout(function () {\r\n                            scope.$emit('onDropOut', event);\r\n                        });\r\n                    }\r\n                }\r\n                removeDragListeners();\r\n                return false;\r\n            }\r\n            function addDragListeners() {\r\n                angular.element(window).on('touchmove mousemove', onMove);\r\n                angular.element(window).on('touchend mouseup', onEnd);\r\n            };\r\n            function removeDragListeners() {\r\n                angular.element(window).off('touchmove mousemove', onMove);\r\n                angular.element(window).off('touchend mouseup', onEnd);\r\n            };\r\n            function addListeners() {\r\n                element.on('touchstart mousedown', onStart);\r\n            };\r\n            function removeListeners() {\r\n                element.off('touchstart mousedown', onStart);\r\n            };\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n            });\r\n            addListeners();\r\n        }\r\n    };\r\n}]);\r\n\r\nmodule.directive('droppableItem', ['$parse', 'Utils', 'Style', 'Droppables', function ($parse, Utils, Style, Droppables) {\r\n    var droppables = {};\r\n    return {\r\n        require: 'ngModel',\r\n        link: function (scope, element, attributes, model) {\r\n            var nativeElement = element[0];\r\n            var selector = attributes.droppableItem || '.item';\r\n            function onGetData() {\r\n                var index = $parse(attributes.droppableIndex)(scope);\r\n                var model = $parse(attributes.ngModel)(scope);\r\n                var droppable = attributes.droppableIf !== undefined ? $parse(attributes.droppableIf) : function () { return true };\r\n                return {\r\n                    index: index,\r\n                    model: model,\r\n                    droppable: droppable,\r\n                };\r\n            }\r\n            Droppables.add(nativeElement, onGetData);\r\n            scope.$on('$destroy', function () {\r\n                Droppables.remove(nativeElement);\r\n            });\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.directive('onClickOut', ['$document', '$parse', '$timeout', 'Utils', function ($document, $parse, $timeout, Utils) {\r\n    return {\r\n        restrict: 'A',\r\n        link: function (scope, element, attributes, model) {\r\n            function onClick(e) {\r\n                if (Utils.getClosestElement(e.target, element[0]) === null) {\r\n                    $timeout(function () {                    \r\n                        console.log('onClickOut', attributes.onClickOut, scope.cols.showValues);\r\n                        var onClickOut = $parse(attributes.onClickOut);\r\n                        onClickOut(scope);\r\n                    });\r\n                }\r\n            }\r\n            function addListeners() {\r\n                angular.element($document).on('click', onClick);\r\n            };\r\n            function removeListeners() {\r\n                angular.element($document).off('click', onClick);\r\n            };\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n            });\r\n            addListeners();\r\n        }\r\n    };\r\n}]);\r\n\r\nmodule.directive('toggler', ['$document', '$parse', '$timeout', 'Utils', function ($document, $parse, $timeout, Utils) {\r\n    return {\r\n        restrict: 'A',\r\n        link: function (scope, element, attributes, model) {\r\n            if (attributes.value === undefined) {\r\n                throw new Error('[toggler] attribute value required');\r\n            }\r\n            if (attributes.target === undefined) {\r\n                throw new Error('[toggler] attribute target required');\r\n            }\r\n            function isActive() {\r\n                return $parse(attributes.toggler + '==' + attributes.value)(scope);\r\n            }\r\n            function activate() {\r\n                addOutListeners();\r\n                $timeout(function () {\r\n                    $parse(attributes.toggler + '=' + attributes.value)(scope);\r\n                });\r\n            }\r\n            function deactivate() {\r\n                removeOutListeners();\r\n                $timeout(function () {\r\n                    $parse(attributes.toggler + '=null')(scope);\r\n                });\r\n            }\r\n            function onClick(e) {\r\n                setTimeout(function () {\r\n                    if (isActive()) {\r\n                        deactivate();\r\n                    } else {\r\n                        activate();\r\n                    }\r\n                }, 100);\r\n            }\r\n            function onClickOut(e) {\r\n                if (isActive()\r\n                    && Utils.getClosestElement(e.target, element[0]) === null\r\n                    && Utils.getClosest(e.target, attributes.target) === null) {\r\n                    deactivate();\r\n                }\r\n            }\r\n            function addOutListeners() {\r\n                angular.element($document).on('click', onClickOut);\r\n            };\r\n            function removeOutListeners() {\r\n                angular.element($document).off('click', onClickOut);\r\n            };\r\n            function addListeners() {\r\n                element.on('click', onClick);\r\n            };\r\n            function removeListeners() {\r\n                element.off('click', onClick);\r\n            };\r\n            scope.$on('$destroy', function () {\r\n                removeListeners();\r\n                removeOutListeners();\r\n            });\r\n            addListeners();\r\n        }\r\n    };\r\n}]);\r\n\n/* global angular, module */\r\n\r\nmodule.filter('shortName', ['$filter', function ($filter) {\r\n    function toTitleCase(str) {\r\n        return str.replace(/\\w\\S*/g, function (txt) { return txt.charAt(0).toUpperCase() + txt.substr(1).toLowerCase(); });\r\n    }\r\n    return function (value) {\r\n        if (!value) {\r\n            return '';\r\n        }\r\n        if (value.indexOf(' .') === value.length - 2) {\r\n            value = value.split(' .').join('');\r\n        }\r\n        /*\r\n        var splitted;\r\n        if (value.indexOf('.') !== -1) {\r\n            splitted = value.split('.');\r\n        } else {\r\n            splitted = value.split(' ');\r\n        }\r\n        */\r\n        var splitted = value.split(' ');\r\n        var firstName = splitted.shift();\r\n        if (splitted.length) {\r\n            var lastName = splitted.join(' ');\r\n            return firstName.substr(0, 1).toUpperCase() + '.' + toTitleCase(lastName);\r\n        } else {\r\n            return firstName;\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customCurrency', ['$filter', function ($filter) {\r\n    var legacyFilter = $filter('currency');\r\n    return function (cost, currency) {\r\n        return legacyFilter(cost * currency.ratio, currency.formatting);\r\n    }\r\n}]);\r\n\r\nmodule.filter('customNumber', ['$filter', function ($filter) {\r\n    var filter = $filter('number');\r\n    return function (value, precision, unit) {\r\n        unit = unit || '';\r\n        return (value ? filter(value, precision) + unit : '-');\r\n    }\r\n}]);\r\n\r\nmodule.filter('customHours', [function () {\r\n    return function (value) {\r\n        if (value) {\r\n            var hours = Math.floor(value);\r\n            var minutes = Math.floor((value - hours) * 60);\r\n            var label = hours ? hours + ' H' : '';\r\n            label += minutes ? ' ' + minutes + ' m' : '';\r\n            return label;\r\n        } else {\r\n            return '-';\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customDate', ['$filter', function ($filter) {\r\n    var filter = $filter('date');\r\n    return function (value, format, timezone) {\r\n        return value ? filter(value, format, timezone) : '-';\r\n    }\r\n}]);\r\n\r\nmodule.filter('customTime', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        if (value) {\r\n            return Utils.parseTime(value);\r\n        } else {\r\n            return (placeholder ? placeholder : '-');\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customDigital', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        if (value) {\r\n            return Utils.parseHour(value);\r\n        } else {\r\n            return (placeholder ? placeholder : '-');\r\n        }\r\n    }\r\n}]);\r\n\r\nmodule.filter('customString', ['$filter', function ($filter) {\r\n    return function (value, placeholder) {\r\n        return value ? value : (placeholder ? placeholder : '-');\r\n    }\r\n}]);\r\n\r\nmodule.filter('customEnum', function () {\r\n    return function (val) {\r\n        val = val + 1;\r\n        return val < 10 ? '0' + val : val;\r\n    };\r\n});\r\n\r\nmodule.filter('groupBy', ['$parse', 'filterWatcher', function ($parse, filterWatcher) {\r\n    function _groupBy(collection, getter) {\r\n        var dict = {};\r\n        var key;\r\n        angular.forEach(collection, function (item) {\r\n            key = getter(item);\r\n            if (!dict[key]) {\r\n                dict[key] = [];\r\n            }\r\n            dict[key].push(item);\r\n        });\r\n        return dict;\r\n    }\r\n    return function (collection, property) {\r\n        if (!angular.isObject(collection) || angular.isUndefined(property)) {\r\n            return collection;\r\n        }\r\n        return filterWatcher.isMemoized('groupBy', arguments) || filterWatcher.memoize('groupBy', arguments, this, _groupBy(collection, $parse(property)));        \r\n    }\r\n}]);\r\n\r\nmodule.provider('filterWatcher', function () {\r\n    function isNull(value) {\r\n        return value === null;\r\n    }\r\n    function isScope(obj) {\r\n        return obj && obj.$evalAsync && obj.$watch;\r\n    }\r\n    this.$get = ['$window', '$rootScope', function ($window, $rootScope) {\r\n        var $$cache = {};\r\n        var $$listeners = {};\r\n        var $$timeout = $window.setTimeout;\r\n        function getHashKey(fName, args) {\r\n            function replacerFactory() {\r\n                var cache = [];\r\n                return function (key, val) {\r\n                    if (angular.isObject(val) && !isNull(val)) {\r\n                        if (~cache.indexOf(val)) {\r\n                            return '[Circular]';\r\n                        }\r\n                        cache.push(val);\r\n                    }\r\n                    if ($window == val) return '$WINDOW';\r\n                    if ($window.document == val) return '$DOCUMENT';\r\n                    if (isScope(val)) return '$SCOPE';\r\n                    return val;\r\n                }\r\n            }\r\n            return [fName, JSON.stringify(args, replacerFactory())]\r\n              .join('#')\r\n              .replace(/\"/g, '');\r\n        }\r\n        function removeCache(event) {\r\n            var id = event.targetScope.$id;\r\n            angular.forEach($$listeners[id], function (key) {\r\n                delete $$cache[key];\r\n            });\r\n            delete $$listeners[id];\r\n        }\r\n        function cleanStateless() {\r\n            $$timeout(function () {\r\n                if (!$rootScope.$$phase) {\r\n                    $$cache = {};\r\n                }\r\n            }, 2000);\r\n        }\r\n        function addListener(scope, hashKey) {\r\n            var id = scope.$id;\r\n            if (angular.isUndefined($$listeners[id])) {\r\n                scope.$on('$destroy', removeCache);\r\n                $$listeners[id] = [];\r\n            }\r\n            return $$listeners[id].push(hashKey);\r\n        }\r\n        function $$isMemoized(filterName, args) {\r\n            var hashKey = getHashKey(filterName, args);\r\n            return $$cache[hashKey];\r\n        }\r\n        function $$memoize(filterName, args, scope, result) {\r\n            var hashKey = getHashKey(filterName, args);\r\n            //store result in `$$cache` container\r\n            $$cache[hashKey] = result;\r\n            // for angular versions that less than 1.3\r\n            // add to `$destroy` listener, a cleaner callback\r\n            if (isScope(scope)) {\r\n                addListener(scope, hashKey);\r\n            } else {\r\n                cleanStateless();\r\n            }\r\n            return result;\r\n        }\r\n        return {\r\n            isMemoized: $$isMemoized,\r\n            memoize: $$memoize\r\n        }\r\n    }];\r\n});\r\n\n/* global angular, module */\r\n\r\nmodule.factory('Animate', [function () {\r\n    function Animate(callback, useTimeout) {\r\n        this.callback = callback;\r\n        this.isPlaying = false;\r\n        this.key = null;\r\n        this.ticks = 0;\r\n        this.useTimeout = useTimeout === true ? true : false;\r\n    }\r\n    Animate.prototype = {\r\n        play: function () {\r\n            var _this = this;\r\n            function loop(time) {\r\n                _this.ticks++;\r\n                _this.callback(time, _this.ticks);\r\n                if (this.useTimeout) {\r\n                    _this.key = window.setTimeout(loop, 1000 / 60);\r\n                } else {\r\n                    _this.key = window.requestAnimationFrame(loop);\r\n                }\r\n            }\r\n            if (!this.key) {\r\n                this.isPlaying = true;\r\n                loop();\r\n            }\r\n        },\r\n        pause: function () {\r\n            if (this.key) {\r\n                if (this.useTimeout) {\r\n                    window.clearTimeout(this.key);\r\n                } else {\r\n                    window.cancelAnimationFrame(this.key);\r\n                }\r\n                this.key = null;\r\n                this.isPlaying = false;\r\n            }\r\n        },\r\n        playpause: function () {\r\n            if (this.key) {\r\n                this.pause();\r\n            } else {\r\n                this.play();\r\n            }\r\n        }\r\n    }\r\n    return Animate;\r\n}]);\r\n\r\nmodule.factory('Md5', [function () {\r\n\r\n    var hex_chr = '0123456789abcdef'.split('');\r\n\r\n    function cycle(x, k) {\r\n        var a = x[0], b = x[1], c = x[2], d = x[3];\r\n\r\n        a = ff(a, b, c, d, k[0], 7, -680876936);\r\n        d = ff(d, a, b, c, k[1], 12, -389564586);\r\n        c = ff(c, d, a, b, k[2], 17, 606105819);\r\n        b = ff(b, c, d, a, k[3], 22, -1044525330);\r\n        a = ff(a, b, c, d, k[4], 7, -176418897);\r\n        d = ff(d, a, b, c, k[5], 12, 1200080426);\r\n        c = ff(c, d, a, b, k[6], 17, -1473231341);\r\n        b = ff(b, c, d, a, k[7], 22, -45705983);\r\n        a = ff(a, b, c, d, k[8], 7, 1770035416);\r\n        d = ff(d, a, b, c, k[9], 12, -1958414417);\r\n        c = ff(c, d, a, b, k[10], 17, -42063);\r\n        b = ff(b, c, d, a, k[11], 22, -1990404162);\r\n        a = ff(a, b, c, d, k[12], 7, 1804603682);\r\n        d = ff(d, a, b, c, k[13], 12, -40341101);\r\n        c = ff(c, d, a, b, k[14], 17, -1502002290);\r\n        b = ff(b, c, d, a, k[15], 22, 1236535329);\r\n\r\n        a = gg(a, b, c, d, k[1], 5, -165796510);\r\n        d = gg(d, a, b, c, k[6], 9, -1069501632);\r\n        c = gg(c, d, a, b, k[11], 14, 643717713);\r\n        b = gg(b, c, d, a, k[0], 20, -373897302);\r\n        a = gg(a, b, c, d, k[5], 5, -701558691);\r\n        d = gg(d, a, b, c, k[10], 9, 38016083);\r\n        c = gg(c, d, a, b, k[15], 14, -660478335);\r\n        b = gg(b, c, d, a, k[4], 20, -405537848);\r\n        a = gg(a, b, c, d, k[9], 5, 568446438);\r\n        d = gg(d, a, b, c, k[14], 9, -1019803690);\r\n        c = gg(c, d, a, b, k[3], 14, -187363961);\r\n        b = gg(b, c, d, a, k[8], 20, 1163531501);\r\n        a = gg(a, b, c, d, k[13], 5, -1444681467);\r\n        d = gg(d, a, b, c, k[2], 9, -51403784);\r\n        c = gg(c, d, a, b, k[7], 14, 1735328473);\r\n        b = gg(b, c, d, a, k[12], 20, -1926607734);\r\n\r\n        a = hh(a, b, c, d, k[5], 4, -378558);\r\n        d = hh(d, a, b, c, k[8], 11, -2022574463);\r\n        c = hh(c, d, a, b, k[11], 16, 1839030562);\r\n        b = hh(b, c, d, a, k[14], 23, -35309556);\r\n        a = hh(a, b, c, d, k[1], 4, -1530992060);\r\n        d = hh(d, a, b, c, k[4], 11, 1272893353);\r\n        c = hh(c, d, a, b, k[7], 16, -155497632);\r\n        b = hh(b, c, d, a, k[10], 23, -1094730640);\r\n        a = hh(a, b, c, d, k[13], 4, 681279174);\r\n        d = hh(d, a, b, c, k[0], 11, -358537222);\r\n        c = hh(c, d, a, b, k[3], 16, -722521979);\r\n        b = hh(b, c, d, a, k[6], 23, 76029189);\r\n        a = hh(a, b, c, d, k[9], 4, -640364487);\r\n        d = hh(d, a, b, c, k[12], 11, -421815835);\r\n        c = hh(c, d, a, b, k[15], 16, 530742520);\r\n        b = hh(b, c, d, a, k[2], 23, -995338651);\r\n\r\n        a = ii(a, b, c, d, k[0], 6, -198630844);\r\n        d = ii(d, a, b, c, k[7], 10, 1126891415);\r\n        c = ii(c, d, a, b, k[14], 15, -1416354905);\r\n        b = ii(b, c, d, a, k[5], 21, -57434055);\r\n        a = ii(a, b, c, d, k[12], 6, 1700485571);\r\n        d = ii(d, a, b, c, k[3], 10, -1894986606);\r\n        c = ii(c, d, a, b, k[10], 15, -1051523);\r\n        b = ii(b, c, d, a, k[1], 21, -2054922799);\r\n        a = ii(a, b, c, d, k[8], 6, 1873313359);\r\n        d = ii(d, a, b, c, k[15], 10, -30611744);\r\n        c = ii(c, d, a, b, k[6], 15, -1560198380);\r\n        b = ii(b, c, d, a, k[13], 21, 1309151649);\r\n        a = ii(a, b, c, d, k[4], 6, -145523070);\r\n        d = ii(d, a, b, c, k[11], 10, -1120210379);\r\n        c = ii(c, d, a, b, k[2], 15, 718787259);\r\n        b = ii(b, c, d, a, k[9], 21, -343485551);\r\n\r\n        x[0] = add32(a, x[0]);\r\n        x[1] = add32(b, x[1]);\r\n        x[2] = add32(c, x[2]);\r\n        x[3] = add32(d, x[3]);\r\n\r\n    }\r\n\r\n    function cmn(q, a, b, x, s, t) {\r\n        a = add32(add32(a, q), add32(x, t));\r\n        return add32((a << s) | (a >>> (32 - s)), b);\r\n    }\r\n\r\n    function ff(a, b, c, d, x, s, t) {\r\n        return cmn((b & c) | ((~b) & d), a, b, x, s, t);\r\n    }\r\n\r\n    function gg(a, b, c, d, x, s, t) {\r\n        return cmn((b & d) | (c & (~d)), a, b, x, s, t);\r\n    }\r\n\r\n    function hh(a, b, c, d, x, s, t) {\r\n        return cmn(b ^ c ^ d, a, b, x, s, t);\r\n    }\r\n\r\n    function ii(a, b, c, d, x, s, t) {\r\n        return cmn(c ^ (b | (~d)), a, b, x, s, t);\r\n    }\r\n\r\n    function md51(s) {\r\n        var txt = '';\r\n        var n = s.length,\r\n        state = [1732584193, -271733879, -1732584194, 271733878], i;\r\n        for (i = 64; i <= s.length; i += 64) {\r\n            cycle(state, md5blk(s.substring(i - 64, i)));\r\n        }\r\n        s = s.substring(i - 64);\r\n        var tail = [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0];\r\n        for (i = 0; i < s.length; i++)\r\n            tail[i >> 2] |= s.charCodeAt(i) << ((i % 4) << 3);\r\n        tail[i >> 2] |= 0x80 << ((i % 4) << 3);\r\n        if (i > 55) {\r\n            cycle(state, tail);\r\n            for (i = 0; i < 16; i++) tail[i] = 0;\r\n        }\r\n        tail[14] = n * 8;\r\n        cycle(state, tail);\r\n        return state;\r\n    }\r\n\r\n    /* there needs to be support for Unicode here,\r\n        * unless we pretend that we can redefine the MD-5\r\n        * algorithm for multi-byte characters (perhaps\r\n        * by adding every four 16-bit characters and\r\n        * shortening the sum to 32 bits). Otherwise\r\n        * I suggest performing MD-5 as if every character\r\n        * was two bytes--e.g., 0040 0025 = @%--but then\r\n        * how will an ordinary MD-5 sum be matched?\r\n        * There is no way to standardize text to something\r\n        * like UTF-8 before transformation; speed cost is\r\n        * utterly prohibitive. The JavaScript standard\r\n        * itself needs to look at this: it should start\r\n        * providing access to strings as preformed UTF-8\r\n        * 8-bit unsigned value arrays.\r\n        */\r\n    function md5blk(s) { /* I figured global was faster.   */\r\n        var md5blks = [], i; /* Andy King said do it this way. */\r\n        for (i = 0; i < 64; i += 4) {\r\n            md5blks[i >> 2] = s.charCodeAt(i)\r\n            + (s.charCodeAt(i + 1) << 8)\r\n            + (s.charCodeAt(i + 2) << 16)\r\n            + (s.charCodeAt(i + 3) << 24);\r\n        }\r\n        return md5blks;\r\n    }\r\n\r\n    function rhex(n) {\r\n        var s = '', j = 0;\r\n        for (; j < 4; j++)\r\n            s += hex_chr[(n >> (j * 8 + 4)) & 0x0F]\r\n            + hex_chr[(n >> (j * 8)) & 0x0F];\r\n        return s;\r\n    }\r\n\r\n    function hex(x) {\r\n        for (var i = 0; i < x.length; i++)\r\n            x[i] = rhex(x[i]);\r\n        return x.join('');\r\n    }\r\n\r\n    /* this function is much faster,\r\n    so if possible we use it. Some IEs\r\n    are the only ones I know of that\r\n    need the idiotic second function,\r\n    generated by an if clause.  */\r\n    function add32(a, b) {\r\n        return (a + b) & 0xFFFFFFFF;\r\n    }\r\n\r\n    function Md5() { }\r\n    Md5.encode = function (string) {\r\n        return hex(md51(string));\r\n    }\r\n    if (Md5.encode('hello') !== '5d41402abc4b2a76b9719d911017c592') {\r\n        add32 = function (x, y) {\r\n            var lsw = (x & 0xFFFF) + (y & 0xFFFF),\r\n            msw = (x >> 16) + (y >> 16) + (lsw >> 16);\r\n            return (msw << 16) | (lsw & 0xFFFF);\r\n        }\r\n    }\r\n    return Md5;\r\n}]);\r\n\r\nmodule.factory('Utils', ['$compile', '$controller', 'Vector', 'Md5', function ($compile, $controller, Vector, Md5) {\r\n    (function () {\r\n        // POLYFILL window.requestAnimationFrame\r\n        var lastTime = 0;\r\n        var vendors = ['ms', 'moz', 'webkit', 'o'];\r\n        for (var x = 0; x < vendors.length && !window.requestAnimationFrame; ++x) {\r\n            window.requestAnimationFrame = window[vendors[x] + 'RequestAnimationFrame'];\r\n            window.cancelAnimationFrame = window[vendors[x] + 'CancelAnimationFrame']\r\n                                       || window[vendors[x] + 'CancelRequestAnimationFrame'];\r\n        }\r\n        if (!window.requestAnimationFrame) {\r\n            window.requestAnimationFrame = function (callback, element) {\r\n                var currTime = new Date().getTime();\r\n                var timeToCall = Math.max(0, 16 - (currTime - lastTime));\r\n                var id = window.setTimeout(function () { callback(currTime + timeToCall); }, timeToCall);\r\n                lastTime = currTime + timeToCall;\r\n                return id;\r\n            };\r\n        }\r\n        if (!window.cancelAnimationFrame) {\r\n            window.cancelAnimationFrame = function (id) {\r\n                clearTimeout(id);\r\n            };\r\n        }\r\n    }());\r\n    (function () {\r\n        // POLYFILL Array.prototype.reduce\r\n        // Production steps of ECMA-262, Edition 5, 15.4.4.21\r\n        // Reference: http://es5.github.io/#x15.4.4.21\r\n        // https://tc39.github.io/ecma262/#sec-array.prototype.reduce\r\n        if (!Array.prototype.reduce) {\r\n            Object.defineProperty(Array.prototype, 'reduce', {\r\n                value: function (callback) {// , initialvalue\r\n                    if (this === null) {\r\n                        throw new TypeError('Array.prototype.reduce called on null or undefined');\r\n                    }\r\n                    if (typeof callback !== 'function') {\r\n                        throw new TypeError(callback + ' is not a function');\r\n                    }\r\n                    var o = Object(this);\r\n                    var len = o.length >>> 0;\r\n                    var k = 0;\r\n                    var value;\r\n                    if (arguments.length == 2) {\r\n                        value = arguments[1];\r\n                    } else {\r\n                        while (k < len && !(k in o)) {\r\n                            k++;\r\n                        }\r\n                        if (k >= len) {\r\n                            throw new TypeError('Reduce of empty array with no initial value');\r\n                        }\r\n                        value = o[k++];\r\n                    }\r\n                    while (k < len) {\r\n                        if (k in o) {\r\n                            value = callback(value, o[k], k, o);\r\n                        }\r\n                        k++;\r\n                    }\r\n                    return value;\r\n                }\r\n            });\r\n        }\r\n    }());\r\n    var _isTouch;\r\n    function isTouch() {\r\n        if (!_isTouch) {\r\n            _isTouch = {\r\n                value: ('ontouchstart' in window || 'onmsgesturechange' in window)\r\n            }\r\n        }\r\n        // console.log(_isTouch);\r\n        return _isTouch.value;\r\n    }\r\n    function getTouch(e, previous) {\r\n        var t = new Vector();\r\n        if (e.type == 'touchstart' || e.type == 'touchmove' || e.type == 'touchend' || e.type == 'touchcancel') {\r\n            var touch = null;\r\n            var event = e.originalEvent ? e.originalEvent : e;\r\n            var touches = event.touches.length ? event.touches : event.changedTouches;\r\n            if (touches && touches.length) {\r\n                touch = touches[0];\r\n            }\r\n            if (touch) {\r\n                t.x = touch.pageX;\r\n                t.y = touch.pageY;\r\n            }\r\n        } else if (e.type == 'click' || e.type == 'mousedown' || e.type == 'mouseup' || e.type == 'mousemove' || e.type == 'mouseover' || e.type == 'mouseout' || e.type == 'mouseenter' || e.type == 'mouseleave') {\r\n            t.x = e.pageX;\r\n            t.y = e.pageY;\r\n        }\r\n        if (previous) {\r\n            t.s = Vector.difference(previous, t);\r\n        }\r\n        t.type = e.type;\r\n        return t;\r\n    }\r\n    function getRelativeTouch(element, point) {\r\n        var rect = element[0].getBoundingClientRect();\r\n        var e = new Vector(rect.left, rect.top);\r\n        return Vector.difference(e, point);\r\n    }\r\n    function getClosest(el, selector) {\r\n        var matchesFn, parent;\r\n        ['matches', 'webkitMatchesSelector', 'mozMatchesSelector', 'msMatchesSelector', 'oMatchesSelector'].some(function (fn) {\r\n            if (typeof document.body[fn] == 'function') {\r\n                matchesFn = fn;\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n        if (el[matchesFn](selector)) {\r\n            return el;\r\n        }\r\n        while (el !== null) {\r\n            parent = el.parentElement;\r\n            if (parent !== null && parent[matchesFn](selector)) {\r\n                return parent;\r\n            }\r\n            el = parent;\r\n        }\r\n        return null;\r\n    }\r\n    function getClosestElement(el, target) {\r\n        var matchesFn, parent;\r\n        if (el === target) {\r\n            return el;\r\n        }\r\n        while (el !== null) {\r\n            parent = el.parentElement;\r\n            if (parent !== null && parent === target) {\r\n                return parent;\r\n            }\r\n            el = parent;\r\n        }\r\n        return null;\r\n    }\r\n    var getNow = Date.now || function () {\r\n        return new Date().getTime();\r\n    };\r\n    function throttle(func, wait, options) {\r\n        // Returns a function, that, when invoked, will only be triggered at most once\r\n        // during a given window of time. Normally, the throttled function will run\r\n        // as much as it can, without ever going more than once per `wait` duration;\r\n        // but if you'd like to disable the execution on the leading edge, pass\r\n        // `{leading: false}`. To disable execution on the trailing edge, ditto.\r\n        var context, args, result;\r\n        var timeout = null;\r\n        var previous = 0;\r\n        if (!options) options = {};\r\n        var later = function () {\r\n            previous = options.leading === false ? 0 : getNow();\r\n            timeout = null;\r\n            result = func.apply(context, args);\r\n            if (!timeout) context = args = null;\r\n        };\r\n        return function () {\r\n            var now = getNow();\r\n            if (!previous && options.leading === false) previous = now;\r\n            var remaining = wait - (now - previous);\r\n            context = this;\r\n            args = arguments;\r\n            if (remaining <= 0 || remaining > wait) {\r\n                if (timeout) {\r\n                    clearTimeout(timeout);\r\n                    timeout = null;\r\n                }\r\n                previous = now;\r\n                result = func.apply(context, args);\r\n                if (!timeout) context = args = null;\r\n            } else if (!timeout && options.trailing !== false) {\r\n                timeout = setTimeout(later, remaining);\r\n            }\r\n            return result;\r\n        };\r\n    }\r\n    function where(array, query) {\r\n        var found = null;\r\n        if (array) {\r\n            angular.forEach(array, function (item) {\r\n                var has = true;\r\n                angular.forEach(query, function (value, key) {\r\n                    has = has && item[key] === value;\r\n                });\r\n                if (has) {\r\n                    found = item;\r\n                }\r\n            });\r\n        }\r\n        return found;\r\n    }\r\n    function compileController(scope, element, html, data) {\r\n        // console.log('Utils.compileController', element);\r\n        element.html(html);\r\n        var link = $compile(element.contents());\r\n        if (data.controller) {\r\n            var $scope = scope.$new();\r\n            angular.extend($scope, data);\r\n            var controller = $controller(data.controller, { $scope: $scope });\r\n            if (data.controllerAs) {\r\n                scope[data.controllerAs] = controller;\r\n            }\r\n            element.data('$ngControllerController', controller);\r\n            element.children().data('$ngControllerController', controller);\r\n            scope = $scope;\r\n        }\r\n        link(scope);\r\n    }\r\n    var ua = window.navigator.userAgent.toLowerCase();\r\n    var safari = ua.indexOf('safari') !== -1 && ua.indexOf('chrome') === -1;\r\n    var msie = ua.indexOf('trident') !== -1 || ua.indexOf('edge') !== -1 || ua.indexOf('msie') !== -1;\r\n    var chrome = !safari && !msie && ua.indexOf('chrome') !== -1;\r\n    var mobile = ua.indexOf('mobile') !== -1;\r\n    function Utils() {\r\n    }\r\n    function reverseSortOn(key) {\r\n        return function (a, b) {\r\n            if (a[key] < b[key]) {\r\n                return 1;\r\n            }\r\n            if (a[key] > b[key]) {\r\n                return -1;\r\n            }\r\n            // a must be equal to b\r\n            return 0;\r\n        }\r\n    }\r\n    function format(string, prepend, expression) {\r\n        string = string || '';\r\n        prepend = prepend || '';\r\n        var splitted = string.split(',');\r\n        if (splitted.length > 1) {\r\n            var formatted = splitted.shift();\r\n            angular.forEach(splitted, function (value, index) {\r\n                if (expression) {\r\n                    formatted = formatted.split('{' + index + '}').join('\\' + ' + prepend + value + ' + \\'');\r\n                } else {\r\n                    formatted = formatted.split('{' + index + '}').join(prepend + value);\r\n                }\r\n            });\r\n            if (expression) {\r\n                return '\\'' + formatted + '\\'';\r\n            } else {\r\n                return formatted;\r\n            }\r\n        } else {\r\n            return prepend + string;\r\n        }\r\n    }\r\n    function reducer(o, key) {\r\n        return o[key];\r\n    }\r\n    function reducerSetter(o, key, value) {\r\n        if (typeof key == 'string') {\r\n            return reducerSetter(o, key.split('.'), value);\r\n        } else if (key.length == 1 && value !== undefined) {\r\n            return o[key[0]] = value;\r\n        } else if (key.length == 0) {\r\n            return o;\r\n        } else {\r\n            return reducerSetter(o[key[0]], key.slice(1), value);\r\n        }\r\n    }\r\n    function reducerAdder(o, key, value) {\r\n        if (typeof key == 'string') {\r\n            return reducerAdder(o, key.split('.'), value);\r\n        } else if (key.length == 1 && value !== undefined) {\r\n            return (o[key[0]] += value);\r\n        } else if (key.length == 0) {\r\n            return o;\r\n        } else {\r\n            return reducerAdder(o[key[0]], key.slice(1), value);\r\n        }\r\n    }\r\n    Utils.reverseSortOn = reverseSortOn;\r\n    Utils.getTouch = getTouch;\r\n    Utils.getRelativeTouch = getRelativeTouch;\r\n    Utils.getClosest = getClosest;\r\n    Utils.getClosestElement = getClosestElement;\r\n    Utils.throttle = throttle;\r\n    Utils.where = where;\r\n    Utils.format = format;\r\n    Utils.compileController = compileController;\r\n    Utils.reducer = reducer;\r\n    Utils.reducerSetter = reducerSetter;\r\n    Utils.reducerAdder = reducerAdder;\r\n    Utils.toMd5 = function (string) {\r\n        return Md5.encode(string);\r\n    };\r\n    Utils.ua = {\r\n        safari: safari,\r\n        msie: msie,\r\n        chrome: chrome,\r\n        mobile: mobile,\r\n    };\r\n    angular.forEach(Utils.ua, function (value, key) {\r\n        if (value) {\r\n            angular.element(document.getElementsByTagName('body')).addClass(key);\r\n        }\r\n    });\r\n    return Utils;\r\n}]);\r\n\r\nmodule.factory('State', ['$timeout', function ($timeout) {\r\n    function State() {\r\n        this.isReady = false;\r\n        this.idle();\r\n    }\r\n    State.prototype = {\r\n        idle: function () {\r\n            this.isBusy = false;\r\n            this.isError = false;\r\n            this.isErroring = false;\r\n            this.isSuccess = false;\r\n            this.isSuccessing = false;\r\n            this.button = null;\r\n            this.errors = [];\r\n        },\r\n        enabled: function () {\r\n            return !this.isBusy && !this.isErroring && !this.isSuccessing;\r\n        },\r\n        busy: function () {\r\n            if (!this.isBusy) {\r\n                this.isBusy = true;\r\n                this.isError = false;\r\n                this.isErroring = false;\r\n                this.isSuccess = false;\r\n                this.isSuccessing = false;\r\n                this.errors = [];\r\n                // console.log('State.busy', this);\r\n                return true;\r\n            } else {\r\n                return false;\r\n            }\r\n        },\r\n        success: function () {\r\n            this.isBusy = false;\r\n            this.isError = false;\r\n            this.isErroring = false;\r\n            this.isSuccess = true;\r\n            this.isSuccessing = true;\r\n            this.errors = [];\r\n            $timeout(function () {\r\n                this.isSuccessing = false;\r\n                this.button = null;\r\n            }.bind(this), 1000);\r\n        },\r\n        error: function (error) {\r\n            this.isBusy = false;\r\n            this.isError = true;\r\n            this.isErroring = true;\r\n            this.isSuccess = false;\r\n            this.isSuccessing = false;\r\n            this.errors.push(error);\r\n            $timeout(function () {\r\n                this.isErroring = false;\r\n                this.button = null;\r\n            }.bind(this), 1000);\r\n        },\r\n        ready: function () {\r\n            this.isReady = true;\r\n            this.success();\r\n        },\r\n        errorMessage: function () {\r\n            return this.isError ? this.errors[this.errors.length - 1] : null;\r\n        },\r\n        submitClass: function () {\r\n            return {\r\n                busy: this.isBusy,\r\n                ready: this.isReady,\r\n                successing: this.isSuccessing,\r\n                success: this.isSuccess,\r\n                errorring: this.isErroring,\r\n                error: this.isError,\r\n            };\r\n        },\r\n        submitMessage: function (idleMessage, busyMessage, successMessage, errorMessage) {\r\n            idleMessage = idleMessage || 'Submit';\r\n            if (this.isBusy) {\r\n                return busyMessage || idleMessage;\r\n            } else if (this.isSuccess) {\r\n                return successMessage || idleMessage;\r\n            } else if (this.isError) {\r\n                return errorMessage || idleMessage;\r\n            } else {\r\n                return idleMessage;\r\n            }\r\n        },\r\n    };\r\n    return State;\r\n}]);\r\n\r\nmodule.factory('Range', ['$filter', function ($filter) {\r\n    function Range(data) {\r\n        this.type = Range.types.QUARTER;\r\n        data ? angular.extend(this, data) : null;\r\n    }\r\n    Range.prototype = {\r\n        currentQuarter: function () {\r\n            this.diff = 0;\r\n            return this.setQuarter();\r\n        },\r\n        currentSemester: function () {\r\n            this.diff = 0;\r\n            return this.setSemester();\r\n        },\r\n        currentYear: function () {\r\n            this.diff = 0;\r\n            return this.setYear();\r\n        },\r\n        setQuarter: function () {\r\n            this.type = Range.types.QUARTER;\r\n            var now = new Date();\r\n            now.setMonth(now.getMonth() + 3 * this.diff);\r\n            var year = now.getFullYear();\r\n            var quarter = Math.floor(now.getMonth() / 3);\r\n            this.from = new Date(year, quarter * 3, 1);\r\n            this.to = new Date(year, quarter * 3 + 3, 0);\r\n            return this;\r\n        },\r\n        setSemester: function () {\r\n            this.type = Range.types.SEMESTER;\r\n            var now = new Date();\r\n            now.setMonth(now.getMonth() + 6 * this.diff);\r\n            var year = now.getFullYear();\r\n            var semester = Math.floor(now.getMonth() / 6);\r\n            this.from = new Date(year, semester * 6, 1);\r\n            this.to = new Date(year, semester * 6 + 6, 0);\r\n            return this;\r\n        },\r\n        setYear: function () {\r\n            this.type = Range.types.YEAR;\r\n            var now = new Date();\r\n            now.setMonth(now.getMonth() + 12 * this.diff);\r\n            var year = now.getFullYear();\r\n            this.from = new Date(year, 0, 1);\r\n            this.to = new Date(year, 12, 0);\r\n            return this;\r\n        },\r\n        getName: function () {\r\n            switch (this.type) {\r\n                case Range.types.QUARTER:\r\n                    return 'Trimestre ' + $filter('date')(this.from, 'MMM') + '-' + $filter('date')(this.to, 'MMM') + ' ' + $filter('date')(this.from, 'yyyy');\r\n                    break;\r\n                case Range.types.SEMESTER:\r\n                    return 'Semestre ' + $filter('date')(this.from, 'MMM') + '-' + $filter('date')(this.to, 'MMM') + ' ' + $filter('date')(this.from, 'yyyy');\r\n                    break;\r\n                case Range.types.YEAR:\r\n                    return 'Anno ' + $filter('date')(this.from, 'yyyy');\r\n                    break;\r\n            }\r\n        },\r\n        setDiff: function(diff) {\r\n            this.diff += diff;\r\n            switch (this.type) {\r\n                case Range.types.QUARTER:\r\n                    return this.setQuarter();\r\n                    break;\r\n                case Range.types.SEMESTER:\r\n                    return this.setSemester();\r\n                    break;\r\n                case Range.types.YEAR:\r\n                    return this.setYear();\r\n                    break;\r\n            }\r\n        },\r\n        set: function (filters, source) {\r\n            filters.dateFrom = this.from;\r\n            filters.dateTo = this.to;\r\n            source ? source.setDates(filters.dateFrom, filters.dateTo) : null;\r\n            return this;\r\n        },\r\n        is: function (filters) {\r\n            return  filters.dateFrom.getTime() == this.from.getTime() &&\r\n                    filters.dateTo.getTime() == this.to.getTime();\r\n        },\r\n    };\r\n    Range.types = {\r\n        QUARTER: 1,\r\n        SEMESTER: 2,\r\n        YEAR: 3,\r\n    }\r\n    return Range;\r\n}]);\r\n\r\nmodule.factory('Vector', function () {\r\n    function Vector(x, y) {\r\n        this.x = x || 0;\r\n        this.y = y || 0;\r\n    }\r\n    Vector.make = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.size = function (a) {\r\n        return Math.sqrt(a.x * a.x + a.y * a.y);\r\n    };\r\n    Vector.normalize = function (a) {\r\n        var l = Vector.size(a);\r\n        a.x /= l;\r\n        a.y /= l;\r\n        return a;\r\n    };\r\n    Vector.incidence = function (a, b) {\r\n        var angle = Math.atan2(b.y, b.x) - Math.atan2(a.y, a.x);\r\n        // if (angle < 0) angle += 2 * Math.PI;\r\n        // angle = Math.min(angle, (Math.PI * 2 - angle));\r\n        return angle;\r\n    };\r\n    Vector.distance = function (a, b) {\r\n        return Math.sqrt((a.x - b.x) * (a.x - b.x) + (a.y - b.y) * (a.y - b.y));\r\n    };\r\n    Vector.cross = function (a, b) {\r\n        return (a.x * b.y) - (a.y * b.x);\r\n    };\r\n    Vector.difference = function (a, b) {\r\n        return new Vector(b.x - a.x, b.y - a.y);\r\n    };\r\n    Vector.power = function (a, b) {\r\n        var x = Math.abs(b.x - a.x);\r\n        var y = Math.abs(b.y - a.y);\r\n        return (x + y) / 2;\r\n    };\r\n    Vector.prototype = {\r\n        size: function () {\r\n            return Vector.size(this);\r\n        },\r\n        normalize: function () {\r\n            return Vector.normalize(this);\r\n        },\r\n        incidence: function (b) {\r\n            return Vector.incidence(this, b);\r\n        },\r\n        cross: function (b) {\r\n            return Vector.cross(this, b);\r\n        },\r\n        distance: function (b) {\r\n            return Vector.distance(this, b);\r\n        },\r\n        difference: function (b) {\r\n            return Vector.difference(this, b);\r\n        },\r\n        power: function () {\r\n            return (Math.abs(this.x) + Math.abs(this.y)) / 2;\r\n        },\r\n        towards: function (b, friction) {\r\n            friction = friction || 0.125;\r\n            this.x += (b.x - this.x) * friction;\r\n            this.y += (b.y - this.y) * friction;\r\n            return this;\r\n        },\r\n        add: function (b) {\r\n            this.x += b.x;\r\n            this.y += b.y;\r\n            return this;\r\n        },\r\n        friction: function (b) {\r\n            this.x *= b;\r\n            this.y *= b;\r\n            return this;\r\n        },\r\n        copy: function (b) {\r\n            return new Vector(this.x, this.y);\r\n        },\r\n        toString: function () {\r\n            return '{' + this.x + ',' + this.y + '}';\r\n        },\r\n    };\r\n    return Vector;\r\n});\r\n\r\nmodule.factory('ElementRect', ['Vector', function (Vector) {\r\n    function ElementRect() {\r\n        this.x = 0;\r\n        this.y = 0;\r\n        this.width = 0;\r\n        this.height = 0;\r\n        this.center = new Vector();\r\n    }\r\n    ElementRect.fromNative = function (nativeElement) {\r\n        return new ElementRect().set(nativeElement);\r\n    }\r\n    ElementRect.prototype = {\r\n        set: function (nativeElement) {\r\n            var rect = nativeElement.getBoundingClientRect();\r\n            this.x = rect.left;\r\n            this.y = rect.top;\r\n            this.width = nativeElement.offsetWidth;\r\n            this.height = nativeElement.offsetHeight;\r\n            this.center.x = this.x + this.width / 2;\r\n            this.center.y = this.y + this.height / 2;\r\n            this.native = nativeElement;\r\n            return this;\r\n        },\r\n        offset: function (vector) {\r\n            this.x += vector.x;\r\n            this.y += vector.y;\r\n            this.center.x = this.x + this.width / 2;\r\n            this.center.y = this.y + this.height / 2;\r\n            return this;\r\n        },\r\n        intersect: function (element) {\r\n            // console.log('intersect.this', this, 'element', element);\r\n            return !(element.x > this.x + this.width ||\r\n                        element.x + element.width < this.x ||\r\n                        element.y > this.y + this.height ||\r\n                        element.y + element.height < this.y);\r\n        },\r\n        toString: function () {\r\n            return '{' + this.x + ',' + this.y + ',' + this.width + ',' + this.height + '}';\r\n        },\r\n    };\r\n    return ElementRect;\r\n}]);\r\n\r\nmodule.factory('Style', function () {\r\n    var prefix = function detectTransformProperty() {\r\n        var transform = 'transform',\r\n            webkit = 'webkitTransform';\r\n        var div = document.createElement(\"DIV\");\r\n        if (typeof div.style[transform] !== 'undefined') {\r\n            ['webkit', 'moz', 'o', 'ms'].every(function (prop) {\r\n                var prefixed = '-' + prop + '-transform';\r\n                if (typeof div.style[prefixed] !== 'undefined') {\r\n                    prefix = prefixed;\r\n                    return false;\r\n                }\r\n                return true;\r\n            });\r\n        } else if (typeof div.style[webkit] !== 'undefined') {\r\n            prefix = '-webkit-transform';\r\n        } else {\r\n            prefix = undefined;\r\n        }\r\n        return prefix;\r\n    }();\r\n    function Style() {\r\n        this.props = {\r\n            scale: 1,\r\n            hoverScale: 1,\r\n            currentScale: 1,\r\n        }\r\n    }\r\n    Style.prototype = {\r\n        set: function (element) {\r\n            var styles = [];\r\n            angular.forEach(this, function (value, key) {\r\n                if (key !== 'props')\r\n                    styles.push(key + ':' + value);\r\n            });\r\n            element.style.cssText = styles.join(';') + ';';\r\n        },\r\n        transform: function (transform) {\r\n            this[prefix] = transform;\r\n        },\r\n        transformOrigin: function (x, y) {\r\n            this[prefix + '-origin-x'] = (Math.round(x * 1000) / 1000) + '%';\r\n            this[prefix + '-origin-y'] = (Math.round(y * 1000) / 1000) + '%';\r\n        },\r\n    };\r\n    Style.prefix = prefix;\r\n    return Style;\r\n});\r\n\n/* global angular, module */\r\n\r\nmodule.factory('DataFilter', ['$filter', function ($filter) {\r\n    function DataFilter(data) {\r\n        /*\r\n        this.dateFrom = null;\r\n        this.dateTo = null;\r\n        this.search = null;\r\n        this.status = null;\r\n        this.sort = null;\r\n        */\r\n        data ? angular.extend(this, data) : null;\r\n    }\r\n    DataFilter.prototype = {\r\n        getObjectParams: function (obj) {\r\n            var a = [];\r\n            if (obj) {\r\n                for (var p in obj) {\r\n                    a.push({ name: p, value: obj[p] });\r\n                }\r\n            }\r\n            return a;\r\n        },\r\n        getParams: function (source) {\r\n            var post = {}, value;\r\n            for (var p in this) {\r\n                switch (p) {\r\n                    case 'dateFrom':\r\n                    case 'dateTo':\r\n                    case 'status':\r\n                        value = this[p];\r\n                        if (value !== undefined) {\r\n                            post[p] = value;\r\n                        }\r\n                        break;\r\n                    case 'search':\r\n                    case 'sort':\r\n                        var json = JSON.stringify(this.getObjectParams(this[p]), null, '');\r\n                        post[p] = window.btoa(json);\r\n                        break;\r\n                }\r\n            }\r\n            if (!source.unpaged) {\r\n                post.page = source.page;\r\n                post.size = source.size;\r\n            }\r\n            // console.log('DataFilter.getParams', post);\r\n            return post;\r\n        },\r\n        getMonths: function () {\r\n            var months = [];\r\n            if (this.dateFrom && this.dateTo) {\r\n                var range = [this.dateFrom, this.dateTo];\r\n                range = range.sort(function (a, b) {\r\n                    return a.getTime() - b.getTime();\r\n                });\r\n                function monthDiff(a, b) {\r\n                    var months;\r\n                    months = (b.getFullYear() - a.getFullYear()) * 12;\r\n                    months -= a.getMonth() + 1;\r\n                    months += b.getMonth() + 1; // we should add + 1 to get correct month number\r\n                    months ++;\r\n                    // console.log(months);\r\n                    return months <= 0 ? 0 : months;\r\n                }\r\n                var diff = Math.max(1, monthDiff(range[0], range[1]));\r\n                // console.log('getMonths', range[0], range[1], diff);\r\n                var i = 0;\r\n                while (i < diff) {\r\n                    var date = new Date(range[0].getFullYear(), range[0].getMonth() + i, 1);\r\n                    months.push({\r\n                        id: date.getTime(),\r\n                        name: $filter('date')(date, '(yyyy MM) MMMM'),\r\n                        nameShort: $filter('date')(date, 'MMM yy'),\r\n                    });\r\n                    i++;\r\n                };\r\n            }\r\n            return months;\r\n        },\r\n    };\r\n    return DataFilter;\r\n}]);\r\n\r\nmodule.factory('DataSource', ['$q', '$http', '$rootScope', '$location', 'State', 'DataFilter', function ($q, $http, $rootScope, $location, State, DataFilter) {\r\n    var PAGES_FIRST = 1;\r\n    var PAGES_SIZE = 7;\r\n    var PAGES_MAX = Number.POSITIVE_INFINITY;\r\n    function DataSource(data) {\r\n        this.state = new State();\r\n        this.page = PAGES_FIRST;\r\n        this.size = PAGES_SIZE;\r\n        this.pages = PAGES_MAX;\r\n        this.count = 0;\r\n        this.maxPages = 10;\r\n        this.items = [];\r\n        this.rows = [];\r\n        this.allrows = [];\r\n        this.steps = [];\r\n        this.filters = new DataFilter({});\r\n        this.uri = '/api/items/paging';\r\n        this.unpaged = false; // if true skip pagination\r\n        data ? angular.extend(this, data) : null;        \r\n    }\r\n    DataSource.prototype = {\r\n        resolve: function (deferred) {\r\n            angular.forEach(this.response.data, function (item) {\r\n                this.push(item);\r\n            }, this.rows);\r\n            deferred.resolve();\r\n        },\r\n        group: function (deferred) {\r\n            deferred.resolve();\r\n        },\r\n        next: function ($d) {\r\n            if (this.steps.length) {\r\n                var deferred = $q.defer();\r\n                deferred.promise.then(function (response) {\r\n                    this.next($d);\r\n                }.bind(this), function (response) {\r\n                    this.error(response);\r\n                }.bind(this));\r\n                var step = this.steps.shift();\r\n                step.call(this, deferred);\r\n            } else {\r\n                $d.resolve();\r\n            }\r\n        },\r\n        when: function () {\r\n            var deferred = $q.defer();\r\n            angular.forEach(Array.prototype.slice.call(arguments), function(step) {\r\n                this.push(step);\r\n            }, this.steps);\r\n            this.next(deferred);\r\n            return deferred.promise;\r\n        },\r\n        unallowed: function (error) {\r\n            this.deferred.reject(error);\r\n            this.deferred = null;\r\n            this.state.error(error);\r\n            $location.$$lastRequestedPath = $location.path(); // $route.current.$$route.originalPath;\r\n            $location.path('/signin');\r\n        },\r\n        error: function (response) {\r\n            // typeof (err) === \"string\" ? err = { status: status } : (err == null ? err = { status: status } : err.status = status);\r\n            var error = response ? { message: response.data ? response.data.message : \"error\", status: response.status } : null;\r\n            this.deferred.reject(error);\r\n            this.deferred = null;\r\n            this.state.error(error);\r\n        },\r\n        parseHeader: function () {\r\n            var responseHeader = this.response.headers('X-Pagination');\r\n            var responseView = responseHeader ? JSON.parse(responseHeader) : null;\r\n            if (responseView) {\r\n                this.page = responseView.page;\r\n                this.size = responseView.size;\r\n                this.count = responseView.count;\r\n                this.pages = responseView.pages;\r\n            } else {\r\n                this.page = PAGES_FIRST;\r\n                this.size = this.size || PAGES_SIZE;\r\n                this.count = this.response.data.length;\r\n                this.pages = Math.ceil(this.count / this.size);\r\n            }\r\n            this.pagination = this.getPages();\r\n        },\r\n        getUri: function () {\r\n            return angular.isFunction(this.uri) ? this.uri() : this.uri;\r\n        },\r\n        getParams: function () {\r\n            return { params: this.filters.getParams(this) };\r\n        },\r\n        get: function () {\r\n            $http.get(this.getUri(), this.getParams()).then(function (response) {\r\n                this.rows.length = 0;\r\n                this.items.length = 0;\r\n                this.response = response;\r\n                this.parseHeader();\r\n                this.when(this.resolve, this.group).then(function () {\r\n                    this.allrows = this.allrows.concat(this.rows);\r\n                    $rootScope.$broadcast('onDataSourceUpdate', this);\r\n                    this.state.success();\r\n                    this.deferred.resolve(this.rows);\r\n                    this.deferred = null;\r\n                }.bind(this));\r\n            }.bind(this), function (response) {\r\n                this.error(response);\r\n            }.bind(this));\r\n        },\r\n        update: function ($d) {\r\n            this.items = [];\r\n            if (this.state.busy()) {\r\n                this.when(this.group).then(function () {\r\n                    this.state.success();\r\n                }.bind(this));\r\n            }\r\n        },\r\n        paging: function ($d) {\r\n            var deferred = this.deferred = ($d || $q.defer());\r\n            if ((this.page <= this.pages || $d !== undefined) && this.state.busy()) {\r\n                this.opened = null;\r\n                this.get();\r\n            }\r\n            return deferred.promise;\r\n        },\r\n        filter: function () {\r\n            var deferred = $q.defer();\r\n            this.allrows = [];\r\n            this.paging(deferred);\r\n            return deferred.promise;\r\n        },\r\n        add: function (item) {\r\n            this.rows.push(item);\r\n            this.allrows.push(item);\r\n            this.update();\r\n            this.count++;\r\n            this.pages = Math.ceil(this.count / this.size);\r\n        },\r\n        remove: function (item) {\r\n            var i = this.rows.indexOf(item);\r\n            if (i !== -1) {\r\n                this.rows.splice(i, 1);\r\n            }\r\n            i = this.allrows.indexOf(item);\r\n            if (i !== -1) {\r\n                this.allrows.splice(i, 1);\r\n            }\r\n            this.update();\r\n            this.count--;\r\n            this.pages = Math.ceil(this.count / this.size);\r\n        },\r\n        prevPage: function () {\r\n            var page = this.page - 1;\r\n            if (page > 0 && page <= this.pages) {\r\n                this.page = page;\r\n                this.paging();\r\n            }\r\n        },\r\n        nextPage: function () {\r\n            var page = this.page + 1;\r\n            if (page > 0 && page <= this.pages) {\r\n                this.page = page;\r\n                this.paging();\r\n            }\r\n        },\r\n        gotoPage: function (page) {\r\n            if (page > 0 && page <= this.pages) {\r\n                this.page = page;\r\n                this.paging();\r\n            }\r\n        },\r\n        firstPage: function () {\r\n            if (this.page !== 1) {\r\n                this.page = 1;\r\n                this.paging();\r\n            }\r\n        },\r\n        lastPage: function () {\r\n            if (this.page !== this.pages) {\r\n                this.page = this.pages;\r\n                this.paging();\r\n            }\r\n        },\r\n        hasMany: function () {\r\n            return this.pages > this.maxPages;\r\n        },\r\n        hasMorePagesBehind: function () {\r\n            var startingIndex = Math.max(0, this.page - this.maxPages);\r\n            return startingIndex > 0;\r\n        },\r\n        hasMorePagesNext: function () {\r\n            var endingIndex = Math.max(0, this.page - this.maxPages) + this.maxPages;\r\n            return endingIndex < this.pages;\r\n        },\r\n        isPage: function (number) {\r\n            return this.page === number;\r\n        },\r\n        hasPages: function () {\r\n            return this.pages > 0 && this.pages < PAGES_MAX;\r\n        },\r\n        getPages: function () {\r\n            var a = [], i;\r\n            if (this.hasPages()) {\r\n                var startingIndex = Math.max(0, this.page - this.maxPages);\r\n                var endingIndex = Math.min(this.pages, startingIndex + this.maxPages);\r\n                i = startingIndex;\r\n                while (i < endingIndex) {\r\n                    a.push({ number: (i + 1) });\r\n                    i++;\r\n                }\r\n            }\r\n            return a;\r\n        },\r\n        openClose: function (index) {\r\n            if (this.opened === index) {\r\n                this.opened = null;\r\n            } else {\r\n                this.opened = index;\r\n            }\r\n        },\r\n        setSort: function (key, sort) {\r\n            var deferred = $q.defer();\r\n            if (!this.state.isBusy) {\r\n                this.filters.sort = {};\r\n                this.filters.sort[key] = sort;\r\n                if (angular.isFunction(this.sort)) {\r\n                    this.sort(this);\r\n                    deferred.resolve(this.rows);\r\n                } else {\r\n                    this.allrows = [];\r\n                    this.paging(deferred);\r\n                }\r\n            }\r\n            return deferred.promise;\r\n        },\r\n        getSort: function (key) {\r\n            if (this.filters.sort) {\r\n                return this.filters.sort[key] || 0;\r\n            } else {\r\n                return 0;\r\n            }\r\n        },\r\n        hasSort: function () {\r\n            if (this.filters.sort) {\r\n                var has = false;\r\n                angular.forEach(this.filters.sort, function (value) {\r\n                    has = has || value;\r\n                });\r\n                return has;\r\n            } else {\r\n                return false;\r\n            }\r\n        },\r\n        setSearch: function (key, search) {\r\n            var deferred = $q.defer();\r\n            if (!this.state.isBusy) {\r\n                this.filters.search = {};\r\n                if (search && search !== '') {\r\n                    this.filters.search[key] = search;\r\n                }\r\n                if (angular.isFunction(this.search)) {\r\n                    this.search(this);\r\n                    deferred.resolve(this.rows);\r\n                } else {\r\n                    this.allrows = [];\r\n                    this.paging(deferred);\r\n                }\r\n            }\r\n            return deferred.promise;\r\n        },\r\n        getSearch: function (key) {\r\n            if (this.filters.search) {\r\n                return this.filters.search[key] || 0;\r\n            } else {\r\n                return 0;\r\n            }\r\n        },\r\n        hasSearch: function () {\r\n            if (this.filters.search) {\r\n                var has = false;\r\n                angular.forEach(this.filters.search, function (value) {\r\n                    has = has || (value && value !== '');\r\n                });\r\n                return has;\r\n            } else {\r\n                return false;\r\n            }\r\n        },\r\n        setDateFrom: function (date) {\r\n            var deferred = $q.defer();\r\n            if (!this.state.isBusy) {\r\n                this.filters.dateFrom = date || '';\r\n                if (angular.isFunction(this.dateFrom)) {\r\n                    this.dateFrom(this);\r\n                    deferred.resolve(this.rows);\r\n                } else {\r\n                    this.allrows = [];\r\n                    this.paging(deferred);\r\n                }\r\n            }\r\n            return deferred.promise;\r\n        },\r\n        getDateFrom: function () {\r\n            return this.filters.dateFrom || null;\r\n        },\r\n        setDateTo: function (date) {\r\n            var deferred = $q.defer();\r\n            if (!this.state.isBusy) {\r\n                this.filters.dateTo = date || '';\r\n                if (angular.isFunction(this.dateTo)) {\r\n                    this.dateTo(this);\r\n                    deferred.resolve(this.rows);\r\n                } else {\r\n                    this.allrows = [];\r\n                    this.paging(deferred);\r\n                }\r\n            }\r\n            return deferred.promise;\r\n        },\r\n        getDateTo: function () {\r\n            return this.filters.dateTo || null;\r\n        },\r\n        setDates: function (from, to) {\r\n            var deferred = $q.defer();\r\n            if (!this.state.isBusy) {\r\n                this.filters.dateFrom = from || '';\r\n                this.filters.dateTo = to || '';\r\n                this.allrows = [];\r\n                this.paging(deferred);\r\n            }\r\n            return deferred.promise;\r\n        },\r\n    };\r\n    return DataSource;\r\n}]);\r\n\r\nmodule.factory('Column', ['$parse', '$filter', 'Utils', 'colTypes', function ($parse, $filter, Utils, colTypes) {        \r\n    function Column(data) {\r\n        data ? angular.extend(this, data) : null;\r\n        // PREPARE GETTER SETTERS\r\n        if (angular.isFunction(this.value)) {\r\n            this.value = this.value.bind(this);\r\n        }\r\n        this.raw = this.raw || this.value;\r\n        this.source = this.source || this.value;\r\n        this.getters = {};\r\n        var fields = ['key', 'value', 'raw', 'source', 'post'];\r\n        angular.forEach(fields, function (field) {\r\n            if (this[field]) {\r\n                this.getters[field] = angular.isFunction(this[field]) ? this[field] : $parse(this[field]);\r\n            }\r\n        }, this);\r\n        this.setters = {};\r\n        angular.forEach(this.getters, function (getter, key) {\r\n            if (!angular.isFunction(this[key])) {\r\n                this.setters[key] = getter.assign;\r\n            }\r\n        }, this);\r\n        // PREPARE GETTER SETTERS\r\n        this.reset();\r\n    }\r\n    Column.prototype = {\r\n        getKey: function (item) {\r\n            return this.getters.key(item);\r\n        },\r\n        getValue: function (item) {\r\n            return this.getters.value(item);\r\n        },\r\n        getRaw: function (item) {\r\n            return this.getters.raw(item);\r\n        },\r\n        getSource: function (item) {\r\n            return this.getters.source(item);\r\n        },\r\n        reset: function () {\r\n            this.values = [];\r\n            this.keys = {};\r\n            this.search = [];\r\n            this.total = 0;\r\n        },\r\n        hasKey: function (item) {\r\n            var has = true;\r\n            var key = this.getKey(item);\r\n            if (key && this.keys[key] != true) {\r\n                this.keys[key] = true;\r\n                has = false;\r\n            }\r\n            return has;\r\n        },\r\n        initValue: function (item) {\r\n            this.setters.raw(item, (this.getters.value(item) || 0));\r\n            return this;\r\n        },\r\n        addTotal: function (item, row) {\r\n            this.setters.raw(item, (this.getters.raw(item) || 0) + (this.getters.value(row) || 0));\r\n            return this;\r\n        },\r\n        addCount: function (item, row) {\r\n            if (!this.hasKey(row) && this.setters.raw) {\r\n                var v = null;\r\n                if (item != row) {\r\n                    v = (this.getters.raw(item) || 0) + 1;\r\n                } else {\r\n                    v = 1;                    \r\n                }\r\n                this.setters.raw(item, v);\r\n            }\r\n            return this;\r\n        },\r\n        addValue: function (item) {\r\n            this.values = this.values || [];\r\n            var key = this.getKey(item);\r\n            var has = false;\r\n            angular.forEach(this.values, function (v) {\r\n                if (v.id == key) {\r\n                    has = true;\r\n                }\r\n            })\r\n            if (!has) {\r\n                var value = this.getRaw(item);\r\n                this.values.push({\r\n                    id: key,\r\n                    name: value || '-',\r\n                });\r\n            }\r\n        },\r\n        getValueTotal: function (filtered) {\r\n            var value = 0;\r\n            if (this.compare && this.type === colTypes.INCREMENT) {\r\n                var current = 0; // (col.getters.raw(item) || 0);\r\n                var previous = 0; // (this.getters.raw(item) || 0);                \r\n                angular.forEach(filtered, function (item) {\r\n                    current += (this.col.getters.raw(item) || 0);\r\n                    previous += (this.getters.raw(item) || 0);\r\n                }.bind(this));\r\n                if (previous) {\r\n                    value = (current - previous) / previous * 100;\r\n                }\r\n            } else {\r\n                angular.forEach(filtered, function (item) {\r\n                    value += this.getRaw(item) || 0;\r\n                }.bind(this));\r\n            }\r\n            this.total = value;\r\n            return value;\r\n        },\r\n        getValueFormatted: function (item) {\r\n            var value = this.getRaw(item);\r\n            switch (this.type) {\r\n                case colTypes.RESOURCE:\r\n                case colTypes.DISABLED:\r\n                    value = $filter('shortName')(value);\r\n                    break;\r\n                case colTypes.ID:\r\n                case colTypes.NUMBER:\r\n                    value = $filter('customNumber')(value, 0);\r\n                    break;\r\n                case colTypes.DOUBLE:\r\n                    value = $filter('customNumber')(value, 2);\r\n                    break;\r\n                case colTypes.WEEKS:\r\n                    value = $filter('customNumber')(value, 2, ' W');\r\n                    break;\r\n                case colTypes.DATE:\r\n                    value = $filter('date')(value, 'yyyy-MM-dd');\r\n                    break;\r\n                case colTypes.HOURS:\r\n                    value = $filter('customNumber')(value, 0, ' H');\r\n                    break;\r\n                case colTypes.COSTS:\r\n                    value = $filter('customNumber')(value, 0, ' ');\r\n                    break;\r\n                case colTypes.PERCENT:\r\n                    value = $filter('customNumber')(value, 2, ' %');\r\n                    break;\r\n                case colTypes.INCREMENT:\r\n                    value = angular.isNumber(value) ? (value > 0 ? '+' : '') + $filter('customNumber')(value, 2, ' %') : (value || '-');\r\n                    break;\r\n            }\r\n            return value;\r\n        },\r\n        getFormatted: function (item) {\r\n            if (this.dynamic) {\r\n                return this.getValueFormatted(item);\r\n            } else {\r\n                return item.static[this.id].value;\r\n            }\r\n        },\r\n        getTotal: function (filtered) {\r\n            var value = this.getValueTotal(filtered);\r\n            switch (this.type) {\r\n                case colTypes.NUMBER:\r\n                    value = $filter('customNumber')(value, 0);\r\n                    break;\r\n                case colTypes.DOUBLE:\r\n                    value = $filter('customNumber')(value, 2);\r\n                    break;\r\n                case colTypes.WEEKS:\r\n                    value = $filter('customNumber')(value, 2, ' W');\r\n                    break;\r\n                case colTypes.HOURS:\r\n                    value = $filter('customNumber')(value, 0, ' H');\r\n                    break;\r\n                case colTypes.COSTS:\r\n                    value = $filter('customNumber')(value, 0, ' ');\r\n                    break;\r\n                case colTypes.PERCENT:\r\n                    value = $filter('customNumber')(value, 2, ' %');\r\n                    break;\r\n                case colTypes.INCREMENT:\r\n                    value = angular.isNumber(value) ? (value > 0 ? '+' : '') + $filter('customNumber')(value, 2, ' %') : (value || '-');\r\n                    break;\r\n            }\r\n            return value;\r\n        },\r\n        getFormat: function () {\r\n            var format = '';\r\n            switch (this.type) {\r\n                case colTypes.ID:\r\n                case colTypes.NUMBER:\r\n                    format = '#';\r\n                    break;\r\n                case colTypes.DOUBLE:\r\n                    format = '#';\r\n                    break;\r\n                case colTypes.DATE:\r\n                    format = 'yyyy-mm-dd';\r\n                    break;\r\n                case colTypes.WEEKS:\r\n                    format = '#,###0 [$W]';\r\n                    break;\r\n                case colTypes.HOURS:\r\n                    format = '#,###0 [$H]';\r\n                    break;\r\n                case colTypes.COSTS:\r\n                    format = '#,###.00 ';\r\n                    break;\r\n                case colTypes.PERCENT:                \r\n                    format = '0.00%';\r\n                    break;\r\n                case colTypes.INCREMENT:\r\n                    format = '[Color 10]+0.00%;[Red]-0.00%;-';\r\n                    break;\r\n            }\r\n            return format;\r\n        },\r\n        getLink: function (item) {\r\n            return angular.isFunction(this.link) ? this.link(item) : null;\r\n        },\r\n        getHeaderClass: function () {\r\n            var cc = [];\r\n            angular.forEach(this, function (value, key) {\r\n                if (value === true) {\r\n                    cc.push(key);\r\n                }\r\n            });\r\n            switch (this.type) {\r\n                case colTypes.NUMBER:\r\n                case colTypes.DOUBLE:\r\n                case colTypes.WEEKS:\r\n                case colTypes.HOURS:\r\n                case colTypes.COSTS:\r\n                case colTypes.PERCENT:\r\n                case colTypes.INCREMENT:\r\n                    cc.push('text-xs-right');\r\n                    break;\r\n            }\r\n            var columnClass = this.getColumnClass();\r\n            if (columnClass != '') {\r\n                cc.push(columnClass);\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getCellClass: function (item) {\r\n            var cc = [];            \r\n            angular.forEach(this, function (value, key) {\r\n                if (value === true) {\r\n                    cc.push(key);\r\n                }\r\n            });\r\n            switch (this.type) {\r\n                case colTypes.LINK:\r\n                    cc.push('text-underline');\r\n                    break;\r\n                case colTypes.NUMBER:\r\n                case colTypes.DOUBLE:\r\n                case colTypes.WEEKS:\r\n                case colTypes.HOURS:\r\n                case colTypes.COSTS:\r\n                    cc.push('text-xs-right');\r\n                    break;\r\n                case colTypes.PERCENT:\r\n                    cc.push('text-xs-right');\r\n                    break;\r\n                case colTypes.INCREMENT:\r\n                    cc.push('text-xs-right');\r\n                    break;\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getColumnClass: function () {\r\n            return this.color ? 'shade-light-blue-' + this.color : '';\r\n        },\r\n        getItemClass: function (item) {\r\n            var cc = [];\r\n            cc.push(item.static[this.id].baseClass);\r\n            var columnClass = this.getColumnClass();\r\n            if (columnClass != '') {\r\n                cc.push(columnClass);\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getTextClass: function (item) {\r\n            var cc = [];\r\n            switch (this.type) {\r\n                case colTypes.INCREMENT:\r\n                    var value = this.getRaw(item);\r\n                    if (angular.isNumber(value) && value < 0) {\r\n                        cc.push('text-danger');\r\n                    } else {\r\n                        cc.push('text-success');\r\n                    }\r\n                    break;\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        getTotalClass: function (filtered) {\r\n            var cc = [];\r\n            switch (this.type) {\r\n                case colTypes.NUMBER:\r\n                case colTypes.DOUBLE:\r\n                case colTypes.WEEKS:\r\n                case colTypes.HOURS:\r\n                case colTypes.COSTS:\r\n                case colTypes.PERCENT:\r\n                case colTypes.INCREMENT:\r\n                    cc.push('text-xs-right');\r\n                    break;\r\n            }\r\n            return cc.join(' ');\r\n        },\r\n        searchToggle: function (item) {\r\n            var index = this.search.indexOf(item.id);\r\n            if (index === -1) {\r\n                item.active = true;\r\n                this.search.push(item.id);\r\n            } else {\r\n                item.active = false;\r\n                this.search.splice(index, 1);\r\n            }\r\n        },\r\n        isActive: function () {\r\n            if (angular.isFunction(this.active) && this.active) {\r\n                return this.active();\r\n            } else {\r\n                return this.active;\r\n            }\r\n        },\r\n        toggle: function () {\r\n            angular.isFunction(this.active) ? null : this.active = !this.active;\r\n        },\r\n        activate: function () {\r\n            angular.isFunction(this.active) ? null : this.active = true;\r\n        },\r\n        deactivate: function () {\r\n            angular.isFunction(this.active) ? null : this.active = false;\r\n        },\r\n        makeStatic: function (item) {\r\n            if (this.post) {\r\n                this.setters.raw(item, (this.getters.post(item) || 0));\r\n            }\r\n            var col = this;\r\n            item.static[col.id] = {\r\n                baseClass: col.getCellClass(item),\r\n                textClass: col.getTextClass(item),\r\n                value: col.getValueFormatted(item),\r\n                link: col.link ? col.link(item) : null,\r\n                pop: col.pop ? col.pop(item) : null,\r\n            };\r\n        },\r\n    };\r\n    Column.types = colTypes;\r\n    return Column;\r\n}]);\r\n\r\nmodule.factory('Columns', ['$parse', 'Utils', 'Column', 'colTypes', function ($parse, Utils, Column, colTypes) {\r\n    function Columns(columns) {\r\n        var list = [];\r\n        if (columns) {\r\n            angular.forEach(columns, function (col, index) {\r\n                col.id = index + 1;\r\n                list.push(new Column(col));\r\n            });\r\n        }        \r\n        angular.extend(list, Columns.prototype);\r\n        return list;\r\n    }\r\n    Columns.prototype = {\r\n        getCount: function () {\r\n            var i = 0;\r\n            angular.forEach(this, function (col) {\r\n                i += col.isActive() ? 1 : 0;\r\n            }.bind(this));\r\n            return i;\r\n        },\r\n        getFirstCol: function () {\r\n            var first = null;\r\n            angular.forEach(this, function (col) {\r\n                if (first === null && col.isActive() && col.groupBy && col.value !== 'month' && col.value !== 'monthShort') {\r\n                    first = col;\r\n                }\r\n            });\r\n            return first;\r\n        },\r\n        getChartKey: function (item, time) {\r\n            var keys = [];\r\n            angular.forEach(this, function (col) {\r\n                if (col.isActive() && col.groupBy && col.value !== 'month' && col.value !== 'monthShort' && keys.length === 0) {\r\n                    keys.push(col.getKey(item));\r\n                }\r\n            });\r\n            keys.push(time);\r\n            return keys.join('-');\r\n        },\r\n        getGroupKey: function (item) {\r\n            var keys = [];\r\n            angular.forEach(this, function (col) {\r\n                if (col.isActive() && col.groupBy) {\r\n                    keys.push(col.getKey(item));\r\n                }\r\n            });\r\n            return keys.join('-');\r\n        },\r\n        getSortKey: function (item) {\r\n            var values = [];\r\n            angular.forEach(this, function (col) {\r\n                if (col.isActive() && col.groupBy) {\r\n                    values.push(col.sort ? $parse(col.sort)(item) : col.getValueFormatted(item));\r\n                }\r\n            });\r\n            return values.join('');\r\n        },\r\n        expand: function (data) {\r\n            var options = {\r\n                dynamic: true,\r\n                compare: true,\r\n            }\r\n            data ? angular.extend(options, data) : null;\r\n            // add percentuals and compares\r\n            var array = [], cols = this;\r\n            array.radios = {};\r\n            angular.forEach(this, function (col, index) {\r\n                col.id = array.length + 1;\r\n                array.push(col);\r\n                if (col.aggregate) {\r\n                    if (options.dynamic) {\r\n                        array.push(new Column({\r\n                            id: array.length + 1,\r\n                            name: '%',\r\n                            value: function (item) {\r\n                                return col.getters.raw(item) / col.total * 100;\r\n                            },\r\n                            key: col.key,\r\n                            type: colTypes.PERCENT,\r\n                            dynamic: true,\r\n                            active: function () {\r\n                                return array.showDynamics && col.active;\r\n                            },\r\n                            col: col,\r\n                        }));\r\n                    }\r\n                    if (options.compare) {\r\n                        array.push(new Column({\r\n                            id: array.length + 1,\r\n                            name: 'anno precedente',\r\n                            value: function (item) {\r\n                                return this.getters.raw(item);\r\n                            },\r\n                            raw: col.value + 'Last',\r\n                            source: col.value,\r\n                            key: col.key,\r\n                            type: col.type, // \r\n                            count: col.count,\r\n                            compare: true,\r\n                            dynamic: true,\r\n                            active: function () {\r\n                                return array.showComparison && col.active;\r\n                            },\r\n                            col: col,\r\n                        }));\r\n                        array.push(new Column({\r\n                            id: array.length + 1,\r\n                            name: '%',\r\n                            value: function (item) {\r\n                                var current = (col.getters.raw(item) || 0);\r\n                                var previous = (this.getters.raw(item) || 0);\r\n                                if (previous) {\r\n                                    return (current - previous) / previous * 100;\r\n                                } else {\r\n                                    return null; // '+ %';\r\n                                }\r\n                            },\r\n                            raw: col.value + 'Gain',\r\n                            source: col.value,\r\n                            key: col.key,\r\n                            type: colTypes.INCREMENT, // col.type, // \r\n                            count: col.count,\r\n                            compare: true,\r\n                            dynamic: true,\r\n                            active: function () {\r\n                                return array.showComparison && col.active;\r\n                            },\r\n                            col: col,\r\n                        }));\r\n                    }\r\n                }\r\n                if (col.radio && col.active) {\r\n                    array.radios[col.radio] = col.value;\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getGroups: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.groupBy) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getCounters: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.count) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getAggregates: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.aggregate && !col.count) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getPercentages: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.type === colTypes.PERCENT) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getDynamics: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.dynamic) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        getCompares: function () {\r\n            var array = [];\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.compare) {\r\n                    array.push(col);\r\n                }\r\n            });\r\n            angular.extend(array, Columns.prototype);\r\n            return array;\r\n        },\r\n        reset: function () {\r\n            this.groups = {};\r\n            angular.forEach(this, function (col) {\r\n                col.reset();\r\n            });\r\n            return this;\r\n        },\r\n        makeStatic: function (items) {\r\n            //console.log('Columns.makeStatic', 'items', items.length);\r\n            angular.forEach(this, function (col, index) {\r\n                col.values = [];\r\n                col.static = {\r\n                    active: col.isActive(),\r\n                    headerClass: col.getHeaderClass(),\r\n                };\r\n            });\r\n            angular.forEach(this, function (col, index) {\r\n                if (col.static.active || col.dynamic) {\r\n                    angular.forEach(items, function (item) {\r\n                        col.makeStatic(item);\r\n                        col.groupBy ? col.addValue(item) : null;\r\n                    });\r\n                    if (col.groupBy) {\r\n                        col.values = col.values.sort(function (va, vb) {\r\n                            var a, b;\r\n                            a = va.name ? String(va.name).toLowerCase() : ''; // ignore upper and lowercase\r\n                            b = vb.name ? String(vb.name).toLowerCase() : ''; // ignore upper and lowercase\r\n                            if (a < b) {\r\n                                return -1;\r\n                            }\r\n                            if (a > b) {\r\n                                return 1;\r\n                            }\r\n                            return 0;\r\n                        });\r\n                    }\r\n                }\r\n            });\r\n        },\r\n        activeInRange: function (range) {\r\n            var flag = false;\r\n            var i = 0;\r\n            while (!flag && i < this.length) {\r\n                var col = this[i];\r\n                if (col.static.active) {\r\n                    flag = (range.indexOf(col.value) !== -1);\r\n                }\r\n                i++;\r\n            }\r\n            return flag;\r\n        },\r\n        unique: function (row, items) {\r\n            var key = this.getGroupKey(row);\r\n            var item = this.groups[key];\r\n            if (!item) {\r\n                item = this.groups[key] = row; // angular.copy(row);\r\n                item.static = [];\r\n                items.push(item);\r\n            }\r\n            return item;\r\n        },\r\n        iterate: function (row, items) {\r\n            row = angular.copy(row);\r\n            var item = this.unique(row, items);\r\n            this.addTotals(item, row);\r\n        },        \r\n        compare: function (row, items) {\r\n            row = angular.copy(row);\r\n            angular.forEach(this, function (col) {\r\n                if (col.compare) {\r\n                    var value = col.getters.source(row);\r\n                    col.setters.raw(row, value);\r\n                }\r\n            });\r\n            angular.forEach(this, function (col) {\r\n                if (col.compare) {\r\n                    col.setters.source(row, 0);\r\n                }\r\n            });\r\n            var item = this.unique(row, items);\r\n            this.addTotals(item, row, true);\r\n        },\r\n        addTotals: function (item, row, comparing) {\r\n            angular.forEach(this, function (col) {\r\n                if (col.isActive() && (comparing ? col.compare : !col.compare)) {\r\n                    if (col.count) {\r\n                        col.addCount(item, row);\r\n                    } else if (comparing || col.aggregate) {\r\n                        if (!col.hasKey(row)) {\r\n                            if (item === row) {\r\n                                col.initValue(item);\r\n                            } else {\r\n                                col.addTotal(item, row);\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n            return this;\r\n        },\r\n        toggleColumns: function (c) {\r\n            if (c.radio) {\r\n                angular.forEach(this, function (col) {\r\n                    if (c.radio === col.radio && c !== col) {\r\n                        col.deactivate();\r\n                    }\r\n                });\r\n                c.activate();\r\n                this.radios[c.radio] = c.value;\r\n            } else {\r\n                c.toggle();\r\n            }\r\n        },\r\n        searchDisabled: function (item, col, filtered) {\r\n            var id = item.id, t = this;\r\n            var has = false, index = 0;\r\n            while(index < filtered.length) {\r\n                has = has || col.getKey(filtered[index]) === id;\r\n                if (has) {\r\n                    index = filtered.length;\r\n                } else {\r\n                    index ++;\r\n                }\r\n            }\r\n            return !has;    \r\n        },\r\n        setMode: function (mode) {\r\n            this[mode] = !this[mode];\r\n            switch (mode) {\r\n                case 'showDynamics':\r\n                    this.showComparison = false;\r\n                    break;\r\n                case 'showComparison':\r\n                    this.showDynamics = false;\r\n                    break;\r\n            }\r\n            return this[mode];\r\n        },\r\n    };\r\n    Columns.types = colTypes;\r\n    return Columns;\r\n}]);\r\n\r\nmodule.factory('ChartData', ['$filter', function ($filter) {\r\n    function ChartData(data) {\r\n        var defaults = {\r\n            type: 'chart-line',\r\n            labels: [],\r\n            series: [],\r\n            data: [],\r\n            options: {\r\n                bezierCurve: false,\r\n                elements: {\r\n                    line: {\r\n                        tension: 0,\r\n                    }\r\n                },\r\n                scaleLabel: function (label) {\r\n                    return $filter('currency')(label.value);\r\n                },\r\n                tooltipTemplate: function (data) {\r\n                    return $filter('currency')(data.value);\r\n                },\r\n                scales: {\r\n                    yAxes: [{\r\n                        gridLines: {\r\n                            display: false\r\n                        },\r\n                        ticks: {\r\n                            min: 0,\r\n                            // max: 3,\r\n                            // stepSize: 1,\r\n                            callback: function (value, index, values) {\r\n                                return $filter('customNumber')(value, 2, ' W');\r\n                            }\r\n                        }\r\n                    }],\r\n                    callbacks: {\r\n                        label: function (label) {\r\n                            console.log('b');\r\n                            return $filter('customNumber')(label.value, 2, ' W');\r\n                        }\r\n                    }\r\n                },\r\n                tooltips: {\r\n                    callbacks: {\r\n                        title: function (tooltipItems, data) {\r\n                            return '';\r\n                        },\r\n                        label: function (tooltipItem, data) {\r\n                            var label = data.datasets[tooltipItem.datasetIndex].label;\r\n                            var datasetLabel = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];\r\n                            return label + ': ' + $filter('customNumber')(datasetLabel, 2, ' W');\r\n                        },\r\n                    }\r\n                },\r\n            },\r\n            onClick: function (points, evt) {\r\n                console.log('chart', points, evt);\r\n            },\r\n            datasetOverride: [],\r\n        };\r\n        angular.extend(this, defaults);\r\n        data ? angular.extend(this, data) : null;\r\n    }\r\n    ChartData.prototype = {\r\n        getObjectParams: function (obj) {\r\n            var a = [];\r\n            if (obj) {\r\n                for (var p in obj) {\r\n                    a.push({ name: p, value: obj[p] });\r\n                }\r\n            }\r\n            return a;\r\n        },\r\n        getParams: function (source) {\r\n            var post = {}, value;\r\n            for (var p in this) {\r\n                switch (p) {\r\n                    case 'dateFrom':\r\n                    case 'dateTo':\r\n                    case 'status':\r\n                        value = this[p];\r\n                        if (value !== undefined) {\r\n                            post[p] = value;\r\n                        }\r\n                        break;\r\n                    case 'search':\r\n                    case 'sort':\r\n                        var json = JSON.stringify(this.getObjectParams(this[p]), null, '');\r\n                        post[p] = window.btoa(json);\r\n                        break;\r\n                }\r\n            }\r\n            if (!source.unpaged) {\r\n                post.page = source.page;\r\n                post.size = source.size;\r\n            }\r\n            // console.log('ChartData.getParams', post);\r\n            return post;\r\n        },\r\n        getMonths: function () {\r\n            var months = [];\r\n            if (this.dateFrom && this.dateTo) {\r\n                var range = [this.dateFrom, this.dateTo];\r\n                range = range.sort(function (a, b) {\r\n                    return a.getTime() - b.getTime();\r\n                });\r\n                function monthDiff(a, b) {\r\n                    var months;\r\n                    months = (b.getFullYear() - a.getFullYear()) * 12;\r\n                    months -= a.getMonth() + 1;\r\n                    months += b.getMonth() + 1; // we should add + 1 to get correct month number\r\n                    months++;\r\n                    // console.log(months);\r\n                    return months <= 0 ? 0 : months;\r\n                }\r\n                var diff = Math.max(1, monthDiff(range[0], range[1]));\r\n                // console.log('getMonths', range[0], range[1], diff);\r\n                var i = 0;\r\n                while (i < diff) {\r\n                    var date = new Date(range[0].getFullYear(), range[0].getMonth() + i, 1);\r\n                    months.push({\r\n                        id: date.getTime(),\r\n                        name: $filter('date')(date, '(yyyy MM) MMMM'),\r\n                        nameShort: $filter('date')(date, 'MMM yy'),\r\n                    });\r\n                    i++;\r\n                };\r\n            }\r\n            return months;\r\n        },\r\n    };\r\n    return ChartData;\r\n}]);\r\n\r\nmodule.service('Droppables', ['ElementRect', function (ElementRect) {\r\n    this.natives = [];\r\n    this.callbacks = [];\r\n    this.rects = [];\r\n    this.add = function (nativeElement, callback) {\r\n        this.natives.push(nativeElement);\r\n        this.callbacks.push(callback || function () { });\r\n        this.rects.push(ElementRect.fromNative(nativeElement));\r\n    };\r\n    this.remove = function (nativeElement) {\r\n        var index = this.natives.indexOf(nativeElement);\r\n        if (index !== -1) {\r\n            this.natives.splice(index, 1);\r\n            this.callbacks.splice(index, 1);\r\n            this.rects.splice(index, 1);\r\n        }\r\n    };\r\n    this.getIntersections = function (item) {\r\n        var intersections = [], element;\r\n        angular.forEach(this.rects, function (rect, index) {\r\n            rect.set(rect.native);\r\n            element = angular.element(rect.native);\r\n            element.removeClass('dropping');\r\n            if (rect.intersect(item)) {\r\n                rect.distance = rect.center.distance(item.center);\r\n                rect.data = this.callbacks[index]();\r\n                intersections.push(rect);\r\n                element.addClass('over');\r\n            } else {\r\n                element.removeClass('over');\r\n            }\r\n        }.bind(this));\r\n        intersections.sort(function (a, b) {\r\n            if (a.distance < b.distance) {\r\n                return -1;\r\n            }\r\n            if (a.distance > b.distance) {\r\n                return 1;\r\n            }\r\n            return 0;\r\n        });\r\n        return intersections;\r\n    };\r\n}]);\r\n\n\n})(window, window.angular);\n"]}